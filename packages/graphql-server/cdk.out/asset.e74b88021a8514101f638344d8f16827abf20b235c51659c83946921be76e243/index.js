var _o=Object.create;var He=Object.defineProperty;var Fo=Object.getOwnPropertyDescriptor;var Go=Object.getOwnPropertyNames;var Uo=Object.getPrototypeOf,Vo=Object.prototype.hasOwnProperty;var h=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Ko=(e,r)=>{for(var t in r)He(e,t,{get:r[t],enumerable:!0})},Pt=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of Go(r))!Vo.call(e,i)&&i!==t&&He(e,i,{get:()=>r[i],enumerable:!(n=Fo(r,i))||n.enumerable});return e};var Wo=(e,r,t)=>(t=e!=null?_o(Uo(e)):{},Pt(r||!e||!e.__esModule?He(t,"default",{value:e,enumerable:!0}):t,e)),Ho=e=>Pt(He({},"__esModule",{value:!0}),e);var ae=h((kr,Jt)=>{var Me=require("buffer"),k=Me.Buffer;function Ct(e,r){for(var t in e)r[t]=e[t]}k.from&&k.alloc&&k.allocUnsafe&&k.allocUnsafeSlow?Jt.exports=Me:(Ct(Me,kr),kr.Buffer=z);function z(e,r,t){return k(e,r,t)}z.prototype=Object.create(k.prototype);Ct(k,z);z.from=function(e,r,t){if(typeof e=="number")throw new TypeError("Argument must not be a number");return k(e,r,t)};z.alloc=function(e,r,t){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=k(e);return r!==void 0?typeof t=="string"?n.fill(r,t):n.fill(r):n.fill(0),n};z.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return k(e)};z.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Me.SlowBuffer(e)}});var Br=h((gp,kt)=>{var Xe=ae().Buffer,Mo=require("stream"),Xo=require("util");function ze(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=Xe.alloc(0),this;if(typeof e.pipe=="function")return this.buffer=Xe.alloc(0),e.pipe(this),this;if(e.length||typeof e=="object")return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}Xo.inherits(ze,Mo);ze.prototype.write=function(r){this.buffer=Xe.concat([this.buffer,Xe.from(r)]),this.emit("data",r)};ze.prototype.end=function(r){r&&this.write(r),this.emit("end",r),this.emit("close"),this.writable=!1,this.readable=!1};kt.exports=ze});var Dt=h((wp,Bt)=>{"use strict";var xe=require("buffer").Buffer,Dr=require("buffer").SlowBuffer;Bt.exports=Ye;function Ye(e,r){if(!xe.isBuffer(e)||!xe.isBuffer(r)||e.length!==r.length)return!1;for(var t=0,n=0;n<e.length;n++)t|=e[n]^r[n];return t===0}Ye.install=function(){xe.prototype.equal=Dr.prototype.equal=function(r){return Ye(this,r)}};var zo=xe.prototype.equal,Yo=Dr.prototype.equal;Ye.restore=function(){xe.prototype.equal=zo,Dr.prototype.equal=Yo}});var Ft=h((Ep,_t)=>{"use strict";function _r(e){var r=(e/8|0)+(e%8===0?0:1);return r}var Zo={ES256:_r(256),ES384:_r(384),ES512:_r(521)};function Qo(e){var r=Zo[e];if(r)return r;throw new Error('Unknown algorithm "'+e+'"')}_t.exports=Qo});var Mt=h((Sp,Ht)=>{"use strict";var Ze=ae().Buffer,Ut=Ft(),Qe=128,Vt=0,ea=32,ra=16,ta=2,Kt=ra|ea|Vt<<6,er=ta|Vt<<6;function na(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Wt(e){if(Ze.isBuffer(e))return e;if(typeof e=="string")return Ze.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function ia(e,r){e=Wt(e);var t=Ut(r),n=t+1,i=e.length,s=0;if(e[s++]!==Kt)throw new Error('Could not find expected "seq"');var o=e[s++];if(o===(Qe|1)&&(o=e[s++]),i-s<o)throw new Error('"seq" specified length of "'+o+'", only "'+(i-s)+'" remaining');if(e[s++]!==er)throw new Error('Could not find expected "int" for "r"');var a=e[s++];if(i-s-2<a)throw new Error('"r" specified length of "'+a+'", only "'+(i-s-2)+'" available');if(n<a)throw new Error('"r" specified length of "'+a+'", max of "'+n+'" is acceptable');var u=s;if(s+=a,e[s++]!==er)throw new Error('Could not find expected "int" for "s"');var c=e[s++];if(i-s!==c)throw new Error('"s" specified length of "'+c+'", expected "'+(i-s)+'"');if(n<c)throw new Error('"s" specified length of "'+c+'", max of "'+n+'" is acceptable');var l=s;if(s+=c,s!==i)throw new Error('Expected to consume entire buffer, but "'+(i-s)+'" bytes remain');var f=t-a,g=t-c,m=Ze.allocUnsafe(f+a+g+c);for(s=0;s<f;++s)m[s]=0;e.copy(m,s,u+Math.max(-f,0),u+a),s=t;for(var v=s;s<v+g;++s)m[s]=0;return e.copy(m,s,l+Math.max(-g,0),l+c),m=m.toString("base64"),m=na(m),m}function Gt(e,r,t){for(var n=0;r+n<t&&e[r+n]===0;)++n;var i=e[r+n]>=Qe;return i&&--n,n}function sa(e,r){e=Wt(e);var t=Ut(r),n=e.length;if(n!==t*2)throw new TypeError('"'+r+'" signatures must be "'+t*2+'" bytes, saw "'+n+'"');var i=Gt(e,0,t),s=Gt(e,t,e.length),o=t-i,a=t-s,u=2+o+1+1+a,c=u<Qe,l=Ze.allocUnsafe((c?2:3)+u),f=0;return l[f++]=Kt,c?l[f++]=u:(l[f++]=Qe|1,l[f++]=u&255),l[f++]=er,l[f++]=o,i<0?(l[f++]=0,f+=e.copy(l,f,0,t)):f+=e.copy(l,f,i,t),l[f++]=er,l[f++]=a,s<0?(l[f++]=0,e.copy(l,f,t)):e.copy(l,f,t+s),l}Ht.exports={derToJose:ia,joseToDer:sa}});var Ur=h((vp,nn)=>{var oa=Dt(),ue=ae().Buffer,B=require("crypto"),zt=Mt(),Xt=require("util"),aa=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,Ae="secret must be a string or buffer",ce="key must be a string or a buffer",ca="key must be a string, a buffer or an object",Fr=typeof B.createPublicKey=="function";Fr&&(ce+=" or a KeyObject",Ae+="or a KeyObject");function Yt(e){if(!ue.isBuffer(e)&&typeof e!="string"&&(!Fr||typeof e!="object"||typeof e.type!="string"||typeof e.asymmetricKeyType!="string"||typeof e.export!="function"))throw C(ce)}function Zt(e){if(!ue.isBuffer(e)&&typeof e!="string"&&typeof e!="object")throw C(ca)}function ua(e){if(!ue.isBuffer(e)){if(typeof e=="string")return e;if(!Fr||typeof e!="object"||e.type!=="secret"||typeof e.export!="function")throw C(Ae)}}function Gr(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Qt(e){e=e.toString();var r=4-e.length%4;if(r!==4)for(var t=0;t<r;++t)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function C(e){var r=[].slice.call(arguments,1),t=Xt.format.bind(Xt,e).apply(null,r);return new TypeError(t)}function fa(e){return ue.isBuffer(e)||typeof e=="string"}function Re(e){return fa(e)||(e=JSON.stringify(e)),e}function en(e){return function(t,n){ua(n),t=Re(t);var i=B.createHmac("sha"+e,n),s=(i.update(t),i.digest("base64"));return Gr(s)}}function la(e){return function(t,n,i){var s=en(e)(t,i);return oa(ue.from(n),ue.from(s))}}function rn(e){return function(t,n){Zt(n),t=Re(t);var i=B.createSign("RSA-SHA"+e),s=(i.update(t),i.sign(n,"base64"));return Gr(s)}}function tn(e){return function(t,n,i){Yt(i),t=Re(t),n=Qt(n);var s=B.createVerify("RSA-SHA"+e);return s.update(t),s.verify(i,n,"base64")}}function ha(e){return function(t,n){Zt(n),t=Re(t);var i=B.createSign("RSA-SHA"+e),s=(i.update(t),i.sign({key:n,padding:B.constants.RSA_PKCS1_PSS_PADDING,saltLength:B.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return Gr(s)}}function pa(e){return function(t,n,i){Yt(i),t=Re(t),n=Qt(n);var s=B.createVerify("RSA-SHA"+e);return s.update(t),s.verify({key:i,padding:B.constants.RSA_PKCS1_PSS_PADDING,saltLength:B.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function da(e){var r=rn(e);return function(){var n=r.apply(null,arguments);return n=zt.derToJose(n,"ES"+e),n}}function ma(e){var r=tn(e);return function(n,i,s){i=zt.joseToDer(i,"ES"+e).toString("base64");var o=r(n,i,s);return o}}function ya(){return function(){return""}}function ga(){return function(r,t){return t===""}}nn.exports=function(r){var t={hs:en,rs:rn,ps:ha,es:da,none:ya},n={hs:la,rs:tn,ps:pa,es:ma,none:ga},i=r.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!i)throw C(aa,r);var s=(i[1]||i[3]).toLowerCase(),o=i[2];return{sign:t[s](o),verify:n[s](o)}}});var Vr=h((bp,sn)=>{var wa=require("buffer").Buffer;sn.exports=function(r){return typeof r=="string"?r:typeof r=="number"||wa.isBuffer(r)?r.toString():JSON.stringify(r)}});var ln=h((Ip,fn)=>{var Ea=ae().Buffer,on=Br(),Sa=Ur(),va=require("stream"),an=Vr(),Kr=require("util");function cn(e,r){return Ea.from(e,r).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ba(e,r,t){t=t||"utf8";var n=cn(an(e),"binary"),i=cn(an(r),t);return Kr.format("%s.%s",n,i)}function un(e){var r=e.header,t=e.payload,n=e.secret||e.privateKey,i=e.encoding,s=Sa(r.alg),o=ba(r,t,i),a=s.sign(o,n);return Kr.format("%s.%s",o,a)}function rr(e){var r=e.secret||e.privateKey||e.key,t=new on(r);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=t,this.payload=new on(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}Kr.inherits(rr,va);rr.prototype.sign=function(){try{var r=un({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",r),this.emit("data",r),this.emit("end"),this.readable=!1,r}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}};rr.sign=un;fn.exports=rr});var vn=h((xp,Sn)=>{var pn=ae().Buffer,hn=Br(),Ia=Ur(),xa=require("stream"),dn=Vr(),Aa=require("util"),Ra=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function Ta(e){return Object.prototype.toString.call(e)==="[object Object]"}function $a(e){if(Ta(e))return e;try{return JSON.parse(e)}catch{return}}function mn(e){var r=e.split(".",1)[0];return $a(pn.from(r,"base64").toString("binary"))}function Oa(e){return e.split(".",2).join(".")}function yn(e){return e.split(".")[2]}function Na(e,r){r=r||"utf8";var t=e.split(".")[1];return pn.from(t,"base64").toString(r)}function gn(e){return Ra.test(e)&&!!mn(e)}function wn(e,r,t){if(!r){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}e=dn(e);var i=yn(e),s=Oa(e),o=Ia(r);return o.verify(s,i,t)}function En(e,r){if(r=r||{},e=dn(e),!gn(e))return null;var t=mn(e);if(!t)return null;var n=Na(e);return(t.typ==="JWT"||r.json)&&(n=JSON.parse(n,r.encoding)),{header:t,payload:n,signature:yn(e)}}function fe(e){e=e||{};var r=e.secret||e.publicKey||e.key,t=new hn(r);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=t,this.signature=new hn(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}Aa.inherits(fe,xa);fe.prototype.verify=function(){try{var r=wn(this.signature.buffer,this.algorithm,this.key.buffer),t=En(this.signature.buffer,this.encoding);return this.emit("done",r,t),this.emit("data",r),this.emit("end"),this.readable=!1,r}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};fe.decode=En;fe.isValid=gn;fe.verify=wn;Sn.exports=fe});var nr=h(H=>{var bn=ln(),tr=vn(),La=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];H.ALGORITHMS=La;H.sign=bn.sign;H.verify=tr.verify;H.decode=tr.decode;H.isValid=tr.isValid;H.createSign=function(r){return new bn(r)};H.createVerify=function(r){return new tr(r)}});var Wr=h((Rp,In)=>{var qa=nr();In.exports=function(e,r){r=r||{};var t=qa.decode(e,r);if(!t)return null;var n=t.payload;if(typeof n=="string")try{var i=JSON.parse(n);i!==null&&typeof i=="object"&&(n=i)}catch{}return r.complete===!0?{header:t.header,payload:n,signature:t.signature}:n}});var Te=h((Tp,xn)=>{var ir=function(e,r){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,r&&(this.inner=r)};ir.prototype=Object.create(Error.prototype);ir.prototype.constructor=ir;xn.exports=ir});var Hr=h(($p,Rn)=>{var An=Te(),sr=function(e,r){An.call(this,e),this.name="NotBeforeError",this.date=r};sr.prototype=Object.create(An.prototype);sr.prototype.constructor=sr;Rn.exports=sr});var Mr=h((Op,$n)=>{var Tn=Te(),or=function(e,r){Tn.call(this,e),this.name="TokenExpiredError",this.expiredAt=r};or.prototype=Object.create(Tn.prototype);or.prototype.constructor=or;$n.exports=or});var Nn=h((Np,On)=>{var le=1e3,he=le*60,pe=he*60,Y=pe*24,ja=Y*7,Pa=Y*365.25;On.exports=function(e,r){r=r||{};var t=typeof e;if(t==="string"&&e.length>0)return Ca(e);if(t==="number"&&isFinite(e))return r.long?ka(e):Ja(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Ca(e){if(e=String(e),!(e.length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var t=parseFloat(r[1]),n=(r[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*Pa;case"weeks":case"week":case"w":return t*ja;case"days":case"day":case"d":return t*Y;case"hours":case"hour":case"hrs":case"hr":case"h":return t*pe;case"minutes":case"minute":case"mins":case"min":case"m":return t*he;case"seconds":case"second":case"secs":case"sec":case"s":return t*le;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Ja(e){var r=Math.abs(e);return r>=Y?Math.round(e/Y)+"d":r>=pe?Math.round(e/pe)+"h":r>=he?Math.round(e/he)+"m":r>=le?Math.round(e/le)+"s":e+"ms"}function ka(e){var r=Math.abs(e);return r>=Y?ar(e,r,Y,"day"):r>=pe?ar(e,r,pe,"hour"):r>=he?ar(e,r,he,"minute"):r>=le?ar(e,r,le,"second"):e+" ms"}function ar(e,r,t,n){var i=r>=t*1.5;return Math.round(e/t)+" "+n+(i?"s":"")}});var Xr=h((Lp,Ln)=>{var Ba=Nn();Ln.exports=function(e,r){var t=r||Math.floor(Date.now()/1e3);if(typeof e=="string"){var n=Ba(e);return typeof n>"u"?void 0:Math.floor(t+n/1e3)}else return typeof e=="number"?t+e:void 0}});var $e=h((qp,qn)=>{var Da="2.0.0",_a=Number.MAX_SAFE_INTEGER||9007199254740991,Fa=16,Ga=250,Ua=["major","premajor","minor","preminor","patch","prepatch","prerelease"];qn.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Fa,MAX_SAFE_BUILD_LENGTH:Ga,MAX_SAFE_INTEGER:_a,RELEASE_TYPES:Ua,SEMVER_SPEC_VERSION:Da,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Oe=h((jp,jn)=>{var Va=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};jn.exports=Va});var de=h((_,Pn)=>{var{MAX_SAFE_COMPONENT_LENGTH:zr,MAX_SAFE_BUILD_LENGTH:Ka,MAX_LENGTH:Wa}=$e(),Ha=Oe();_=Pn.exports={};var Ma=_.re=[],Xa=_.safeRe=[],p=_.src=[],d=_.t={},za=0,Yr="[a-zA-Z0-9-]",Ya=[["\\s",1],["\\d",Wa],[Yr,Ka]],Za=e=>{for(let[r,t]of Ya)e=e.split(`${r}*`).join(`${r}{0,${t}}`).split(`${r}+`).join(`${r}{1,${t}}`);return e},y=(e,r,t)=>{let n=Za(r),i=za++;Ha(e,i,r),d[e]=i,p[i]=r,Ma[i]=new RegExp(r,t?"g":void 0),Xa[i]=new RegExp(n,t?"g":void 0)};y("NUMERICIDENTIFIER","0|[1-9]\\d*");y("NUMERICIDENTIFIERLOOSE","\\d+");y("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Yr}*`);y("MAINVERSION",`(${p[d.NUMERICIDENTIFIER]})\\.(${p[d.NUMERICIDENTIFIER]})\\.(${p[d.NUMERICIDENTIFIER]})`);y("MAINVERSIONLOOSE",`(${p[d.NUMERICIDENTIFIERLOOSE]})\\.(${p[d.NUMERICIDENTIFIERLOOSE]})\\.(${p[d.NUMERICIDENTIFIERLOOSE]})`);y("PRERELEASEIDENTIFIER",`(?:${p[d.NUMERICIDENTIFIER]}|${p[d.NONNUMERICIDENTIFIER]})`);y("PRERELEASEIDENTIFIERLOOSE",`(?:${p[d.NUMERICIDENTIFIERLOOSE]}|${p[d.NONNUMERICIDENTIFIER]})`);y("PRERELEASE",`(?:-(${p[d.PRERELEASEIDENTIFIER]}(?:\\.${p[d.PRERELEASEIDENTIFIER]})*))`);y("PRERELEASELOOSE",`(?:-?(${p[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${p[d.PRERELEASEIDENTIFIERLOOSE]})*))`);y("BUILDIDENTIFIER",`${Yr}+`);y("BUILD",`(?:\\+(${p[d.BUILDIDENTIFIER]}(?:\\.${p[d.BUILDIDENTIFIER]})*))`);y("FULLPLAIN",`v?${p[d.MAINVERSION]}${p[d.PRERELEASE]}?${p[d.BUILD]}?`);y("FULL",`^${p[d.FULLPLAIN]}$`);y("LOOSEPLAIN",`[v=\\s]*${p[d.MAINVERSIONLOOSE]}${p[d.PRERELEASELOOSE]}?${p[d.BUILD]}?`);y("LOOSE",`^${p[d.LOOSEPLAIN]}$`);y("GTLT","((?:<|>)?=?)");y("XRANGEIDENTIFIERLOOSE",`${p[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);y("XRANGEIDENTIFIER",`${p[d.NUMERICIDENTIFIER]}|x|X|\\*`);y("XRANGEPLAIN",`[v=\\s]*(${p[d.XRANGEIDENTIFIER]})(?:\\.(${p[d.XRANGEIDENTIFIER]})(?:\\.(${p[d.XRANGEIDENTIFIER]})(?:${p[d.PRERELEASE]})?${p[d.BUILD]}?)?)?`);y("XRANGEPLAINLOOSE",`[v=\\s]*(${p[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${p[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${p[d.XRANGEIDENTIFIERLOOSE]})(?:${p[d.PRERELEASELOOSE]})?${p[d.BUILD]}?)?)?`);y("XRANGE",`^${p[d.GTLT]}\\s*${p[d.XRANGEPLAIN]}$`);y("XRANGELOOSE",`^${p[d.GTLT]}\\s*${p[d.XRANGEPLAINLOOSE]}$`);y("COERCEPLAIN",`(^|[^\\d])(\\d{1,${zr}})(?:\\.(\\d{1,${zr}}))?(?:\\.(\\d{1,${zr}}))?`);y("COERCE",`${p[d.COERCEPLAIN]}(?:$|[^\\d])`);y("COERCEFULL",p[d.COERCEPLAIN]+`(?:${p[d.PRERELEASE]})?(?:${p[d.BUILD]})?(?:$|[^\\d])`);y("COERCERTL",p[d.COERCE],!0);y("COERCERTLFULL",p[d.COERCEFULL],!0);y("LONETILDE","(?:~>?)");y("TILDETRIM",`(\\s*)${p[d.LONETILDE]}\\s+`,!0);_.tildeTrimReplace="$1~";y("TILDE",`^${p[d.LONETILDE]}${p[d.XRANGEPLAIN]}$`);y("TILDELOOSE",`^${p[d.LONETILDE]}${p[d.XRANGEPLAINLOOSE]}$`);y("LONECARET","(?:\\^)");y("CARETTRIM",`(\\s*)${p[d.LONECARET]}\\s+`,!0);_.caretTrimReplace="$1^";y("CARET",`^${p[d.LONECARET]}${p[d.XRANGEPLAIN]}$`);y("CARETLOOSE",`^${p[d.LONECARET]}${p[d.XRANGEPLAINLOOSE]}$`);y("COMPARATORLOOSE",`^${p[d.GTLT]}\\s*(${p[d.LOOSEPLAIN]})$|^$`);y("COMPARATOR",`^${p[d.GTLT]}\\s*(${p[d.FULLPLAIN]})$|^$`);y("COMPARATORTRIM",`(\\s*)${p[d.GTLT]}\\s*(${p[d.LOOSEPLAIN]}|${p[d.XRANGEPLAIN]})`,!0);_.comparatorTrimReplace="$1$2$3";y("HYPHENRANGE",`^\\s*(${p[d.XRANGEPLAIN]})\\s+-\\s+(${p[d.XRANGEPLAIN]})\\s*$`);y("HYPHENRANGELOOSE",`^\\s*(${p[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${p[d.XRANGEPLAINLOOSE]})\\s*$`);y("STAR","(<|>)?=?\\s*\\*");y("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");y("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var cr=h((Pp,Cn)=>{var Qa=Object.freeze({loose:!0}),ec=Object.freeze({}),rc=e=>e?typeof e!="object"?Qa:e:ec;Cn.exports=rc});var Zr=h((Cp,Bn)=>{var Jn=/^[0-9]+$/,kn=(e,r)=>{let t=Jn.test(e),n=Jn.test(r);return t&&n&&(e=+e,r=+r),e===r?0:t&&!n?-1:n&&!t?1:e<r?-1:1},tc=(e,r)=>kn(r,e);Bn.exports={compareIdentifiers:kn,rcompareIdentifiers:tc}});var A=h((Jp,Gn)=>{var ur=Oe(),{MAX_LENGTH:Dn,MAX_SAFE_INTEGER:fr}=$e(),{safeRe:_n,t:Fn}=de(),nc=cr(),{compareIdentifiers:me}=Zr(),Qr=class e{constructor(r,t){if(t=nc(t),r instanceof e){if(r.loose===!!t.loose&&r.includePrerelease===!!t.includePrerelease)return r;r=r.version}else if(typeof r!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof r}".`);if(r.length>Dn)throw new TypeError(`version is longer than ${Dn} characters`);ur("SemVer",r,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=r.trim().match(t.loose?_n[Fn.LOOSE]:_n[Fn.FULL]);if(!n)throw new TypeError(`Invalid Version: ${r}`);if(this.raw=r,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>fr||this.major<0)throw new TypeError("Invalid major version");if(this.minor>fr||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>fr||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<fr)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(r){if(ur("SemVer.compare",this.version,this.options,r),!(r instanceof e)){if(typeof r=="string"&&r===this.version)return 0;r=new e(r,this.options)}return r.version===this.version?0:this.compareMain(r)||this.comparePre(r)}compareMain(r){return r instanceof e||(r=new e(r,this.options)),me(this.major,r.major)||me(this.minor,r.minor)||me(this.patch,r.patch)}comparePre(r){if(r instanceof e||(r=new e(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=r.prerelease[t];if(ur("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return me(n,i)}while(++t)}compareBuild(r){r instanceof e||(r=new e(r,this.options));let t=0;do{let n=this.build[t],i=r.build[t];if(ur("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return me(n,i)}while(++t)}inc(r,t,n){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];n===!1&&(s=[t]),me(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${r}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Gn.exports=Qr});var Z=h((kp,Vn)=>{var Un=A(),ic=(e,r,t=!1)=>{if(e instanceof Un)return e;try{return new Un(e,r)}catch(n){if(!t)return null;throw n}};Vn.exports=ic});var Wn=h((Bp,Kn)=>{var sc=Z(),oc=(e,r)=>{let t=sc(e,r);return t?t.version:null};Kn.exports=oc});var Mn=h((Dp,Hn)=>{var ac=Z(),cc=(e,r)=>{let t=ac(e.trim().replace(/^[=v]+/,""),r);return t?t.version:null};Hn.exports=cc});var Yn=h((_p,zn)=>{var Xn=A(),uc=(e,r,t,n,i)=>{typeof t=="string"&&(i=n,n=t,t=void 0);try{return new Xn(e instanceof Xn?e.version:e,t).inc(r,n,i).version}catch{return null}};zn.exports=uc});var ei=h((Fp,Qn)=>{var Zn=Z(),fc=(e,r)=>{let t=Zn(e,null,!0),n=Zn(r,null,!0),i=t.compare(n);if(i===0)return null;let s=i>0,o=s?t:n,a=s?n:t,u=!!o.prerelease.length;if(!!a.prerelease.length&&!u)return!a.patch&&!a.minor?"major":o.patch?"patch":o.minor?"minor":"major";let l=u?"pre":"";return t.major!==n.major?l+"major":t.minor!==n.minor?l+"minor":t.patch!==n.patch?l+"patch":"prerelease"};Qn.exports=fc});var ti=h((Gp,ri)=>{var lc=A(),hc=(e,r)=>new lc(e,r).major;ri.exports=hc});var ii=h((Up,ni)=>{var pc=A(),dc=(e,r)=>new pc(e,r).minor;ni.exports=dc});var oi=h((Vp,si)=>{var mc=A(),yc=(e,r)=>new mc(e,r).patch;si.exports=yc});var ci=h((Kp,ai)=>{var gc=Z(),wc=(e,r)=>{let t=gc(e,r);return t&&t.prerelease.length?t.prerelease:null};ai.exports=wc});var j=h((Wp,fi)=>{var ui=A(),Ec=(e,r,t)=>new ui(e,t).compare(new ui(r,t));fi.exports=Ec});var hi=h((Hp,li)=>{var Sc=j(),vc=(e,r,t)=>Sc(r,e,t);li.exports=vc});var di=h((Mp,pi)=>{var bc=j(),Ic=(e,r)=>bc(e,r,!0);pi.exports=Ic});var lr=h((Xp,yi)=>{var mi=A(),xc=(e,r,t)=>{let n=new mi(e,t),i=new mi(r,t);return n.compare(i)||n.compareBuild(i)};yi.exports=xc});var wi=h((zp,gi)=>{var Ac=lr(),Rc=(e,r)=>e.sort((t,n)=>Ac(t,n,r));gi.exports=Rc});var Si=h((Yp,Ei)=>{var Tc=lr(),$c=(e,r)=>e.sort((t,n)=>Tc(n,t,r));Ei.exports=$c});var Ne=h((Zp,vi)=>{var Oc=j(),Nc=(e,r,t)=>Oc(e,r,t)>0;vi.exports=Nc});var hr=h((Qp,bi)=>{var Lc=j(),qc=(e,r,t)=>Lc(e,r,t)<0;bi.exports=qc});var et=h((ed,Ii)=>{var jc=j(),Pc=(e,r,t)=>jc(e,r,t)===0;Ii.exports=Pc});var rt=h((rd,xi)=>{var Cc=j(),Jc=(e,r,t)=>Cc(e,r,t)!==0;xi.exports=Jc});var pr=h((td,Ai)=>{var kc=j(),Bc=(e,r,t)=>kc(e,r,t)>=0;Ai.exports=Bc});var dr=h((nd,Ri)=>{var Dc=j(),_c=(e,r,t)=>Dc(e,r,t)<=0;Ri.exports=_c});var tt=h((id,Ti)=>{var Fc=et(),Gc=rt(),Uc=Ne(),Vc=pr(),Kc=hr(),Wc=dr(),Hc=(e,r,t,n)=>{switch(r){case"===":return typeof e=="object"&&(e=e.version),typeof t=="object"&&(t=t.version),e===t;case"!==":return typeof e=="object"&&(e=e.version),typeof t=="object"&&(t=t.version),e!==t;case"":case"=":case"==":return Fc(e,t,n);case"!=":return Gc(e,t,n);case">":return Uc(e,t,n);case">=":return Vc(e,t,n);case"<":return Kc(e,t,n);case"<=":return Wc(e,t,n);default:throw new TypeError(`Invalid operator: ${r}`)}};Ti.exports=Hc});var Oi=h((sd,$i)=>{var Mc=A(),Xc=Z(),{safeRe:mr,t:yr}=de(),zc=(e,r)=>{if(e instanceof Mc)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;r=r||{};let t=null;if(!r.rtl)t=e.match(r.includePrerelease?mr[yr.COERCEFULL]:mr[yr.COERCE]);else{let u=r.includePrerelease?mr[yr.COERCERTLFULL]:mr[yr.COERCERTL],c;for(;(c=u.exec(e))&&(!t||t.index+t[0].length!==e.length);)(!t||c.index+c[0].length!==t.index+t[0].length)&&(t=c),u.lastIndex=c.index+c[1].length+c[2].length;u.lastIndex=-1}if(t===null)return null;let n=t[2],i=t[3]||"0",s=t[4]||"0",o=r.includePrerelease&&t[5]?`-${t[5]}`:"",a=r.includePrerelease&&t[6]?`+${t[6]}`:"";return Xc(`${n}.${i}.${s}${o}${a}`,r)};$i.exports=zc});var Li=h((od,Ni)=>{"use strict";Ni.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let r=this.head;r;r=r.next)yield r.value}}});var ji=h((ad,qi)=>{"use strict";qi.exports=w;w.Node=Q;w.create=w;function w(e){var r=this;if(r instanceof w||(r=new w),r.tail=null,r.head=null,r.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){r.push(i)});else if(arguments.length>0)for(var t=0,n=arguments.length;t<n;t++)r.push(arguments[t]);return r}w.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var r=e.next,t=e.prev;return r&&(r.prev=t),t&&(t.next=r),e===this.head&&(this.head=r),e===this.tail&&(this.tail=t),e.list.length--,e.next=null,e.prev=null,e.list=null,r};w.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var r=this.head;e.list=this,e.next=r,r&&(r.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};w.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var r=this.tail;e.list=this,e.prev=r,r&&(r.next=e),this.tail=e,this.head||(this.head=e),this.length++}};w.prototype.push=function(){for(var e=0,r=arguments.length;e<r;e++)Zc(this,arguments[e]);return this.length};w.prototype.unshift=function(){for(var e=0,r=arguments.length;e<r;e++)Qc(this,arguments[e]);return this.length};w.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};w.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};w.prototype.forEach=function(e,r){r=r||this;for(var t=this.head,n=0;t!==null;n++)e.call(r,t.value,n,this),t=t.next};w.prototype.forEachReverse=function(e,r){r=r||this;for(var t=this.tail,n=this.length-1;t!==null;n--)e.call(r,t.value,n,this),t=t.prev};w.prototype.get=function(e){for(var r=0,t=this.head;t!==null&&r<e;r++)t=t.next;if(r===e&&t!==null)return t.value};w.prototype.getReverse=function(e){for(var r=0,t=this.tail;t!==null&&r<e;r++)t=t.prev;if(r===e&&t!==null)return t.value};w.prototype.map=function(e,r){r=r||this;for(var t=new w,n=this.head;n!==null;)t.push(e.call(r,n.value,this)),n=n.next;return t};w.prototype.mapReverse=function(e,r){r=r||this;for(var t=new w,n=this.tail;n!==null;)t.push(e.call(r,n.value,this)),n=n.prev;return t};w.prototype.reduce=function(e,r){var t,n=this.head;if(arguments.length>1)t=r;else if(this.head)n=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)t=e(t,n.value,i),n=n.next;return t};w.prototype.reduceReverse=function(e,r){var t,n=this.tail;if(arguments.length>1)t=r;else if(this.tail)n=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)t=e(t,n.value,i),n=n.prev;return t};w.prototype.toArray=function(){for(var e=new Array(this.length),r=0,t=this.head;t!==null;r++)e[r]=t.value,t=t.next;return e};w.prototype.toArrayReverse=function(){for(var e=new Array(this.length),r=0,t=this.tail;t!==null;r++)e[r]=t.value,t=t.prev;return e};w.prototype.slice=function(e,r){r=r||this.length,r<0&&(r+=this.length),e=e||0,e<0&&(e+=this.length);var t=new w;if(r<e||r<0)return t;e<0&&(e=0),r>this.length&&(r=this.length);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(;i!==null&&n<r;n++,i=i.next)t.push(i.value);return t};w.prototype.sliceReverse=function(e,r){r=r||this.length,r<0&&(r+=this.length),e=e||0,e<0&&(e+=this.length);var t=new w;if(r<e||r<0)return t;e<0&&(e=0),r>this.length&&(r=this.length);for(var n=this.length,i=this.tail;i!==null&&n>r;n--)i=i.prev;for(;i!==null&&n>e;n--,i=i.prev)t.push(i.value);return t};w.prototype.splice=function(e,r,...t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(var s=[],n=0;i&&n<r;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<t.length;n++)i=Yc(this,i,t[n]);return s};w.prototype.reverse=function(){for(var e=this.head,r=this.tail,t=e;t!==null;t=t.prev){var n=t.prev;t.prev=t.next,t.next=n}return this.head=r,this.tail=e,this};function Yc(e,r,t){var n=r===e.head?new Q(t,null,r,e):new Q(t,r,r.next,e);return n.next===null&&(e.tail=n),n.prev===null&&(e.head=n),e.length++,n}function Zc(e,r){e.tail=new Q(r,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function Qc(e,r){e.head=new Q(r,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Q(e,r,t,n){if(!(this instanceof Q))return new Q(e,r,t,n);this.list=n,this.value=e,r?(r.next=this,this.prev=r):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{Li()(w)}catch{}});var Bi=h((cd,ki)=>{"use strict";var eu=ji(),ee=Symbol("max"),G=Symbol("length"),ye=Symbol("lengthCalculator"),qe=Symbol("allowStale"),re=Symbol("maxAge"),F=Symbol("dispose"),Pi=Symbol("noDisposeOnSet"),I=Symbol("lruList"),J=Symbol("cache"),Ji=Symbol("updateAgeOnGet"),nt=()=>1,st=class{constructor(r){if(typeof r=="number"&&(r={max:r}),r||(r={}),r.max&&(typeof r.max!="number"||r.max<0))throw new TypeError("max must be a non-negative number");let t=this[ee]=r.max||1/0,n=r.length||nt;if(this[ye]=typeof n!="function"?nt:n,this[qe]=r.stale||!1,r.maxAge&&typeof r.maxAge!="number")throw new TypeError("maxAge must be a number");this[re]=r.maxAge||0,this[F]=r.dispose,this[Pi]=r.noDisposeOnSet||!1,this[Ji]=r.updateAgeOnGet||!1,this.reset()}set max(r){if(typeof r!="number"||r<0)throw new TypeError("max must be a non-negative number");this[ee]=r||1/0,Le(this)}get max(){return this[ee]}set allowStale(r){this[qe]=!!r}get allowStale(){return this[qe]}set maxAge(r){if(typeof r!="number")throw new TypeError("maxAge must be a non-negative number");this[re]=r,Le(this)}get maxAge(){return this[re]}set lengthCalculator(r){typeof r!="function"&&(r=nt),r!==this[ye]&&(this[ye]=r,this[G]=0,this[I].forEach(t=>{t.length=this[ye](t.value,t.key),this[G]+=t.length})),Le(this)}get lengthCalculator(){return this[ye]}get length(){return this[G]}get itemCount(){return this[I].length}rforEach(r,t){t=t||this;for(let n=this[I].tail;n!==null;){let i=n.prev;Ci(this,r,n,t),n=i}}forEach(r,t){t=t||this;for(let n=this[I].head;n!==null;){let i=n.next;Ci(this,r,n,t),n=i}}keys(){return this[I].toArray().map(r=>r.key)}values(){return this[I].toArray().map(r=>r.value)}reset(){this[F]&&this[I]&&this[I].length&&this[I].forEach(r=>this[F](r.key,r.value)),this[J]=new Map,this[I]=new eu,this[G]=0}dump(){return this[I].map(r=>gr(this,r)?!1:{k:r.key,v:r.value,e:r.now+(r.maxAge||0)}).toArray().filter(r=>r)}dumpLru(){return this[I]}set(r,t,n){if(n=n||this[re],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let i=n?Date.now():0,s=this[ye](t,r);if(this[J].has(r)){if(s>this[ee])return ge(this,this[J].get(r)),!1;let u=this[J].get(r).value;return this[F]&&(this[Pi]||this[F](r,u.value)),u.now=i,u.maxAge=n,u.value=t,this[G]+=s-u.length,u.length=s,this.get(r),Le(this),!0}let o=new ot(r,t,s,i,n);return o.length>this[ee]?(this[F]&&this[F](r,t),!1):(this[G]+=o.length,this[I].unshift(o),this[J].set(r,this[I].head),Le(this),!0)}has(r){if(!this[J].has(r))return!1;let t=this[J].get(r).value;return!gr(this,t)}get(r){return it(this,r,!0)}peek(r){return it(this,r,!1)}pop(){let r=this[I].tail;return r?(ge(this,r),r.value):null}del(r){ge(this,this[J].get(r))}load(r){this.reset();let t=Date.now();for(let n=r.length-1;n>=0;n--){let i=r[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{let o=s-t;o>0&&this.set(i.k,i.v,o)}}}prune(){this[J].forEach((r,t)=>it(this,t,!1))}},it=(e,r,t)=>{let n=e[J].get(r);if(n){let i=n.value;if(gr(e,i)){if(ge(e,n),!e[qe])return}else t&&(e[Ji]&&(n.value.now=Date.now()),e[I].unshiftNode(n));return i.value}},gr=(e,r)=>{if(!r||!r.maxAge&&!e[re])return!1;let t=Date.now()-r.now;return r.maxAge?t>r.maxAge:e[re]&&t>e[re]},Le=e=>{if(e[G]>e[ee])for(let r=e[I].tail;e[G]>e[ee]&&r!==null;){let t=r.prev;ge(e,r),r=t}},ge=(e,r)=>{if(r){let t=r.value;e[F]&&e[F](t.key,t.value),e[G]-=t.length,e[J].delete(t.key),e[I].removeNode(r)}},ot=class{constructor(r,t,n,i,s){this.key=r,this.value=t,this.length=n,this.now=i,this.maxAge=s||0}},Ci=(e,r,t,n)=>{let i=t.value;gr(e,i)&&(ge(e,t),e[qe]||(i=void 0)),i&&r.call(n,i.value,i.key,e)};ki.exports=st});var P=h((ud,Gi)=>{var at=class e{constructor(r,t){if(t=tu(t),r instanceof e)return r.loose===!!t.loose&&r.includePrerelease===!!t.includePrerelease?r:new e(r.raw,t);if(r instanceof ct)return this.raw=r.value,this.set=[[r]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=r.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(i=>!_i(i[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&uu(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(r=>r.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(r){let n=((this.options.includePrerelease&&au)|(this.options.loose&&cu))+":"+r,i=Di.get(n);if(i)return i;let s=this.options.loose,o=s?N[T.HYPHENRANGELOOSE]:N[T.HYPHENRANGE];r=r.replace(o,Eu(this.options.includePrerelease)),S("hyphen replace",r),r=r.replace(N[T.COMPARATORTRIM],iu),S("comparator trim",r),r=r.replace(N[T.TILDETRIM],su),S("tilde trim",r),r=r.replace(N[T.CARETTRIM],ou),S("caret trim",r);let a=r.split(" ").map(f=>fu(f,this.options)).join(" ").split(/\s+/).map(f=>wu(f,this.options));s&&(a=a.filter(f=>(S("loose invalid filter",f,this.options),!!f.match(N[T.COMPARATORLOOSE])))),S("range list",a);let u=new Map,c=a.map(f=>new ct(f,this.options));for(let f of c){if(_i(f))return[f];u.set(f.value,f)}u.size>1&&u.has("")&&u.delete("");let l=[...u.values()];return Di.set(n,l),l}intersects(r,t){if(!(r instanceof e))throw new TypeError("a Range is required");return this.set.some(n=>Fi(n,t)&&r.set.some(i=>Fi(i,t)&&n.every(s=>i.every(o=>s.intersects(o,t)))))}test(r){if(!r)return!1;if(typeof r=="string")try{r=new nu(r,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(Su(this.set[t],r,this.options))return!0;return!1}};Gi.exports=at;var ru=Bi(),Di=new ru({max:1e3}),tu=cr(),ct=je(),S=Oe(),nu=A(),{safeRe:N,t:T,comparatorTrimReplace:iu,tildeTrimReplace:su,caretTrimReplace:ou}=de(),{FLAG_INCLUDE_PRERELEASE:au,FLAG_LOOSE:cu}=$e(),_i=e=>e.value==="<0.0.0-0",uu=e=>e.value==="",Fi=(e,r)=>{let t=!0,n=e.slice(),i=n.pop();for(;t&&n.length;)t=n.every(s=>i.intersects(s,r)),i=n.pop();return t},fu=(e,r)=>(S("comp",e,r),e=pu(e,r),S("caret",e),e=lu(e,r),S("tildes",e),e=mu(e,r),S("xrange",e),e=gu(e,r),S("stars",e),e),$=e=>!e||e.toLowerCase()==="x"||e==="*",lu=(e,r)=>e.trim().split(/\s+/).map(t=>hu(t,r)).join(" "),hu=(e,r)=>{let t=r.loose?N[T.TILDELOOSE]:N[T.TILDE];return e.replace(t,(n,i,s,o,a)=>{S("tilde",e,n,i,s,o,a);let u;return $(i)?u="":$(s)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:$(o)?u=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(S("replaceTilde pr",a),u=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):u=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,S("tilde return",u),u})},pu=(e,r)=>e.trim().split(/\s+/).map(t=>du(t,r)).join(" "),du=(e,r)=>{S("caret",e,r);let t=r.loose?N[T.CARETLOOSE]:N[T.CARET],n=r.includePrerelease?"-0":"";return e.replace(t,(i,s,o,a,u)=>{S("caret",e,i,s,o,a,u);let c;return $(s)?c="":$(o)?c=`>=${s}.0.0${n} <${+s+1}.0.0-0`:$(a)?s==="0"?c=`>=${s}.${o}.0${n} <${s}.${+o+1}.0-0`:c=`>=${s}.${o}.0${n} <${+s+1}.0.0-0`:u?(S("replaceCaret pr",u),s==="0"?o==="0"?c=`>=${s}.${o}.${a}-${u} <${s}.${o}.${+a+1}-0`:c=`>=${s}.${o}.${a}-${u} <${s}.${+o+1}.0-0`:c=`>=${s}.${o}.${a}-${u} <${+s+1}.0.0-0`):(S("no pr"),s==="0"?o==="0"?c=`>=${s}.${o}.${a}${n} <${s}.${o}.${+a+1}-0`:c=`>=${s}.${o}.${a}${n} <${s}.${+o+1}.0-0`:c=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),S("caret return",c),c})},mu=(e,r)=>(S("replaceXRanges",e,r),e.split(/\s+/).map(t=>yu(t,r)).join(" ")),yu=(e,r)=>{e=e.trim();let t=r.loose?N[T.XRANGELOOSE]:N[T.XRANGE];return e.replace(t,(n,i,s,o,a,u)=>{S("xRange",e,n,i,s,o,a,u);let c=$(s),l=c||$(o),f=l||$(a),g=f;return i==="="&&g&&(i=""),u=r.includePrerelease?"-0":"",c?i===">"||i==="<"?n="<0.0.0-0":n="*":i&&g?(l&&(o=0),a=0,i===">"?(i=">=",l?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",l?s=+s+1:o=+o+1),i==="<"&&(u="-0"),n=`${i+s}.${o}.${a}${u}`):l?n=`>=${s}.0.0${u} <${+s+1}.0.0-0`:f&&(n=`>=${s}.${o}.0${u} <${s}.${+o+1}.0-0`),S("xRange return",n),n})},gu=(e,r)=>(S("replaceStars",e,r),e.trim().replace(N[T.STAR],"")),wu=(e,r)=>(S("replaceGTE0",e,r),e.trim().replace(N[r.includePrerelease?T.GTE0PRE:T.GTE0],"")),Eu=e=>(r,t,n,i,s,o,a,u,c,l,f,g,m)=>($(n)?t="":$(i)?t=`>=${n}.0.0${e?"-0":""}`:$(s)?t=`>=${n}.${i}.0${e?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${e?"-0":""}`,$(c)?u="":$(l)?u=`<${+c+1}.0.0-0`:$(f)?u=`<${c}.${+l+1}.0-0`:g?u=`<=${c}.${l}.${f}-${g}`:e?u=`<${c}.${l}.${+f+1}-0`:u=`<=${u}`,`${t} ${u}`.trim()),Su=(e,r,t)=>{for(let n=0;n<e.length;n++)if(!e[n].test(r))return!1;if(r.prerelease.length&&!t.includePrerelease){for(let n=0;n<e.length;n++)if(S(e[n].semver),e[n].semver!==ct.ANY&&e[n].semver.prerelease.length>0){let i=e[n].semver;if(i.major===r.major&&i.minor===r.minor&&i.patch===r.patch)return!0}return!1}return!0}});var je=h((fd,Mi)=>{var Pe=Symbol("SemVer ANY"),lt=class e{static get ANY(){return Pe}constructor(r,t){if(t=Ui(t),r instanceof e){if(r.loose===!!t.loose)return r;r=r.value}r=r.trim().split(/\s+/).join(" "),ft("comparator",r,t),this.options=t,this.loose=!!t.loose,this.parse(r),this.semver===Pe?this.value="":this.value=this.operator+this.semver.version,ft("comp",this)}parse(r){let t=this.options.loose?Vi[Ki.COMPARATORLOOSE]:Vi[Ki.COMPARATOR],n=r.match(t);if(!n)throw new TypeError(`Invalid comparator: ${r}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Wi(n[2],this.options.loose):this.semver=Pe}toString(){return this.value}test(r){if(ft("Comparator.test",r,this.options.loose),this.semver===Pe||r===Pe)return!0;if(typeof r=="string")try{r=new Wi(r,this.options)}catch{return!1}return ut(r,this.operator,this.semver,this.options)}intersects(r,t){if(!(r instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Hi(r.value,t).test(this.value):r.operator===""?r.value===""?!0:new Hi(this.value,t).test(r.semver):(t=Ui(t),t.includePrerelease&&(this.value==="<0.0.0-0"||r.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||r.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&r.operator.startsWith(">")||this.operator.startsWith("<")&&r.operator.startsWith("<")||this.semver.version===r.semver.version&&this.operator.includes("=")&&r.operator.includes("=")||ut(this.semver,"<",r.semver,t)&&this.operator.startsWith(">")&&r.operator.startsWith("<")||ut(this.semver,">",r.semver,t)&&this.operator.startsWith("<")&&r.operator.startsWith(">")))}};Mi.exports=lt;var Ui=cr(),{safeRe:Vi,t:Ki}=de(),ut=tt(),ft=Oe(),Wi=A(),Hi=P()});var Ce=h((ld,Xi)=>{var vu=P(),bu=(e,r,t)=>{try{r=new vu(r,t)}catch{return!1}return r.test(e)};Xi.exports=bu});var Yi=h((hd,zi)=>{var Iu=P(),xu=(e,r)=>new Iu(e,r).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));zi.exports=xu});var Qi=h((pd,Zi)=>{var Au=A(),Ru=P(),Tu=(e,r,t)=>{let n=null,i=null,s=null;try{s=new Ru(r,t)}catch{return null}return e.forEach(o=>{s.test(o)&&(!n||i.compare(o)===-1)&&(n=o,i=new Au(n,t))}),n};Zi.exports=Tu});var rs=h((dd,es)=>{var $u=A(),Ou=P(),Nu=(e,r,t)=>{let n=null,i=null,s=null;try{s=new Ou(r,t)}catch{return null}return e.forEach(o=>{s.test(o)&&(!n||i.compare(o)===1)&&(n=o,i=new $u(n,t))}),n};es.exports=Nu});var is=h((md,ns)=>{var ht=A(),Lu=P(),ts=Ne(),qu=(e,r)=>{e=new Lu(e,r);let t=new ht("0.0.0");if(e.test(t)||(t=new ht("0.0.0-0"),e.test(t)))return t;t=null;for(let n=0;n<e.set.length;++n){let i=e.set[n],s=null;i.forEach(o=>{let a=new ht(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!s||ts(a,s))&&(s=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),s&&(!t||ts(t,s))&&(t=s)}return t&&e.test(t)?t:null};ns.exports=qu});var os=h((yd,ss)=>{var ju=P(),Pu=(e,r)=>{try{return new ju(e,r).range||"*"}catch{return null}};ss.exports=Pu});var wr=h((gd,fs)=>{var Cu=A(),us=je(),{ANY:Ju}=us,ku=P(),Bu=Ce(),as=Ne(),cs=hr(),Du=dr(),_u=pr(),Fu=(e,r,t,n)=>{e=new Cu(e,n),r=new ku(r,n);let i,s,o,a,u;switch(t){case">":i=as,s=Du,o=cs,a=">",u=">=";break;case"<":i=cs,s=_u,o=as,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Bu(e,r,n))return!1;for(let c=0;c<r.set.length;++c){let l=r.set[c],f=null,g=null;if(l.forEach(m=>{m.semver===Ju&&(m=new us(">=0.0.0")),f=f||m,g=g||m,i(m.semver,f.semver,n)?f=m:o(m.semver,g.semver,n)&&(g=m)}),f.operator===a||f.operator===u||(!g.operator||g.operator===a)&&s(e,g.semver))return!1;if(g.operator===u&&o(e,g.semver))return!1}return!0};fs.exports=Fu});var hs=h((wd,ls)=>{var Gu=wr(),Uu=(e,r,t)=>Gu(e,r,">",t);ls.exports=Uu});var ds=h((Ed,ps)=>{var Vu=wr(),Ku=(e,r,t)=>Vu(e,r,"<",t);ps.exports=Ku});var gs=h((Sd,ys)=>{var ms=P(),Wu=(e,r,t)=>(e=new ms(e,t),r=new ms(r,t),e.intersects(r,t));ys.exports=Wu});var Es=h((vd,ws)=>{var Hu=Ce(),Mu=j();ws.exports=(e,r,t)=>{let n=[],i=null,s=null,o=e.sort((l,f)=>Mu(l,f,t));for(let l of o)Hu(l,r,t)?(s=l,i||(i=l)):(s&&n.push([i,s]),s=null,i=null);i&&n.push([i,null]);let a=[];for(let[l,f]of n)l===f?a.push(l):!f&&l===o[0]?a.push("*"):f?l===o[0]?a.push(`<=${f}`):a.push(`${l} - ${f}`):a.push(`>=${l}`);let u=a.join(" || "),c=typeof r.raw=="string"?r.raw:String(r);return u.length<c.length?u:r}});var As=h((bd,xs)=>{var Ss=P(),dt=je(),{ANY:pt}=dt,Je=Ce(),mt=j(),Xu=(e,r,t={})=>{if(e===r)return!0;e=new Ss(e,t),r=new Ss(r,t);let n=!1;e:for(let i of e.set){for(let s of r.set){let o=Yu(i,s,t);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},zu=[new dt(">=0.0.0-0")],vs=[new dt(">=0.0.0")],Yu=(e,r,t)=>{if(e===r)return!0;if(e.length===1&&e[0].semver===pt){if(r.length===1&&r[0].semver===pt)return!0;t.includePrerelease?e=zu:e=vs}if(r.length===1&&r[0].semver===pt){if(t.includePrerelease)return!0;r=vs}let n=new Set,i,s;for(let m of e)m.operator===">"||m.operator===">="?i=bs(i,m,t):m.operator==="<"||m.operator==="<="?s=Is(s,m,t):n.add(m.semver);if(n.size>1)return null;let o;if(i&&s){if(o=mt(i.semver,s.semver,t),o>0)return null;if(o===0&&(i.operator!==">="||s.operator!=="<="))return null}for(let m of n){if(i&&!Je(m,String(i),t)||s&&!Je(m,String(s),t))return null;for(let v of r)if(!Je(m,String(v),t))return!1;return!0}let a,u,c,l,f=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1,g=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&s.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(let m of r){if(l=l||m.operator===">"||m.operator===">=",c=c||m.operator==="<"||m.operator==="<=",i){if(g&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===g.major&&m.semver.minor===g.minor&&m.semver.patch===g.patch&&(g=!1),m.operator===">"||m.operator===">="){if(a=bs(i,m,t),a===m&&a!==i)return!1}else if(i.operator===">="&&!Je(i.semver,String(m),t))return!1}if(s){if(f&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===f.major&&m.semver.minor===f.minor&&m.semver.patch===f.patch&&(f=!1),m.operator==="<"||m.operator==="<="){if(u=Is(s,m,t),u===m&&u!==s)return!1}else if(s.operator==="<="&&!Je(s.semver,String(m),t))return!1}if(!m.operator&&(s||i)&&o!==0)return!1}return!(i&&c&&!s&&o!==0||s&&l&&!i&&o!==0||g||f)},bs=(e,r,t)=>{if(!e)return r;let n=mt(e.semver,r.semver,t);return n>0?e:n<0||r.operator===">"&&e.operator===">="?r:e},Is=(e,r,t)=>{if(!e)return r;let n=mt(e.semver,r.semver,t);return n<0?e:n>0||r.operator==="<"&&e.operator==="<="?r:e};xs.exports=Xu});var Er=h((Id,$s)=>{var yt=de(),Rs=$e(),Zu=A(),Ts=Zr(),Qu=Z(),ef=Wn(),rf=Mn(),tf=Yn(),nf=ei(),sf=ti(),of=ii(),af=oi(),cf=ci(),uf=j(),ff=hi(),lf=di(),hf=lr(),pf=wi(),df=Si(),mf=Ne(),yf=hr(),gf=et(),wf=rt(),Ef=pr(),Sf=dr(),vf=tt(),bf=Oi(),If=je(),xf=P(),Af=Ce(),Rf=Yi(),Tf=Qi(),$f=rs(),Of=is(),Nf=os(),Lf=wr(),qf=hs(),jf=ds(),Pf=gs(),Cf=Es(),Jf=As();$s.exports={parse:Qu,valid:ef,clean:rf,inc:tf,diff:nf,major:sf,minor:of,patch:af,prerelease:cf,compare:uf,rcompare:ff,compareLoose:lf,compareBuild:hf,sort:pf,rsort:df,gt:mf,lt:yf,eq:gf,neq:wf,gte:Ef,lte:Sf,cmp:vf,coerce:bf,Comparator:If,Range:xf,satisfies:Af,toComparators:Rf,maxSatisfying:Tf,minSatisfying:$f,minVersion:Of,validRange:Nf,outside:Lf,gtr:qf,ltr:jf,intersects:Pf,simplifyRange:Cf,subset:Jf,SemVer:Zu,re:yt.re,src:yt.src,tokens:yt.t,SEMVER_SPEC_VERSION:Rs.SEMVER_SPEC_VERSION,RELEASE_TYPES:Rs.RELEASE_TYPES,compareIdentifiers:Ts.compareIdentifiers,rcompareIdentifiers:Ts.rcompareIdentifiers}});var Ns=h((xd,Os)=>{var kf=Er();Os.exports=kf.satisfies(process.version,">=15.7.0")});var qs=h((Ad,Ls)=>{var Bf=Er();Ls.exports=Bf.satisfies(process.version,">=16.9.0")});var gt=h((Rd,js)=>{var Df=Ns(),_f=qs(),Ff={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},Gf={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};js.exports=function(e,r){if(!e||!r)return;let t=r.asymmetricKeyType;if(!t)return;let n=Ff[t];if(!n)throw new Error(`Unknown key type "${t}".`);if(!n.includes(e))throw new Error(`"alg" parameter for "${t}" key type must be one of: ${n.join(", ")}.`);if(Df)switch(t){case"ec":let i=r.asymmetricKeyDetails.namedCurve,s=Gf[e];if(i!==s)throw new Error(`"alg" parameter "${e}" requires curve "${s}".`);break;case"rsa-pss":if(_f){let o=parseInt(e.slice(-3),10),{hashAlgorithm:a,mgf1HashAlgorithm:u,saltLength:c}=r.asymmetricKeyDetails;if(a!==`sha${o}`||u!==a)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}.`);if(c!==void 0&&c>o>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}.`)}break}}});var wt=h((Td,Ps)=>{var Uf=Er();Ps.exports=Uf.satisfies(process.version,"^6.12.0 || >=8.0.0")});var ks=h(($d,Js)=>{var E=Te(),Vf=Hr(),Cs=Mr(),Kf=Wr(),Wf=Xr(),Hf=gt(),Mf=wt(),Xf=nr(),{KeyObject:zf,createSecretKey:Yf,createPublicKey:Zf}=require("crypto"),Et=["RS256","RS384","RS512"],Qf=["ES256","ES384","ES512"],St=["RS256","RS384","RS512"],el=["HS256","HS384","HS512"];Mf&&(Et.splice(Et.length,0,"PS256","PS384","PS512"),St.splice(St.length,0,"PS256","PS384","PS512"));Js.exports=function(e,r,t,n){typeof t=="function"&&!n&&(n=t,t={}),t||(t={}),t=Object.assign({},t);let i;if(n?i=n:i=function(l,f){if(l)throw l;return f},t.clockTimestamp&&typeof t.clockTimestamp!="number")return i(new E("clockTimestamp must be a number"));if(t.nonce!==void 0&&(typeof t.nonce!="string"||t.nonce.trim()===""))return i(new E("nonce must be a non-empty string"));if(t.allowInvalidAsymmetricKeyTypes!==void 0&&typeof t.allowInvalidAsymmetricKeyTypes!="boolean")return i(new E("allowInvalidAsymmetricKeyTypes must be a boolean"));let s=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return i(new E("jwt must be provided"));if(typeof e!="string")return i(new E("jwt must be a string"));let o=e.split(".");if(o.length!==3)return i(new E("jwt malformed"));let a;try{a=Kf(e,{complete:!0})}catch(l){return i(l)}if(!a)return i(new E("invalid token"));let u=a.header,c;if(typeof r=="function"){if(!n)return i(new E("verify must be called asynchronous if secret or public key is provided as a callback"));c=r}else c=function(l,f){return f(null,r)};return c(u,function(l,f){if(l)return i(new E("error in secret or public key callback: "+l.message));let g=o[2].trim()!=="";if(!g&&f)return i(new E("jwt signature is required"));if(g&&!f)return i(new E("secret or public key must be provided"));if(!g&&!t.algorithms)return i(new E('please specify "none" in "algorithms" to verify unsigned tokens'));if(f!=null&&!(f instanceof zf))try{f=Zf(f)}catch{try{f=Yf(typeof f=="string"?Buffer.from(f):f)}catch{return i(new E("secretOrPublicKey is not valid key material"))}}if(t.algorithms||(f.type==="secret"?t.algorithms=el:["rsa","rsa-pss"].includes(f.asymmetricKeyType)?t.algorithms=St:f.asymmetricKeyType==="ec"?t.algorithms=Qf:t.algorithms=Et),t.algorithms.indexOf(a.header.alg)===-1)return i(new E("invalid algorithm"));if(u.alg.startsWith("HS")&&f.type!=="secret")return i(new E(`secretOrPublicKey must be a symmetric key when using ${u.alg}`));if(/^(?:RS|PS|ES)/.test(u.alg)&&f.type!=="public")return i(new E(`secretOrPublicKey must be an asymmetric key when using ${u.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{Hf(u.alg,f)}catch(O){return i(O)}let m;try{m=Xf.verify(e,a.header.alg,f)}catch(O){return i(O)}if(!m)return i(new E("invalid signature"));let v=a.payload;if(typeof v.nbf<"u"&&!t.ignoreNotBefore){if(typeof v.nbf!="number")return i(new E("invalid nbf value"));if(v.nbf>s+(t.clockTolerance||0))return i(new Vf("jwt not active",new Date(v.nbf*1e3)))}if(typeof v.exp<"u"&&!t.ignoreExpiration){if(typeof v.exp!="number")return i(new E("invalid exp value"));if(s>=v.exp+(t.clockTolerance||0))return i(new Cs("jwt expired",new Date(v.exp*1e3)))}if(t.audience){let O=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(v.aud)?v.aud:[v.aud]).some(function(jt){return O.some(function(Jr){return Jr instanceof RegExp?Jr.test(jt):Jr===jt})}))return i(new E("jwt audience invalid. expected: "+O.join(" or ")))}if(t.issuer&&(typeof t.issuer=="string"&&v.iss!==t.issuer||Array.isArray(t.issuer)&&t.issuer.indexOf(v.iss)===-1))return i(new E("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&v.sub!==t.subject)return i(new E("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&v.jti!==t.jwtid)return i(new E("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&v.nonce!==t.nonce)return i(new E("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if(typeof v.iat!="number")return i(new E("iat required when maxAge is specified"));let O=Wf(t.maxAge,v.iat);if(typeof O>"u")return i(new E('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(s>=O+(t.clockTolerance||0))return i(new Cs("maxAge exceeded",new Date(O*1e3)))}if(t.complete===!0){let O=a.signature;return i(null,{header:u,payload:v,signature:O})}return i(null,v)})}});var Us=h((Od,Gs)=>{var Bs=1/0,_s=9007199254740991,rl=17976931348623157e292,Ds=NaN,tl="[object Arguments]",nl="[object Function]",il="[object GeneratorFunction]",sl="[object String]",ol="[object Symbol]",al=/^\s+|\s+$/g,cl=/^[-+]0x[0-9a-f]+$/i,ul=/^0b[01]+$/i,fl=/^0o[0-7]+$/i,ll=/^(?:0|[1-9]\d*)$/,hl=parseInt;function pl(e,r){for(var t=-1,n=e?e.length:0,i=Array(n);++t<n;)i[t]=r(e[t],t,e);return i}function dl(e,r,t,n){for(var i=e.length,s=t+(n?1:-1);n?s--:++s<i;)if(r(e[s],s,e))return s;return-1}function ml(e,r,t){if(r!==r)return dl(e,yl,t);for(var n=t-1,i=e.length;++n<i;)if(e[n]===r)return n;return-1}function yl(e){return e!==e}function gl(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}function wl(e,r){return pl(r,function(t){return e[t]})}function El(e,r){return function(t){return e(r(t))}}var Sr=Object.prototype,bt=Sr.hasOwnProperty,vr=Sr.toString,Sl=Sr.propertyIsEnumerable,vl=El(Object.keys,Object),bl=Math.max;function Il(e,r){var t=Fs(e)||$l(e)?gl(e.length,String):[],n=t.length,i=!!n;for(var s in e)(r||bt.call(e,s))&&!(i&&(s=="length"||Al(s,n)))&&t.push(s);return t}function xl(e){if(!Rl(e))return vl(e);var r=[];for(var t in Object(e))bt.call(e,t)&&t!="constructor"&&r.push(t);return r}function Al(e,r){return r=r??_s,!!r&&(typeof e=="number"||ll.test(e))&&e>-1&&e%1==0&&e<r}function Rl(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||Sr;return e===t}function Tl(e,r,t,n){e=It(e)?e:Bl(e),t=t&&!n?Cl(t):0;var i=e.length;return t<0&&(t=bl(i+t,0)),ql(e)?t<=i&&e.indexOf(r,t)>-1:!!i&&ml(e,r,t)>-1}function $l(e){return Ol(e)&&bt.call(e,"callee")&&(!Sl.call(e,"callee")||vr.call(e)==tl)}var Fs=Array.isArray;function It(e){return e!=null&&Ll(e.length)&&!Nl(e)}function Ol(e){return xt(e)&&It(e)}function Nl(e){var r=vt(e)?vr.call(e):"";return r==nl||r==il}function Ll(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=_s}function vt(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function xt(e){return!!e&&typeof e=="object"}function ql(e){return typeof e=="string"||!Fs(e)&&xt(e)&&vr.call(e)==sl}function jl(e){return typeof e=="symbol"||xt(e)&&vr.call(e)==ol}function Pl(e){if(!e)return e===0?e:0;if(e=Jl(e),e===Bs||e===-Bs){var r=e<0?-1:1;return r*rl}return e===e?e:0}function Cl(e){var r=Pl(e),t=r%1;return r===r?t?r-t:r:0}function Jl(e){if(typeof e=="number")return e;if(jl(e))return Ds;if(vt(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=vt(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(al,"");var t=ul.test(e);return t||fl.test(e)?hl(e.slice(2),t?2:8):cl.test(e)?Ds:+e}function kl(e){return It(e)?Il(e):xl(e)}function Bl(e){return e?wl(e,kl(e)):[]}Gs.exports=Tl});var Ks=h((Nd,Vs)=>{var Dl="[object Boolean]",_l=Object.prototype,Fl=_l.toString;function Gl(e){return e===!0||e===!1||Ul(e)&&Fl.call(e)==Dl}function Ul(e){return!!e&&typeof e=="object"}Vs.exports=Gl});var zs=h((Ld,Xs)=>{var Ws=1/0,Vl=17976931348623157e292,Hs=NaN,Kl="[object Symbol]",Wl=/^\s+|\s+$/g,Hl=/^[-+]0x[0-9a-f]+$/i,Ml=/^0b[01]+$/i,Xl=/^0o[0-7]+$/i,zl=parseInt,Yl=Object.prototype,Zl=Yl.toString;function Ql(e){return typeof e=="number"&&e==nh(e)}function Ms(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function eh(e){return!!e&&typeof e=="object"}function rh(e){return typeof e=="symbol"||eh(e)&&Zl.call(e)==Kl}function th(e){if(!e)return e===0?e:0;if(e=ih(e),e===Ws||e===-Ws){var r=e<0?-1:1;return r*Vl}return e===e?e:0}function nh(e){var r=th(e),t=r%1;return r===r?t?r-t:r:0}function ih(e){if(typeof e=="number")return e;if(rh(e))return Hs;if(Ms(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=Ms(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(Wl,"");var t=Ml.test(e);return t||Xl.test(e)?zl(e.slice(2),t?2:8):Hl.test(e)?Hs:+e}Xs.exports=Ql});var Zs=h((qd,Ys)=>{var sh="[object Number]",oh=Object.prototype,ah=oh.toString;function ch(e){return!!e&&typeof e=="object"}function uh(e){return typeof e=="number"||ch(e)&&ah.call(e)==sh}Ys.exports=uh});var to=h((jd,ro)=>{var fh="[object Object]";function lh(e){var r=!1;if(e!=null&&typeof e.toString!="function")try{r=!!(e+"")}catch{}return r}function hh(e,r){return function(t){return e(r(t))}}var ph=Function.prototype,Qs=Object.prototype,eo=ph.toString,dh=Qs.hasOwnProperty,mh=eo.call(Object),yh=Qs.toString,gh=hh(Object.getPrototypeOf,Object);function wh(e){return!!e&&typeof e=="object"}function Eh(e){if(!wh(e)||yh.call(e)!=fh||lh(e))return!1;var r=gh(e);if(r===null)return!0;var t=dh.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t instanceof t&&eo.call(t)==mh}ro.exports=Eh});var io=h((Pd,no)=>{var Sh="[object String]",vh=Object.prototype,bh=vh.toString,Ih=Array.isArray;function xh(e){return!!e&&typeof e=="object"}function Ah(e){return typeof e=="string"||!Ih(e)&&xh(e)&&bh.call(e)==Sh}no.exports=Ah});var uo=h((Cd,co)=>{var Rh="Expected a function",so=1/0,Th=17976931348623157e292,oo=NaN,$h="[object Symbol]",Oh=/^\s+|\s+$/g,Nh=/^[-+]0x[0-9a-f]+$/i,Lh=/^0b[01]+$/i,qh=/^0o[0-7]+$/i,jh=parseInt,Ph=Object.prototype,Ch=Ph.toString;function Jh(e,r){var t;if(typeof r!="function")throw new TypeError(Rh);return e=Fh(e),function(){return--e>0&&(t=r.apply(this,arguments)),e<=1&&(r=void 0),t}}function kh(e){return Jh(2,e)}function ao(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function Bh(e){return!!e&&typeof e=="object"}function Dh(e){return typeof e=="symbol"||Bh(e)&&Ch.call(e)==$h}function _h(e){if(!e)return e===0?e:0;if(e=Gh(e),e===so||e===-so){var r=e<0?-1:1;return r*Th}return e===e?e:0}function Fh(e){var r=_h(e),t=r%1;return r===r?t?r-t:r:0}function Gh(e){if(typeof e=="number")return e;if(Dh(e))return oo;if(ao(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=ao(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(Oh,"");var t=Lh.test(e);return t||qh.test(e)?jh(e.slice(2),t?2:8):Nh.test(e)?oo:+e}co.exports=kh});var Eo=h((Jd,wo)=>{var fo=Xr(),Uh=wt(),Vh=gt(),lo=nr(),Kh=Us(),br=Ks(),ho=zs(),At=Zs(),mo=to(),M=io(),Wh=uo(),{KeyObject:Hh,createSecretKey:Mh,createPrivateKey:Xh}=require("crypto"),yo=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];Uh&&yo.splice(3,0,"PS256","PS384","PS512");var zh={expiresIn:{isValid:function(e){return ho(e)||M(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return ho(e)||M(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return M(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:Kh.bind(null,yo),message:'"algorithm" must be a valid string enum value'},header:{isValid:mo,message:'"header" must be an object'},encoding:{isValid:M,message:'"encoding" must be a string'},issuer:{isValid:M,message:'"issuer" must be a string'},subject:{isValid:M,message:'"subject" must be a string'},jwtid:{isValid:M,message:'"jwtid" must be a string'},noTimestamp:{isValid:br,message:'"noTimestamp" must be a boolean'},keyid:{isValid:M,message:'"keyid" must be a string'},mutatePayload:{isValid:br,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:br,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:br,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},Yh={iat:{isValid:At,message:'"iat" should be a number of seconds'},exp:{isValid:At,message:'"exp" should be a number of seconds'},nbf:{isValid:At,message:'"nbf" should be a number of seconds'}};function go(e,r,t,n){if(!mo(t))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(i){let s=e[i];if(!s){if(!r)throw new Error('"'+i+'" is not allowed in "'+n+'"');return}if(!s.isValid(t[i]))throw new Error(s.message)})}function Zh(e){return go(zh,!1,e,"options")}function Qh(e){return go(Yh,!0,e,"payload")}var po={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},ep=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];wo.exports=function(e,r,t,n){typeof t=="function"?(n=t,t={}):t=t||{};let i=typeof e=="object"&&!Buffer.isBuffer(e),s=Object.assign({alg:t.algorithm||"HS256",typ:i?"JWT":void 0,kid:t.keyid},t.header);function o(c){if(n)return n(c);throw c}if(!r&&t.algorithm!=="none")return o(new Error("secretOrPrivateKey must have a value"));if(r!=null&&!(r instanceof Hh))try{r=Xh(r)}catch{try{r=Mh(typeof r=="string"?Buffer.from(r):r)}catch{return o(new Error("secretOrPrivateKey is not valid key material"))}}if(s.alg.startsWith("HS")&&r.type!=="secret")return o(new Error(`secretOrPrivateKey must be a symmetric key when using ${s.alg}`));if(/^(?:RS|PS|ES)/.test(s.alg)){if(r.type!=="private")return o(new Error(`secretOrPrivateKey must be an asymmetric key when using ${s.alg}`));if(!t.allowInsecureKeySizes&&!s.alg.startsWith("ES")&&r.asymmetricKeyDetails!==void 0&&r.asymmetricKeyDetails.modulusLength<2048)return o(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${s.alg}`))}if(typeof e>"u")return o(new Error("payload is required"));if(i){try{Qh(e)}catch(c){return o(c)}t.mutatePayload||(e=Object.assign({},e))}else{let c=ep.filter(function(l){return typeof t[l]<"u"});if(c.length>0)return o(new Error("invalid "+c.join(",")+" option for "+typeof e+" payload"))}if(typeof e.exp<"u"&&typeof t.expiresIn<"u")return o(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof e.nbf<"u"&&typeof t.notBefore<"u")return o(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{Zh(t)}catch(c){return o(c)}if(!t.allowInvalidAsymmetricKeyTypes)try{Vh(s.alg,r)}catch(c){return o(c)}let a=e.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete e.iat:i&&(e.iat=a),typeof t.notBefore<"u"){try{e.nbf=fo(t.notBefore,a)}catch(c){return o(c)}if(typeof e.nbf>"u")return o(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof t.expiresIn<"u"&&typeof e=="object"){try{e.exp=fo(t.expiresIn,a)}catch(c){return o(c)}if(typeof e.exp>"u")return o(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(po).forEach(function(c){let l=po[c];if(typeof t[c]<"u"){if(typeof e[l]<"u")return o(new Error('Bad "options.'+c+'" option. The payload already has an "'+l+'" property.'));e[l]=t[c]}});let u=t.encoding||"utf8";if(typeof n=="function")n=n&&Wh(n),lo.createSign({header:s,privateKey:r,payload:e,encoding:u}).once("error",n).once("done",function(c){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(s.alg)&&c.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${s.alg}`));n(null,c)});else{let c=lo.sign({header:s,payload:e,secret:r,encoding:u});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(s.alg)&&c.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${s.alg}`);return c}}});var vo=h((kd,So)=>{So.exports={decode:Wr(),verify:ks(),sign:Eo(),JsonWebTokenError:Te(),NotBeforeError:Hr(),TokenExpiredError:Mr()}});var dp={};Ko(dp,{authorizerHandler:()=>pp});module.exports=Ho(dp);var Bo=Wo(vo());var q=class extends Error{},D=class extends q{constructor(r,t,n){super(r),this.failedAssertion={actual:t,expected:n}}},b=class extends q{constructor(r,t){let n=t!=null?`${r}: ${t}`:r;super(n)}},x=class extends q{},ke=class extends q{},Be=class extends D{},R=class extends D{withRawJwt({header:r,payload:t}){return this.rawJwt={header:r,payload:t},this}},we=class extends R{},Ir=class extends R{},xr=class extends R{},Ar=class extends R{},Rr=class extends R{},Tr=class extends R{},De=class extends R{},_e=class extends R{};var te=class extends q{},U=class extends q{},Ee=class extends q{},X=class extends q{},$r=class extends q{},Or=class extends q{},Nr=class extends D{},Lr=class extends D{},V=class extends q{constructor(r,t){super(`Failed to fetch ${r}: ${t}`)}},K=class extends V{};var ve=require("crypto");var ne;(function(e){e[e.Universal=0]="Universal"})(ne||(ne={}));var ie;(function(e){e[e.Primitive=0]="Primitive",e[e.Constructed=1]="Constructed"})(ie||(ie={}));var se;(function(e){e[e.BitString=3]="BitString",e[e.ObjectIdentifier=6]="ObjectIdentifier",e[e.Sequence=16]="Sequence",e[e.Null=5]="Null",e[e.Integer=2]="Integer"})(se||(se={}));function Fe(e){let r=e.class<<7|e.primitiveOrConstructed<<5|e.tag;return Buffer.from([r])}function Ge(e){if(e<128)return Buffer.from([e]);let r=[];for(;e>0;)r.push(e%256),e=e>>8;return r.reverse(),Buffer.from([128|r.length,...r])}function bo(e){return e[0]>>7&&(e=Buffer.concat([Buffer.from([0]),e])),Buffer.concat([Fe({class:ne.Universal,primitiveOrConstructed:ie.Primitive,tag:se.Integer}),Ge(e.length),e])}function rp(e){let r=e.split(".").map(s=>parseInt(s)),t=r[0]*40+r[1],n=r.slice(2).reduce((s,o)=>{let a=[];do a.push(o%128),o=o>>7;while(o);return s.concat(a.map((u,c)=>c?u+128:u).reverse())},[]),i=Buffer.from([t,...n]);return Buffer.concat([Fe({class:ne.Universal,primitiveOrConstructed:ie.Primitive,tag:se.ObjectIdentifier}),Ge(i.length),i])}function tp(e){let r=Buffer.concat([Buffer.from([0]),e]);return Buffer.concat([Fe({class:ne.Universal,primitiveOrConstructed:ie.Primitive,tag:se.BitString}),Ge(r.length),r])}function Rt(e){let r=Buffer.concat(e);return Buffer.concat([Fe({class:ne.Universal,primitiveOrConstructed:ie.Constructed,tag:se.Sequence}),Ge(r.length),r])}function np(){return Buffer.concat([Fe({class:ne.Universal,primitiveOrConstructed:ie.Primitive,tag:se.Null}),Ge(0)])}var ip=Rt([rp("1.2.840.113549.1.1.1"),np()]);function Tt(e,r){return Rt([ip,tp(Rt([bo(e),bo(r)]))])}var xo=require("https");function Io(e,r,t){if(r===429)throw new V(e,"Too many requests");if(r!==200)throw new K(e,`Status code is ${r}, expected 200`);if(!t||!t.toLowerCase().startsWith("application/json"))throw new K(e,`Content-type is "${t}", expected "application/json"`)}var Ao=require("stream"),Ro=require("util");function Se(e){return typeof e=="object"&&!Array.isArray(e)&&e!==null}function Ue(e){return JSON.parse(e,(r,t)=>(typeof t=="object"&&!Array.isArray(t)&&t!==null&&(delete t.__proto__,delete t.constructor),t))}async function To(e,r,t){let n;return new Promise((i,s)=>{let o=(0,xo.request)(e,{method:"GET",...r},u=>{(0,Ao.pipeline)([u,sp(e,u.statusCode,u.headers)],a)});r?.responseTimeout&&(n=setTimeout(()=>a(new V(e,`Response time-out (after ${r.responseTimeout} ms.)`)),r.responseTimeout),n.unref());function a(...u){if(n&&clearTimeout(n),u[0]==null){i(u[1]);return}o.socket?.emit("agentRemove");let c=u[0];c instanceof V||(c=new V(e,c.message)),o.destroy(),s(c)}o.on("error",a),o.end(t)})}function sp(e,r,t){return async n=>{Io(e,r,t["content-type"]);let i=[];for await(let s of n)i.push(s);try{return Ue(new Ro.TextDecoder("utf8",{fatal:!0,ignoreBOM:!0}).decode(Buffer.concat(i)))}catch(s){throw new K(e,s)}}}var qr;(function(e){e.RS256="RSA-SHA256",e.RS384="RSA-SHA384",e.RS512="RSA-SHA512"})(qr||(qr={}));var L={fetchJson:To,transformJwkToKeyObjectSync:e=>(0,ve.createPublicKey)({key:Tt(Buffer.from(e.n,"base64"),Buffer.from(e.e,"base64")),format:"der",type:"spki"}),transformJwkToKeyObjectAsync:async e=>(0,ve.createPublicKey)({key:Tt(Buffer.from(e.n,"base64"),Buffer.from(e.e,"base64")),format:"der",type:"spki"}),parseB64UrlString:e=>Buffer.from(e,"base64").toString("utf8"),verifySignatureSync:({alg:e,keyObject:r,jwsSigningInput:t,signature:n})=>(0,ve.createVerify)(qr[e]).update(t).verify(r,n,"base64"),verifySignatureAsync:async({alg:e,keyObject:r,jwsSigningInput:t,signature:n})=>(0,ve.createVerify)(qr[e]).update(t).verify(r,n,"base64"),defaultFetchTimeouts:{socketIdle:500,response:1500},setTimeoutUnref:(...e)=>setTimeout(...e).unref()};var jr=L.fetchJson,Pr=class{constructor(r){this.defaultRequestOptions={timeout:L.defaultFetchTimeouts.socketIdle,responseTimeout:L.defaultFetchTimeouts.response,...r?.defaultRequestOptions}}async fetch(r,t,n){t={...this.defaultRequestOptions,...t};try{return await jr(r,t,n)}catch(i){if(i instanceof K)throw i;return jr(r,t,n)}}};function oe(e,r,t,n=D){if(!r)throw new n(`Missing ${e}. Expected: ${t}`,r,t);if(typeof r!="string")throw new n(`${e} is not of type string`,r,t);if(t!==r)throw new n(`${e} not allowed: ${r}. Expected: ${t}`,r,t)}function W(e,r,t,n=D){if(!r)throw new n(`Missing ${e}. ${$t(t)}`,r,t);if(typeof r!="string")throw new n(`${e} is not of type string`,r,t);return be(e,r,t,n)}function be(e,r,t,n=D){if(!r)throw new n(`Missing ${e}. ${$t(t)}`,r,t);let i=new Set(Array.isArray(t)?t:[t]);if(typeof r=="string"&&(r=[r]),!Array.isArray(r))throw new n(`${e} is not an array`,r,t);if(!r.some(o=>{if(typeof o!="string")throw new n(`${e} includes elements that are not of type string`,r,t);return i.has(o)}))throw new n(`${e} not allowed: ${r.join(", ")}. ${$t(t)}`,r,t)}function $t(e){return Array.isArray(e)?e.length>1?`Expected one of: ${e.join(", ")}`:`Expected: ${e[0]}`:`Expected: ${e}`}function $o(e,r){if(e&&typeof e.then=="function")throw r()}var op=["use","alg","kid","n","e"],ap=["kty"];function Ie(e,r){return e.keys.find(t=>t.kid!=null&&t.kid===r)}async function cp(e){let r=await jr(e);return Nt(r),r}async function Oo(e,r){if(!r.header.kid)throw new Ee("JWT header does not have valid kid claim");let t=await cp(e),n=Ie(t,r.header.kid);if(!n)throw new X(`JWK for kid "${r.header.kid}" not found in the JWKS`);return n}function Nt(e){if(!e)throw new te("JWKS empty");if(!Se(e))throw new te("JWKS should be an object");if(!Object.keys(e).includes("keys"))throw new te("JWKS does not include keys");if(!Array.isArray(e.keys))throw new te("JWKS keys should be an array");for(let r of e.keys)Lo(r)}function No(e){if(oe("JWK use",e.use,"sig",Nr),oe("JWK kty",e.kty,"RSA",Lr),!e.n)throw new U("Missing modulus (n)");if(!e.e)throw new U("Missing exponent (e)")}function Lo(e){if(!e)throw new U("JWK empty");if(!Se(e))throw new U("JWK should be an object");for(let r of ap)if(typeof e[r]!="string")throw new U(`JWK ${r} should be a string`);for(let r of op)if(r in e&&typeof e[r]!="string")throw new U(`JWK ${r} should be a string`)}function qo(e){try{return Nt(e),!0}catch{return!1}}function jo(e){try{return Lo(e),!0}catch{return!1}}var Ot=class{constructor(r){this.waitingUris=new Map,this.waitSeconds=r?.waitSeconds??10}async wait(r){if(this.waitingUris.has(r))throw new $r("Not allowed to fetch JWKS yet, still waiting for back off period to end")}release(r){let t=this.waitingUris.get(r);t&&(clearTimeout(t),this.waitingUris.delete(r))}registerFailedAttempt(r){let t=L.setTimeoutUnref(()=>{this.waitingUris.delete(r)},this.waitSeconds*1e3);this.waitingUris.set(r,t)}registerSuccessfulAttempt(r){this.release(r)}},Cr=class{constructor(r){this.jwksCache=new Map,this.fetchingJwks=new Map,this.penaltyBox=r?.penaltyBox??new Ot,this.fetcher=r?.fetcher??new Pr}addJwks(r,t){this.jwksCache.set(r,t)}async getJwks(r){let t=this.fetchingJwks.get(r);if(t)return t;let n=this.fetcher.fetch(r).then(s=>(Nt(s),s));this.fetchingJwks.set(r,n);let i;try{i=await n}finally{this.fetchingJwks.delete(r)}return this.jwksCache.set(r,i),i}getCachedJwk(r,t){if(typeof t.header.kid!="string")throw new Ee("JWT header does not have valid kid claim");if(!this.jwksCache.has(r))throw new Or(`JWKS for uri ${r} not yet available in cache`);let n=Ie(this.jwksCache.get(r),t.header.kid);if(!n)throw new X(`JWK for kid ${t.header.kid} not found in the JWKS`);return n}async getJwk(r,t){if(typeof t.header.kid!="string")throw new Ee("JWT header does not have valid kid claim");let n=this.jwksCache.get(r);if(n){let o=Ie(n,t.header.kid);if(o)return o}await this.penaltyBox.wait(r,t.header.kid);let i=await this.getJwks(r),s=Ie(i,t.header.kid);if(s)this.penaltyBox.registerSuccessfulAttempt(r,t.header.kid);else throw this.penaltyBox.registerFailedAttempt(r,t.header.kid),new X(`JWK for kid "${t.header.kid}" not found in the JWKS`);return s}};var Po=["RS256","RS384","RS512"];function up(e){if(!Se(e))throw new b("JWT header is not an object");if(e.alg!==void 0&&typeof e.alg!="string")throw new b("JWT header alg claim is not a string");if(e.kid!==void 0&&typeof e.kid!="string")throw new b("JWT header kid claim is not a string")}function fp(e){if(!Se(e))throw new b("JWT payload is not an object");if(e.exp!==void 0&&!Number.isFinite(e.exp))throw new b("JWT payload exp claim is not a number");if(e.iss!==void 0&&typeof e.iss!="string")throw new b("JWT payload iss claim is not a string");if(e.sub!==void 0&&typeof e.sub!="string")throw new b("JWT payload sub claim is not a string");if(e.aud!==void 0&&typeof e.aud!="string"&&(!Array.isArray(e.aud)||e.aud.some(r=>typeof r!="string")))throw new b("JWT payload aud claim is not a string or array of strings");if(e.nbf!==void 0&&!Number.isFinite(e.nbf))throw new b("JWT payload nbf claim is not a number");if(e.iat!==void 0&&!Number.isFinite(e.iat))throw new b("JWT payload iat claim is not a number");if(e.scope!==void 0&&typeof e.scope!="string")throw new b("JWT payload scope claim is not a string");if(e.jti!==void 0&&typeof e.jti!="string")throw new b("JWT payload jti claim is not a string")}function Co(e){if(!e)throw new b("Empty JWT");if(typeof e!="string")throw new b("JWT is not a string");if(!e.match(/^[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+$/))throw new b("JWT string does not consist of exactly 3 parts (header, payload, signature)");let[r,t,n]=e.split("."),[i,s]=[r,t].map(L.parseB64UrlString),o;try{o=Ue(i)}catch(u){throw new b("Invalid JWT. Header is not a valid JSON object",u)}up(o);let a;try{a=Ue(s)}catch(u){throw new b("Invalid JWT. Payload is not a valid JSON object",u)}return fp(a),{header:o,headerB64:r,payload:a,payloadB64:t,signatureB64:n}}function Lt(e,r){if(e.exp!==void 0&&e.exp+(r.graceSeconds??0)<Date.now()/1e3)throw new Ar(`Token expired at ${new Date(e.exp*1e3).toISOString()}`,e.exp);if(e.nbf!==void 0&&e.nbf-(r.graceSeconds??0)>Date.now()/1e3)throw new Rr(`Token can't be used before ${new Date(e.nbf*1e3).toISOString()}`,e.nbf);if(r.issuer!==null){if(r.issuer===void 0)throw new x("issuer must be provided or set to null explicitly");W("Issuer",e.iss,r.issuer,we)}if(r.audience!==null){if(r.audience===void 0)throw new x("audience must be provided or set to null explicitly");be("Audience",e.aud,r.audience,Ir)}r.scope!=null&&be("Scope",e.scope?.split(" "),r.scope,xr)}function Jo(e,r){No(r),r.alg&&oe("JWT signature algorithm",e.alg,r.alg,Be),W("JWT signature algorithm",e.alg,Po,Be)}async function lp(e,r,t,n=Oo,i=L.transformJwkToKeyObjectAsync){let{header:s,headerB64:o,payload:a,payloadB64:u,signatureB64:c}=e,l=await n(r,e);Jo(e.header,l);let f=await i(l,s.alg,a.iss);if(!await L.verifySignatureAsync({jwsSigningInput:`${o}.${u}`,signature:c,alg:s.alg,keyObject:f}))throw new ke("Invalid signature");try{Lt(a,t),t.customJwtCheck&&await t.customJwtCheck({header:s,payload:a,jwk:l})}catch(m){throw t.includeRawJwtInErrors&&m instanceof R?m.withRawJwt(e):m}return a}function hp(e,r,t,n){let{header:i,headerB64:s,payload:o,payloadB64:a,signatureB64:u}=e,c;if(jo(r))c=r;else if(qo(r)){let g=i.kid?Ie(r,i.kid):void 0;if(!g)throw new X(`JWK for kid ${i.kid} not found in the JWKS`);c=g}else throw new x([`Expected a valid JWK or JWKS (parsed as JavaScript object), but received: ${r}.`,"If you're passing a JWKS URI, use the async verify() method instead, it will download and parse the JWKS for you"].join());Jo(e.header,c);let l=n(c,i.alg,o.iss);if(!L.verifySignatureSync({jwsSigningInput:`${s}.${a}`,signature:u,alg:i.alg,keyObject:l}))throw new ke("Invalid signature");try{if(Lt(o,t),t.customJwtCheck){let g=t.customJwtCheck({header:i,payload:o,jwk:c});$o(g,()=>new x("Custom JWT checks must be synchronous but a promise was returned"))}}catch(g){throw t.includeRawJwtInErrors&&g instanceof R?g.withRawJwt(e):g}return o}var Ve=class{constructor(r,t=new Cr){if(this.jwksCache=t,this.issuersConfig=new Map,this.publicKeyCache=new qt,Array.isArray(r)){if(!r.length)throw new x("Provide at least one issuer configuration");for(let n of r){if(this.issuersConfig.has(n.issuer))throw new x(`issuer ${n.issuer} supplied multiple times`);this.issuersConfig.set(n.issuer,this.withJwksUri(n))}}else this.issuersConfig.set(r.issuer,this.withJwksUri(r))}get expectedIssuers(){return Array.from(this.issuersConfig.keys())}getIssuerConfig(r){if(!r){if(this.issuersConfig.size!==1)throw new x("issuer must be provided");r=this.issuersConfig.keys().next().value}let t=this.issuersConfig.get(r);if(!t)throw new x(`issuer not configured: ${r}`);return t}cacheJwks(...[r,t]){let n=this.getIssuerConfig(t);this.jwksCache.addJwks(n.jwksUri,r),this.publicKeyCache.clearCache(n.issuer)}async hydrate(){let r=this.expectedIssuers.map(t=>this.getIssuerConfig(t).jwksUri).map(t=>this.jwksCache.getJwks(t));await Promise.all(r)}verifySync(...[r,t]){let{decomposedJwt:n,jwksUri:i,verifyProperties:s}=this.getVerifyParameters(r,t);return this.verifyDecomposedJwtSync(n,i,s)}verifyDecomposedJwtSync(r,t,n){let i=this.jwksCache.getCachedJwk(t,r);return hp(r,i,n,this.publicKeyCache.transformJwkToKeyObjectSync.bind(this.publicKeyCache))}async verify(...[r,t]){let{decomposedJwt:n,jwksUri:i,verifyProperties:s}=this.getVerifyParameters(r,t);return this.verifyDecomposedJwt(n,i,s)}verifyDecomposedJwt(r,t,n){return lp(r,t,n,this.jwksCache.getJwk.bind(this.jwksCache),this.publicKeyCache.transformJwkToKeyObjectAsync.bind(this.publicKeyCache))}getVerifyParameters(r,t){let n=Co(r);W("Issuer",n.payload.iss,this.expectedIssuers,we);let i=this.getIssuerConfig(n.payload.iss);return{decomposedJwt:n,jwksUri:i.jwksUri,verifyProperties:{...i,...t}}}withJwksUri(r){if(r.jwksUri)return r;let t=new URL(r.issuer).pathname.replace(/\/$/,"");return{jwksUri:new URL(`${t}/.well-known/jwks.json`,r.issuer).href,...r}}},Ke=class extends Ve{static create(r,t){return new this(r,t?.jwksCache)}},qt=class{constructor(r=L.transformJwkToKeyObjectSync,t=L.transformJwkToKeyObjectAsync){this.transformJwkToKeyObjectSyncFn=r,this.transformJwkToKeyObjectAsyncFn=t,this.publicKeys=new Map}transformJwkToKeyObjectSync(r,t,n){let i=r.alg??t;if(!n||!r.kid||!i)return this.transformJwkToKeyObjectSyncFn(r,i,n);let s=this.publicKeys.get(n)?.get(r.kid)?.get(i);if(s)return s;let o=this.transformJwkToKeyObjectSyncFn(r,i,n);return this.putKeyObjectInCache(n,r.kid,i,o),o}async transformJwkToKeyObjectAsync(r,t,n){let i=r.alg??t;if(!n||!r.kid||!i)return this.transformJwkToKeyObjectAsyncFn(r,i,n);let s=this.publicKeys.get(n)?.get(r.kid)?.get(i);if(s)return s;let o=await this.transformJwkToKeyObjectAsyncFn(r,i,n);return this.putKeyObjectInCache(n,r.kid,i,o),o}putKeyObjectInCache(r,t,n,i){let s=this.publicKeys.get(r),o=s?.get(t);o?o.set(n,i):s?s.set(t,new Map([[n,i]])):this.publicKeys.set(r,new Map([[t,new Map([[n,i]])]]))}clearCache(r){this.publicKeys.delete(r)}};function ko(e,r){if(r.groups!=null&&be("Cognito group",e["cognito:groups"],r.groups,Tr),W("Token use",e.token_use,["id","access"],De),r.tokenUse!==null){if(r.tokenUse===void 0)throw new x("tokenUse must be provided or set to null explicitly");oe("Token use",e.token_use,r.tokenUse,De)}if(r.clientId!==null){if(r.clientId===void 0)throw new x("clientId must be provided or set to null explicitly");e.token_use==="id"?W('Client ID ("audience")',e.aud,r.clientId,_e):W("Client ID",e.client_id,r.clientId,_e)}}var We=class e extends Ve{constructor(r,t){let n=Array.isArray(r)?r.map(i=>({...i,...e.parseUserPoolId(i.userPoolId),audience:null})):{...r,...e.parseUserPoolId(r.userPoolId),audience:null};super(n,t)}static parseUserPoolId(r){let t=r.match(/^(?<region>(\w+-)?\w+-\w+-\d)+_\w+$/);if(!t)throw new x(`Invalid Cognito User Pool ID: ${r}`);let i=`https://cognito-idp.${t.groups.region}.amazonaws.com/${r}`;return{issuer:i,jwksUri:`${i}/.well-known/jwks.json`}}static create(r,t){return new this(r,t?.jwksCache)}verifySync(...[r,t]){let{decomposedJwt:n,jwksUri:i,verifyProperties:s}=this.getVerifyParameters(r,t);this.verifyDecomposedJwtSync(n,i,s);try{ko(n.payload,s)}catch(o){throw s.includeRawJwtInErrors&&o instanceof R?o.withRawJwt(n):o}return n.payload}async verify(...[r,t]){let{decomposedJwt:n,jwksUri:i,verifyProperties:s}=this.getVerifyParameters(r,t);await this.verifyDecomposedJwt(n,i,s);try{ko(n.payload,s)}catch(o){throw s.includeRawJwtInErrors&&o instanceof R?o.withRawJwt(n):o}return n.payload}cacheJwks(...[r,t]){let n;if(t!==void 0)n=e.parseUserPoolId(t).issuer;else if(this.expectedIssuers.length>1)throw new x("userPoolId must be provided");let i=this.getIssuerConfig(n);super.cacheJwks(r,i.issuer)}};var pp=e=>async r=>{try{let t=r.headers,n=process.env.ISSUERS?.split(",")||[],i=t.authorization||t.Authorization;if(!i)throw new Error("No authorization header provided");let s=i.replace("Bearer ","");if(!s)throw new Error("Token is not a bearer token");let o=Bo.decode(s,{complete:!0});if(!o)throw new Error("Token failed to decode");if(typeof o.payload=="string")throw new Error("Decoded token payload is a string");if(!o.payload.sub)throw new Error("Token does not contain a sub");let a=o.payload.iss;if(a?.includes("cognito")&&n.includes(a)){if(!await We.create({userPoolId:process.env.CONNECT_USER_POOL??"",tokenUse:"access",clientId:process.env.CLIENT_ID??""}).verify(s))throw new Error("Token failed to verify")}else if(a&&n.includes(a)){if(!o.payload.aud)throw new Error("Token does not contain an aud");if(!await Ke.create([{issuer:a,audience:o?.payload.aud,jwksUri:`${a.replace(/\/$/,"")}/.well-known/jwks.json`}]).verify(s))throw new Error("Token failed to verify")}else throw new Error(`Invalid issuer [${a}]`);return e&&await e(r,o),{principalId:o.payload.sub,policyDocument:{Version:"2012-10-17",Statement:[{Action:"execute-api:Invoke",Effect:"Allow",Resource:r.methodArn}]}}}catch(t){return console.error("Error:",t),{principalId:"user",policyDocument:{Version:"2012-10-17",Statement:[{Action:"execute-api:Invoke",Effect:"Deny",Resource:r.methodArn}]}}}};0&&(module.exports={authorizerHandler});
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
