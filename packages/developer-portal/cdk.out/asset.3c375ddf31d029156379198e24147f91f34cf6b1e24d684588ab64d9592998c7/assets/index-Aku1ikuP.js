import{X as k,y as M,u as J,r as P,j as e,bw as G,p as o,ak as O,aL as f,E as x,k as S,c as d}from"./vendor-XRUYIZQG.js";import{n as q,R as H}from"./index-tQL3kVgr.js";import{c as X,a as E,p as Y,ad as B,u as W,e as Q,o as V}from"./error-messages-0Wz0vNVZ.js";import{a as z,r as K}from"./developer-UlMUTi6M.js";import{s as b}from"./yup-QHb_2Eg3.js";import"./index-25wDhYT-.js";const Z=s=>{const a={};return new URLSearchParams(s).forEach((i,n)=>{if(n==="page"){const t=Number(i);return a.page=!isNaN(t)&&t>0?t:1}a[n]=i||""}),a},{FIELD_REQUIRED:y,MAXIMUM_CHARACTER_LENGTH:v}=Q,T=X().shape({name:E().trim().required(y).matches(Y,"Full name is not valid").max(256,v(256)).test(b),jobTitle:E().trim().required(y).matches(B,"Job title is not valid").max(256,v(256)).test(b)}),I=(s,a,i,n)=>async t=>{if(!i||!n)return;a("LOADING");const r=await z(t,i,n);typeof r=="string"?(s(r),a("DEFAULT")):a("ACCEPT_SUCCESS")},R=(s,a,i,n)=>async t=>{if(t.preventDefault(),t.stopPropagation(),!i||!n)return;a("LOADING");const r=await K(i,n);typeof r=="string"?(s(r),a("DEFAULT")):a("REJECT_SUCCESS")},A=()=>{var g,p,j,C;const s=k(),a=M(),{error:i}=J(),[n,t]=P.useState("DEFAULT"),r=Z(s.search),{developerId:m,memberId:u,memberName:U,memberJobTitle:D,organisationName:L}=r,{register:h,handleSubmit:F,formState:{errors:l}}=W({resolver:V(T),defaultValues:{name:U,jobTitle:D}}),N=F(I(i,t,m,u)),_=R(i,t,m,u),c=n==="LOADING",w=n==="ACCEPT_SUCCESS"?"Invite Accepted":n==="REJECT_SUCCESS"?"Invite Rejected":"Reapit Foundations Invitation";return e.jsxs(G,{title:w,isOpen:!0,onModalClose:console.log,children:[!n.includes("SUCCESS")&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{children:["You have been invited to join the '",L,"' organisation on Reapit Foundations."]}),e.jsx(o,{children:"Before confirming your account, please ensure your details are correct below."}),e.jsxs(o,{children:[e.jsx("strong",{children:"Important: "}),"If you already have an account and confirm this invitation, any data on your existing account will no longer be available."]}),e.jsxs("form",{onSubmit:N,children:[e.jsxs(O,{hasMargin:!0,children:[e.jsx(f,{children:e.jsx(x,{...h("name"),label:"Name",errorMessage:(g=l.name)==null?void 0:g.message,icon:(p=l.name)!=null&&p.message?"asterisk":null,intent:"danger"})}),e.jsx(f,{children:e.jsx(x,{...h("jobTitle"),label:"Job Title",errorMessage:(j=l.jobTitle)==null?void 0:j.message,icon:(C=l.jobTitle)!=null&&C.message?"asterisk":null,intent:"danger"})})]}),e.jsxs(S,{alignment:"right",children:[e.jsx(d,{fixedWidth:!0,intent:"danger",loading:c,disabled:c,type:"button",onClick:_,children:"Decline"}),e.jsx(d,{intent:"primary",loading:c,disabled:c,type:"submit",children:"Confirm"})]})]})]}),n==="ACCEPT_SUCCESS"&&e.jsxs(e.Fragment,{children:[e.jsx(o,{children:"Thank you for confirming your invite to Reapit Foundations."}),e.jsx(o,{children:"If you already had a Developer account, you can use your existing credentials to login to the Developers Portal. If not, you will shortly receive an email with instructions on setting up your login credentials."}),e.jsx(S,{alignment:"right",children:e.jsx(d,{intent:"primary",onClick:q(a,H.LOGIN),children:"Login"})})]}),n==="REJECT_SUCCESS"&&e.jsx(o,{children:"You have successfully declined the invitation to Reapit Foundations."})]})};export{A as Invite,A as default,I as handleAccept,R as handleReject,T as validationSchema};
