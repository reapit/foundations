import{bn as re,bo as ie,bp as se,by as m}from"./vendor-D_Z2viGi.js";import{l as J}from"./index-Cf3uwZ1G.js";/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var Le=function(){function i(e){var r=e||{},n=r.ValidationData,s=r.Username,o=r.Password,a=r.AuthParameters,u=r.ClientMetadata;this.validationData=n||{},this.authParameters=a||{},this.clientMetadata=u||{},this.username=s,this.password=o}var t=i.prototype;return t.getUsername=function(){return this.username},t.getPassword=function(){return this.password},t.getValidationData=function(){return this.validationData},t.getAuthParameters=function(){return this.authParameters},t.getClientMetadata=function(){return this.clientMetadata},i}(),w;if(typeof window<"u"&&window.crypto&&(w=window.crypto),!w&&typeof window<"u"&&window.msCrypto&&(w=window.msCrypto),!w&&typeof re<"u"&&re.crypto&&(w=re.crypto),!w&&typeof require=="function")try{w=require("crypto")}catch{}function je(){if(w){if(typeof w.getRandomValues=="function")try{return w.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof w.randomBytes=="function")try{return w.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")}function He(i){for(var t=i.words,e=i.sigBytes,r=[],n=0;n<e;n++){var s=t[n>>>2]>>>24-n%4*8&255;r.push((s>>>4).toString(16)),r.push((s&15).toString(16))}return r.join("")}var Je=function(){function i(e,r){e=this.words=e||[],r!=null?this.sigBytes=r:this.sigBytes=e.length*4}var t=i.prototype;return t.random=function(e){for(var r=[],n=0;n<e;n+=4)r.push(je());return new i(r,e)},t.toString=function(){return He(this)},i}(),P={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var oe=function(i,t){return oe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])},oe(i,t)};function Ge(i,t){oe(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var ae=function(){return ae=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},ae.apply(this,arguments)};function We(i,t){var e={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(e[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(e[r[n]]=i[r[n]]);return e}function Ze(i,t,e,r){var n=arguments.length,s=n<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,e):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,r);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(s=(n<3?o(s):n>3?o(t,e,s):o(t,e))||s);return n>3&&s&&Object.defineProperty(t,e,s),s}function ze(i,t){return function(e,r){t(e,r,i)}}function Ye(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)}function Xe(i,t,e,r){function n(s){return s instanceof e?s:new e(function(o){o(s)})}return new(e||(e=Promise))(function(s,o){function a(h){try{c(r.next(h))}catch(l){o(l)}}function u(h){try{c(r.throw(h))}catch(l){o(l)}}function c(h){h.done?s(h.value):n(h.value).then(a,u)}c((r=r.apply(i,t||[])).next())})}function Qe(i,t){var e={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(h){return u([c,h])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,n&&(s=c[0]&2?n.return:c[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,c[1])).done)return s;switch(n=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++,n=c[1],c=[0];continue;case 7:c=e.ops.pop(),e.trys.pop();continue;default:if(s=e.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){e=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){e.label=c[1];break}if(c[0]===6&&e.label<s[1]){e.label=s[1],s=c;break}if(s&&e.label<s[2]){e.label=s[2],e.ops.push(c);break}s[2]&&e.ops.pop(),e.trys.pop();continue}c=t.call(i,e)}catch(h){c=[6,h],n=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function $e(i,t,e,r){r===void 0&&(r=e),i[r]=t[e]}function et(i,t){for(var e in i)e!=="default"&&!t.hasOwnProperty(e)&&(t[e]=i[e])}function ue(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ue(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r=e.call(i),n,s=[],o;try{for(;(t===void 0||t-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(a){o={error:a}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(o)throw o.error}}return s}function tt(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(Ue(arguments[t]));return i}function nt(){for(var i=0,t=0,e=arguments.length;t<e;t++)i+=arguments[t].length;for(var r=Array(i),n=0,t=0;t<e;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,n++)r[n]=s[o];return r}function M(i){return this instanceof M?(this.v=i,this):new M(i)}function rt(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e.apply(i,t||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(f){r[f]&&(n[f]=function(g){return new Promise(function(v,p){s.push([f,g,v,p])>1||a(f,g)})})}function a(f,g){try{u(r[f](g))}catch(v){l(s[0][3],v)}}function u(f){f.value instanceof M?Promise.resolve(f.value.v).then(c,h):l(s[0][2],f)}function c(f){a("next",f)}function h(f){a("throw",f)}function l(f,g){f(g),s.shift(),s.length&&a(s[0][0],s[0][1])}}function it(i){var t,e;return t={},r("next"),r("throw",function(n){throw n}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(n,s){t[n]=i[n]?function(o){return(e=!e)?{value:M(i[n](o)),done:n==="return"}:s?s(o):o}:s}}function st(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof ue=="function"?ue(i):i[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(s){e[s]=i[s]&&function(o){return new Promise(function(a,u){o=i[s](o),n(a,u,o.done,o.value)})}}function n(s,o,a,u){Promise.resolve(u).then(function(c){s({value:c,done:a})},o)}}function ot(i,t){return Object.defineProperty?Object.defineProperty(i,"raw",{value:t}):i.raw=t,i}function at(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var e in i)Object.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t.default=i,t}function ut(i){return i&&i.__esModule?i:{default:i}}function ct(i,t){if(!t.has(i))throw new TypeError("attempted to get private field on non-instance");return t.get(i)}function ht(i,t,e){if(!t.has(i))throw new TypeError("attempted to set private field on non-instance");return t.set(i,e),e}const lt=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ae},__asyncDelegator:it,__asyncGenerator:rt,__asyncValues:st,__await:M,__awaiter:Xe,__classPrivateFieldGet:ct,__classPrivateFieldSet:ht,__createBinding:$e,__decorate:Ze,__exportStar:et,__extends:Ge,__generator:Qe,__importDefault:ut,__importStar:at,__makeTemplateObject:ot,__metadata:Ye,__param:ze,__read:Ue,__rest:We,__spread:tt,__spreadArrays:nt,__values:ue},Symbol.toStringTag,{value:"Module"})),we=ie(lt);var G={},U={};Object.defineProperty(U,"__esModule",{value:!0}),U.MAX_HASHABLE_LENGTH=U.INIT=U.KEY=U.DIGEST_LENGTH=U.BLOCK_SIZE=void 0,U.BLOCK_SIZE=64,U.DIGEST_LENGTH=32,U.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),U.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],U.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1;var W={};Object.defineProperty(W,"__esModule",{value:!0}),W.RawSha256=void 0;var A=U,ft=function(){function i(){this.state=Int32Array.from(A.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return i.prototype.update=function(t){if(this.finished)throw new Error("Attempted to update an already finished hash.");var e=0,r=t.byteLength;if(this.bytesHashed+=r,this.bytesHashed*8>A.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=t[e++],r--,this.bufferLength===A.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},i.prototype.digest=function(){if(!this.finished){var t=this.bytesHashed*8,e=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(e.setUint8(this.bufferLength++,128),r%A.BLOCK_SIZE>=A.BLOCK_SIZE-8){for(var n=this.bufferLength;n<A.BLOCK_SIZE;n++)e.setUint8(n,0);this.hashBuffer(),this.bufferLength=0}for(var n=this.bufferLength;n<A.BLOCK_SIZE-8;n++)e.setUint8(n,0);e.setUint32(A.BLOCK_SIZE-8,Math.floor(t/4294967296),!0),e.setUint32(A.BLOCK_SIZE-4,t),this.hashBuffer(),this.finished=!0}for(var s=new Uint8Array(A.DIGEST_LENGTH),n=0;n<8;n++)s[n*4]=this.state[n]>>>24&255,s[n*4+1]=this.state[n]>>>16&255,s[n*4+2]=this.state[n]>>>8&255,s[n*4+3]=this.state[n]>>>0&255;return s},i.prototype.hashBuffer=function(){for(var t=this,e=t.buffer,r=t.state,n=r[0],s=r[1],o=r[2],a=r[3],u=r[4],c=r[5],h=r[6],l=r[7],f=0;f<A.BLOCK_SIZE;f++){if(f<16)this.temp[f]=(e[f*4]&255)<<24|(e[f*4+1]&255)<<16|(e[f*4+2]&255)<<8|e[f*4+3]&255;else{var g=this.temp[f-2],v=(g>>>17|g<<15)^(g>>>19|g<<13)^g>>>10;g=this.temp[f-15];var p=(g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3;this.temp[f]=(v+this.temp[f-7]|0)+(p+this.temp[f-16]|0)}var S=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&c^~u&h)|0)+(l+(A.KEY[f]+this.temp[f]|0)|0)|0,y=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&s^n&o^s&o)|0;l=h,h=c,c=u,u=a+S|0,a=o,o=s,s=n,n=S+y|0}r[0]+=n,r[1]+=s,r[2]+=o,r[3]+=a,r[4]+=u,r[5]+=c,r[6]+=h,r[7]+=l},i}();W.RawSha256=ft;var Ae={},Z={};const dt=i=>{const t=[];for(let e=0,r=i.length;e<r;e++){const n=i.charCodeAt(e);if(n<128)t.push(n);else if(n<2048)t.push(n>>6|192,n&63|128);else if(e+1<i.length&&(n&64512)===55296&&(i.charCodeAt(e+1)&64512)===56320){const s=65536+((n&1023)<<10)+(i.charCodeAt(++e)&1023);t.push(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}else t.push(n>>12|224,n>>6&63|128,n&63|128)}return Uint8Array.from(t)},gt=i=>{let t="";for(let e=0,r=i.length;e<r;e++){const n=i[e];if(n<128)t+=String.fromCharCode(n);else if(192<=n&&n<224){const s=i[++e];t+=String.fromCharCode((n&31)<<6|s&63)}else if(240<=n&&n<365){const s="%"+[n,i[++e],i[++e],i[++e]].map(o=>o.toString(16)).join("%");t+=decodeURIComponent(s)}else t+=String.fromCharCode((n&15)<<12|(i[++e]&63)<<6|i[++e]&63)}return t};function pt(i){return new TextEncoder().encode(i)}function vt(i){return new TextDecoder("utf-8").decode(i)}const St=i=>typeof TextEncoder=="function"?pt(i):dt(i),mt=i=>typeof TextDecoder=="function"?vt(i):gt(i),yt=Object.freeze(Object.defineProperty({__proto__:null,fromUtf8:St,toUtf8:mt},Symbol.toStringTag,{value:"Module"})),Ct=ie(yt);Object.defineProperty(Z,"__esModule",{value:!0}),Z.convertToBuffer=void 0;var Ut=Ct,wt=typeof se<"u"&&se.from?function(i){return se.from(i,"utf8")}:Ut.fromUtf8;function At(i){return i instanceof Uint8Array?i:typeof i=="string"?wt(i):ArrayBuffer.isView(i)?new Uint8Array(i.buffer,i.byteOffset,i.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(i)}Z.convertToBuffer=At;var z={};Object.defineProperty(z,"__esModule",{value:!0}),z.isEmptyData=void 0;function Dt(i){return typeof i=="string"?i.length===0:i.byteLength===0}z.isEmptyData=Dt;var Y={};Object.defineProperty(Y,"__esModule",{value:!0}),Y.numToUint8=void 0;function Tt(i){return new Uint8Array([(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])}Y.numToUint8=Tt;var X={};Object.defineProperty(X,"__esModule",{value:!0}),X.uint32ArrayFrom=void 0;function Et(i){if(!Array.from){for(var t=new Uint32Array(i.length),e=0;e<i.length;)t[e]=i[e];return t}return Uint32Array.from(i)}X.uint32ArrayFrom=Et,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.uint32ArrayFrom=i.numToUint8=i.isEmptyData=i.convertToBuffer=void 0;var t=Z;Object.defineProperty(i,"convertToBuffer",{enumerable:!0,get:function(){return t.convertToBuffer}});var e=z;Object.defineProperty(i,"isEmptyData",{enumerable:!0,get:function(){return e.isEmptyData}});var r=Y;Object.defineProperty(i,"numToUint8",{enumerable:!0,get:function(){return r.numToUint8}});var n=X;Object.defineProperty(i,"uint32ArrayFrom",{enumerable:!0,get:function(){return n.uint32ArrayFrom}})}(Ae),Object.defineProperty(G,"__esModule",{value:!0}),G.Sha256=void 0;var De=we,Q=U,ce=W,he=Ae,It=function(){function i(t){if(this.hash=new ce.RawSha256,t){this.outer=new ce.RawSha256;var e=bt(t),r=new Uint8Array(Q.BLOCK_SIZE);r.set(e);for(var n=0;n<Q.BLOCK_SIZE;n++)e[n]^=54,r[n]^=92;this.hash.update(e),this.outer.update(r);for(var n=0;n<e.byteLength;n++)e[n]=0}}return i.prototype.update=function(t){if(!((0,he.isEmptyData)(t)||this.error))try{this.hash.update((0,he.convertToBuffer)(t))}catch(e){this.error=e}},i.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},i.prototype.digest=function(){return(0,De.__awaiter)(this,void 0,void 0,function(){return(0,De.__generator)(this,function(t){return[2,this.digestSync()]})})},i}();G.Sha256=It;function bt(i){var t=(0,he.convertToBuffer)(i);if(t.byteLength>Q.BLOCK_SIZE){var e=new ce.RawSha256;e.update(t),t=e.digest()}var r=new Uint8Array(Q.BLOCK_SIZE);return r.set(t),r}(function(i){Object.defineProperty(i,"__esModule",{value:!0});var t=we;(0,t.__exportStar)(G,i)})(P);function d(i,t){i!=null&&this.fromString(i,t)}function C(){return new d(null)}var b,_t=0xdeadbeefcafe,Te=(_t&16777215)==15715070;function Pt(i,t,e,r,n,s){for(;--s>=0;){var o=t*this[i++]+e[r]+n;n=Math.floor(o/67108864),e[r++]=o&67108863}return n}function kt(i,t,e,r,n,s){for(var o=t&32767,a=t>>15;--s>=0;){var u=this[i]&32767,c=this[i++]>>15,h=a*u+c*o;u=o*u+((h&32767)<<15)+e[r]+(n&1073741823),n=(u>>>30)+(h>>>15)+a*c+(n>>>30),e[r++]=u&1073741823}return n}function Rt(i,t,e,r,n,s){for(var o=t&16383,a=t>>14;--s>=0;){var u=this[i]&16383,c=this[i++]>>14,h=a*u+c*o;u=o*u+((h&16383)<<14)+e[r]+n,n=(u>>28)+(h>>14)+a*c,e[r++]=u&268435455}return n}var Ee=typeof navigator<"u";Ee&&Te&&navigator.appName=="Microsoft Internet Explorer"?(d.prototype.am=kt,b=30):Ee&&Te&&navigator.appName!="Netscape"?(d.prototype.am=Pt,b=26):(d.prototype.am=Rt,b=28),d.prototype.DB=b,d.prototype.DM=(1<<b)-1,d.prototype.DV=1<<b;var le=52;d.prototype.FV=Math.pow(2,le),d.prototype.F1=le-b,d.prototype.F2=2*b-le;var Ft="0123456789abcdefghijklmnopqrstuvwxyz",$=new Array,k,D;for(k=48,D=0;D<=9;++D)$[k++]=D;for(k=97,D=10;D<36;++D)$[k++]=D;for(k=65,D=10;D<36;++D)$[k++]=D;function Ie(i){return Ft.charAt(i)}function Ot(i,t){var e=$[i.charCodeAt(t)];return e??-1}function Mt(i){for(var t=this.t-1;t>=0;--t)i[t]=this[t];i.t=this.t,i.s=this.s}function Nt(i){this.t=1,this.s=i<0?-1:0,i>0?this[0]=i:i<-1?this[0]=i+this.DV:this.t=0}function fe(i){var t=C();return t.fromInt(i),t}function xt(i,t){var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;for(var r=i.length,n=!1,s=0;--r>=0;){var o=Ot(i,r);if(o<0){i.charAt(r)=="-"&&(n=!0);continue}n=!1,s==0?this[this.t++]=o:s+e>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,s+=e,s>=this.DB&&(s-=this.DB)}this.clamp(),n&&d.ZERO.subTo(this,this)}function Bt(){for(var i=this.s&this.DM;this.t>0&&this[this.t-1]==i;)--this.t}function Kt(i){if(this.s<0)return"-"+this.negate().toString(i);var t;if(i==16)t=4;else if(i==8)t=3;else if(i==2)t=1;else if(i==32)t=5;else if(i==4)t=2;else throw new Error("Only radix 2, 4, 8, 16, 32 are supported");var e=(1<<t)-1,r,n=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(r=this[o]>>a)>0&&(n=!0,s=Ie(r));o>=0;)a<t?(r=(this[o]&(1<<a)-1)<<t-a,r|=this[--o]>>(a+=this.DB-t)):(r=this[o]>>(a-=t)&e,a<=0&&(a+=this.DB,--o)),r>0&&(n=!0),n&&(s+=Ie(r));return n?s:"0"}function Vt(){var i=C();return d.ZERO.subTo(this,i),i}function qt(){return this.s<0?this.negate():this}function Lt(i){var t=this.s-i.s;if(t!=0)return t;var e=this.t;if(t=e-i.t,t!=0)return this.s<0?-t:t;for(;--e>=0;)if((t=this[e]-i[e])!=0)return t;return 0}function de(i){var t=1,e;return(e=i>>>16)!=0&&(i=e,t+=16),(e=i>>8)!=0&&(i=e,t+=8),(e=i>>4)!=0&&(i=e,t+=4),(e=i>>2)!=0&&(i=e,t+=2),(e=i>>1)!=0&&(i=e,t+=1),t}function jt(){return this.t<=0?0:this.DB*(this.t-1)+de(this[this.t-1]^this.s&this.DM)}function Ht(i,t){var e;for(e=this.t-1;e>=0;--e)t[e+i]=this[e];for(e=i-1;e>=0;--e)t[e]=0;t.t=this.t+i,t.s=this.s}function Jt(i,t){for(var e=i;e<this.t;++e)t[e-i]=this[e];t.t=Math.max(this.t-i,0),t.s=this.s}function Gt(i,t){var e=i%this.DB,r=this.DB-e,n=(1<<r)-1,s=Math.floor(i/this.DB),o=this.s<<e&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+s+1]=this[a]>>r|o,o=(this[a]&n)<<e;for(a=s-1;a>=0;--a)t[a]=0;t[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function Wt(i,t){t.s=this.s;var e=Math.floor(i/this.DB);if(e>=this.t){t.t=0;return}var r=i%this.DB,n=this.DB-r,s=(1<<r)-1;t[0]=this[e]>>r;for(var o=e+1;o<this.t;++o)t[o-e-1]|=(this[o]&s)<<n,t[o-e]=this[o]>>r;r>0&&(t[this.t-e-1]|=(this.s&s)<<n),t.t=this.t-e,t.clamp()}function Zt(i,t){for(var e=0,r=0,n=Math.min(i.t,this.t);e<n;)r+=this[e]-i[e],t[e++]=r&this.DM,r>>=this.DB;if(i.t<this.t){for(r-=i.s;e<this.t;)r+=this[e],t[e++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e<i.t;)r-=i[e],t[e++]=r&this.DM,r>>=this.DB;r-=i.s}t.s=r<0?-1:0,r<-1?t[e++]=this.DV+r:r>0&&(t[e++]=r),t.t=e,t.clamp()}function zt(i,t){var e=this.abs(),r=i.abs(),n=e.t;for(t.t=n+r.t;--n>=0;)t[n]=0;for(n=0;n<r.t;++n)t[n+e.t]=e.am(0,r[n],t,n,0,e.t);t.s=0,t.clamp(),this.s!=i.s&&d.ZERO.subTo(t,t)}function Yt(i){for(var t=this.abs(),e=i.t=2*t.t;--e>=0;)i[e]=0;for(e=0;e<t.t-1;++e){var r=t.am(e,t[e],i,2*e,0,1);(i[e+t.t]+=t.am(e+1,2*t[e],i,2*e+1,r,t.t-e-1))>=t.DV&&(i[e+t.t]-=t.DV,i[e+t.t+1]=1)}i.t>0&&(i[i.t-1]+=t.am(e,t[e],i,2*e,0,1)),i.s=0,i.clamp()}function Xt(i,t,e){var r=i.abs();if(!(r.t<=0)){var n=this.abs();if(n.t<r.t){t==null||t.fromInt(0),e!=null&&this.copyTo(e);return}e==null&&(e=C());var s=C(),o=this.s,a=i.s,u=this.DB-de(r[r.t-1]);u>0?(r.lShiftTo(u,s),n.lShiftTo(u,e)):(r.copyTo(s),n.copyTo(e));var c=s.t,h=s[c-1];if(h!=0){var l=h*(1<<this.F1)+(c>1?s[c-2]>>this.F2:0),f=this.FV/l,g=(1<<this.F1)/l,v=1<<this.F2,p=e.t,S=p-c,y=t??C();for(s.dlShiftTo(S,y),e.compareTo(y)>=0&&(e[e.t++]=1,e.subTo(y,e)),d.ONE.dlShiftTo(c,y),y.subTo(s,s);s.t<c;)s[s.t++]=0;for(;--S>=0;){var E=e[--p]==h?this.DM:Math.floor(e[p]*f+(e[p-1]+v)*g);if((e[p]+=s.am(0,E,e,S,0,c))<E)for(s.dlShiftTo(S,y),e.subTo(y,e);e[p]<--E;)e.subTo(y,e)}t!=null&&(e.drShiftTo(c,t),o!=a&&d.ZERO.subTo(t,t)),e.t=c,e.clamp(),u>0&&e.rShiftTo(u,e),o<0&&d.ZERO.subTo(e,e)}}}function Qt(i){var t=C();return this.abs().divRemTo(i,null,t),this.s<0&&t.compareTo(d.ZERO)>0&&i.subTo(t,t),t}function $t(){if(this.t<1)return 0;var i=this[0];if(!(i&1))return 0;var t=i&3;return t=t*(2-(i&15)*t)&15,t=t*(2-(i&255)*t)&255,t=t*(2-((i&65535)*t&65535))&65535,t=t*(2-i*t%this.DV)%this.DV,t>0?this.DV-t:-t}function en(i){return this.compareTo(i)==0}function tn(i,t){for(var e=0,r=0,n=Math.min(i.t,this.t);e<n;)r+=this[e]+i[e],t[e++]=r&this.DM,r>>=this.DB;if(i.t<this.t){for(r+=i.s;e<this.t;)r+=this[e],t[e++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e<i.t;)r+=i[e],t[e++]=r&this.DM,r>>=this.DB;r+=i.s}t.s=r<0?-1:0,r>0?t[e++]=r:r<-1&&(t[e++]=this.DV+r),t.t=e,t.clamp()}function nn(i){var t=C();return this.addTo(i,t),t}function rn(i){var t=C();return this.subTo(i,t),t}function sn(i){var t=C();return this.multiplyTo(i,t),t}function on(i){var t=C();return this.divRemTo(i,t,null),t}function R(i){this.m=i,this.mp=i.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<i.DB-15)-1,this.mt2=2*i.t}function an(i){var t=C();return i.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),i.s<0&&t.compareTo(d.ZERO)>0&&this.m.subTo(t,t),t}function un(i){var t=C();return i.copyTo(t),this.reduce(t),t}function cn(i){for(;i.t<=this.mt2;)i[i.t++]=0;for(var t=0;t<this.m.t;++t){var e=i[t]&32767,r=e*this.mpl+((e*this.mph+(i[t]>>15)*this.mpl&this.um)<<15)&i.DM;for(e=t+this.m.t,i[e]+=this.m.am(0,r,i,t,0,this.m.t);i[e]>=i.DV;)i[e]-=i.DV,i[++e]++}i.clamp(),i.drShiftTo(this.m.t,i),i.compareTo(this.m)>=0&&i.subTo(this.m,i)}function hn(i,t){i.squareTo(t),this.reduce(t)}function ln(i,t,e){i.multiplyTo(t,e),this.reduce(e)}R.prototype.convert=an,R.prototype.revert=un,R.prototype.reduce=cn,R.prototype.mulTo=ln,R.prototype.sqrTo=hn;function fn(i,t,e){var r=i.bitLength(),n,s=fe(1),o=new R(t);if(r<=0)return s;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6;var a=new Array,u=3,c=n-1,h=(1<<n)-1;if(a[1]=o.convert(this),n>1){var l=C();for(o.sqrTo(a[1],l);u<=h;)a[u]=C(),o.mulTo(l,a[u-2],a[u]),u+=2}var f=i.t-1,g,v=!0,p=C(),S;for(r=de(i[f])-1;f>=0;){for(r>=c?g=i[f]>>r-c&h:(g=(i[f]&(1<<r+1)-1)<<c-r,f>0&&(g|=i[f-1]>>this.DB+r-c)),u=n;!(g&1);)g>>=1,--u;if((r-=u)<0&&(r+=this.DB,--f),v)a[g].copyTo(s),v=!1;else{for(;u>1;)o.sqrTo(s,p),o.sqrTo(p,s),u-=2;u>0?o.sqrTo(s,p):(S=s,s=p,p=S),o.mulTo(p,a[g],s)}for(;f>=0&&!(i[f]&1<<r);)o.sqrTo(s,p),S=s,s=p,p=S,--r<0&&(r=this.DB-1,--f)}var y=o.revert(s);return e(null,y),y}d.prototype.copyTo=Mt,d.prototype.fromInt=Nt,d.prototype.fromString=xt,d.prototype.clamp=Bt,d.prototype.dlShiftTo=Ht,d.prototype.drShiftTo=Jt,d.prototype.lShiftTo=Gt,d.prototype.rShiftTo=Wt,d.prototype.subTo=Zt,d.prototype.multiplyTo=zt,d.prototype.squareTo=Yt,d.prototype.divRemTo=Xt,d.prototype.invDigit=$t,d.prototype.addTo=tn,d.prototype.toString=Kt,d.prototype.negate=Vt,d.prototype.abs=qt,d.prototype.compareTo=Lt,d.prototype.bitLength=jt,d.prototype.mod=Qt,d.prototype.equals=en,d.prototype.add=nn,d.prototype.subtract=rn,d.prototype.multiply=sn,d.prototype.divide=on,d.prototype.modPow=fn,d.ZERO=fe(0),d.ONE=fe(1);/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/function ge(i){return m.from(new Je().random(i).toString(),"hex")}var dn=/^[89a-f]/i,gn="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",pn="userAttributes.",F=function(){function i(e){this.N=new d(gn,16),this.g=new d("2",16),this.k=new d(this.hexHash(""+this.padHex(this.N)+this.padHex(this.g)),16),this.smallAValue=this.generateRandomSmallA(),this.getLargeAValue(function(){}),this.infoBits=m.from("Caldera Derived Key","utf8"),this.poolName=e}var t=i.prototype;return t.getSmallAValue=function(){return this.smallAValue},t.getLargeAValue=function(e){var r=this;this.largeAValue?e(null,this.largeAValue):this.calculateA(this.smallAValue,function(n,s){n&&e(n,null),r.largeAValue=s,e(null,r.largeAValue)})},t.generateRandomSmallA=function(){var e=ge(128).toString("hex"),r=new d(e,16);return r},t.generateRandomString=function(){return ge(40).toString("base64")},t.getRandomPassword=function(){return this.randomPassword},t.getSaltDevices=function(){return this.SaltToHashDevices},t.getVerifierDevices=function(){return this.verifierDevices},t.generateHashDevice=function(e,r,n){var s=this;this.randomPassword=this.generateRandomString();var o=""+e+r+":"+this.randomPassword,a=this.hash(o),u=ge(16).toString("hex");this.SaltToHashDevices=this.padHex(new d(u,16)),this.g.modPow(new d(this.hexHash(this.SaltToHashDevices+a),16),this.N,function(c,h){c&&n(c,null),s.verifierDevices=s.padHex(h),n(null,null)})},t.calculateA=function(e,r){var n=this;this.g.modPow(e,this.N,function(s,o){s&&r(s,null),o.mod(n.N).equals(d.ZERO)&&r(new Error("Illegal paramater. A mod N cannot be 0."),null),r(null,o)})},t.calculateU=function(e,r){this.UHexHash=this.hexHash(this.padHex(e)+this.padHex(r));var n=new d(this.UHexHash,16);return n},t.hash=function(e){var r=new P.Sha256;r.update(e);var n=r.digestSync(),s=m.from(n).toString("hex");return new Array(64-s.length).join("0")+s},t.hexHash=function(e){return this.hash(m.from(e,"hex"))},t.computehkdf=function(e,r){var n=m.concat([this.infoBits,m.from("","utf8")]),s=new P.Sha256(r);s.update(e);var o=s.digestSync(),a=new P.Sha256(o);a.update(n);var u=a.digestSync(),c=u,h=c.slice(0,16);return h},t.getPasswordAuthenticationKey=function(e,r,n,s,o){var a=this;if(n.mod(this.N).equals(d.ZERO))throw new Error("B cannot be zero.");if(this.UValue=this.calculateU(this.largeAValue,n),this.UValue.equals(d.ZERO))throw new Error("U cannot be zero.");var u=""+this.poolName+e+":"+r,c=this.hash(u),h=new d(this.hexHash(this.padHex(s)+c),16);this.calculateS(h,n,function(l,f){l&&o(l,null);var g=a.computehkdf(m.from(a.padHex(f),"hex"),m.from(a.padHex(a.UValue),"hex"));o(null,g)})},t.calculateS=function(e,r,n){var s=this;this.g.modPow(e,this.N,function(o,a){o&&n(o,null);var u=r.subtract(s.k.multiply(a));u.modPow(s.smallAValue.add(s.UValue.multiply(e)),s.N,function(c,h){c&&n(c,null),n(null,h.mod(s.N))})})},t.getNewPasswordRequiredChallengeUserAttributePrefix=function(){return pn},t.padHex=function(e){if(!(e instanceof d))throw new Error("Not a BigInteger");var r=e.compareTo(d.ZERO)<0,n=e.abs().toString(16);if(n=n.length%2!==0?"0"+n:n,n=dn.test(n)?"00"+n:n,r){var s=n.split("").map(function(a){var u=~parseInt(a,16)&15;return"0123456789ABCDEF".charAt(u)}).join(""),o=new d(s,16).add(d.ONE);n=o.toString(16),n.toUpperCase().startsWith("FF8")&&(n=n.substring(2))}return n},i}();/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var be=function(){function i(e){this.jwtToken=e||"",this.payload=this.decodePayload()}var t=i.prototype;return t.getJwtToken=function(){return this.jwtToken},t.getExpiration=function(){return this.payload.exp},t.getIssuedAt=function(){return this.payload.iat},t.decodePayload=function(){var e=this.jwtToken.split(".")[1];try{return JSON.parse(m.from(e,"base64").toString("utf8"))}catch{return{}}},i}();function vn(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,pe(i,t)}function pe(i,t){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},pe(i,t)}var _e=function(i){vn(t,i);function t(e){var r=e===void 0?{}:e,n=r.AccessToken;return i.call(this,n||"")||this}return t}(be);function Sn(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,ve(i,t)}function ve(i,t){return ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},ve(i,t)}var Pe=function(i){Sn(t,i);function t(e){var r=e===void 0?{}:e,n=r.IdToken;return i.call(this,n||"")||this}return t}(be);/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var ke=function(){function i(e){var r=e===void 0?{}:e,n=r.RefreshToken;this.token=n||""}var t=i.prototype;return t.getToken=function(){return this.token},i}(),mn="5.0.4";/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var yn="aws-amplify/"+mn,Re={userAgent:yn,isReactNative:typeof navigator<"u"&&navigator.product==="ReactNative"},Cn=function(){return Re.userAgent};/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var Fe=function(){function i(e){var r=e===void 0?{}:e,n=r.IdToken,s=r.RefreshToken,o=r.AccessToken,a=r.ClockDrift;if(o==null||n==null)throw new Error("Id token and Access Token must be present.");this.idToken=n,this.refreshToken=s,this.accessToken=o,this.clockDrift=a===void 0?this.calculateClockDrift():a}var t=i.prototype;return t.getIdToken=function(){return this.idToken},t.getRefreshToken=function(){return this.refreshToken},t.getAccessToken=function(){return this.accessToken},t.getClockDrift=function(){return this.clockDrift},t.calculateClockDrift=function(){var e=Math.floor(new Date/1e3),r=Math.min(this.accessToken.getIssuedAt(),this.idToken.getIssuedAt());return e-r},t.isValid=function(){var e=Math.floor(new Date/1e3),r=e-this.clockDrift;return r<this.accessToken.getExpiration()&&r<this.idToken.getExpiration()},i}();/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var Un=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wn=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Oe=function(){function i(){}var t=i.prototype;return t.getNowString=function(){var e=new Date,r=wn[e.getUTCDay()],n=Un[e.getUTCMonth()],s=e.getUTCDate(),o=e.getUTCHours();o<10&&(o="0"+o);var a=e.getUTCMinutes();a<10&&(a="0"+a);var u=e.getUTCSeconds();u<10&&(u="0"+u);var c=e.getUTCFullYear(),h=r+" "+n+" "+s+" "+o+":"+a+":"+u+" UTC "+c;return h},i}();/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var An=function(){function i(e){var r=e===void 0?{}:e,n=r.Name,s=r.Value;this.Name=n||"",this.Value=s||""}var t=i.prototype;return t.getValue=function(){return this.Value},t.setValue=function(e){return this.Value=e,this},t.getName=function(){return this.Name},t.setName=function(e){return this.Name=e,this},t.toString=function(){return JSON.stringify(this)},t.toJSON=function(){return{Name:this.Name,Value:this.Value}},i}();/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var _={},Dn=function(){function i(){}return i.setItem=function(t,e){return _[t]=e,_[t]},i.getItem=function(t){return Object.prototype.hasOwnProperty.call(_,t)?_[t]:void 0},i.removeItem=function(t){return delete _[t]},i.clear=function(){return _={},_},i}(),Me=function(){function i(){try{this.storageWindow=window.localStorage,this.storageWindow.setItem("aws.cognito.test-ls",1),this.storageWindow.removeItem("aws.cognito.test-ls")}catch{this.storageWindow=Dn}}var t=i.prototype;return t.getStorage=function(){return this.storageWindow},i}();/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var Tn=typeof navigator<"u",Ne=Tn?Re.isReactNative?"react-native":navigator.userAgent:"nodejs",Se=function(){function i(e){if(e==null||e.Username==null||e.Pool==null)throw new Error("Username and Pool information are required.");this.username=e.Username||"",this.pool=e.Pool,this.Session=null,this.client=e.Pool.client,this.signInUserSession=null,this.authenticationFlowType="USER_SRP_AUTH",this.storage=e.Storage||new Me().getStorage(),this.keyPrefix="CognitoIdentityServiceProvider."+this.pool.getClientId(),this.userDataKey=this.keyPrefix+"."+this.username+".userData"}var t=i.prototype;return t.setSignInUserSession=function(e){this.clearCachedUserData(),this.signInUserSession=e,this.cacheTokens()},t.getSignInUserSession=function(){return this.signInUserSession},t.getUsername=function(){return this.username},t.getAuthenticationFlowType=function(){return this.authenticationFlowType},t.setAuthenticationFlowType=function(e){this.authenticationFlowType=e},t.initiateAuth=function(e,r){var n=this,s=e.getAuthParameters();s.USERNAME=this.username;var o=Object.keys(e.getValidationData()).length!==0?e.getValidationData():e.getClientMetadata(),a={AuthFlow:"CUSTOM_AUTH",ClientId:this.pool.getClientId(),AuthParameters:s,ClientMetadata:o};this.getUserContextData()&&(a.UserContextData=this.getUserContextData()),this.client.request("InitiateAuth",a,function(u,c){if(u)return r.onFailure(u);var h=c.ChallengeName,l=c.ChallengeParameters;return h==="CUSTOM_CHALLENGE"?(n.Session=c.Session,r.customChallenge(l)):(n.signInUserSession=n.getCognitoUserSession(c.AuthenticationResult),n.cacheTokens(),r.onSuccess(n.signInUserSession))})},t.authenticateUser=function(e,r){return this.authenticationFlowType==="USER_PASSWORD_AUTH"?this.authenticateUserPlainUsernamePassword(e,r):this.authenticationFlowType==="USER_SRP_AUTH"||this.authenticationFlowType==="CUSTOM_AUTH"?this.authenticateUserDefaultAuth(e,r):r.onFailure(new Error("Authentication flow type is invalid."))},t.authenticateUserDefaultAuth=function(e,r){var n=this,s=new F(this.pool.getUserPoolName()),o=new Oe,a,u,c={};this.deviceKey!=null&&(c.DEVICE_KEY=this.deviceKey),c.USERNAME=this.username,s.getLargeAValue(function(h,l){h&&r.onFailure(h),c.SRP_A=l.toString(16),n.authenticationFlowType==="CUSTOM_AUTH"&&(c.CHALLENGE_NAME="SRP_A");var f=Object.keys(e.getValidationData()).length!==0?e.getValidationData():e.getClientMetadata(),g={AuthFlow:n.authenticationFlowType,ClientId:n.pool.getClientId(),AuthParameters:c,ClientMetadata:f};n.getUserContextData(n.username)&&(g.UserContextData=n.getUserContextData(n.username)),n.client.request("InitiateAuth",g,function(v,p){if(v)return r.onFailure(v);var S=p.ChallengeParameters;n.username=S.USER_ID_FOR_SRP,n.userDataKey=n.keyPrefix+"."+n.username+".userData",a=new d(S.SRP_B,16),u=new d(S.SALT,16),n.getCachedDeviceKeyAndPassword(),s.getPasswordAuthenticationKey(n.username,e.getPassword(),a,u,function(y,E){y&&r.onFailure(y);var x=o.getNowString(),B=m.concat([m.from(n.pool.getUserPoolName(),"utf8"),m.from(n.username,"utf8"),m.from(S.SECRET_BLOCK,"base64"),m.from(x,"utf8")]),K=new P.Sha256(E);K.update(B);var ne=K.digestSync(),I=m.from(ne).toString("base64"),T={};T.USERNAME=n.username,T.PASSWORD_CLAIM_SECRET_BLOCK=S.SECRET_BLOCK,T.TIMESTAMP=x,T.PASSWORD_CLAIM_SIGNATURE=I,n.deviceKey!=null&&(T.DEVICE_KEY=n.deviceKey);var V=function L(j,Ce){return n.client.request("RespondToAuthChallenge",j,function(H,qe){return H&&H.code==="ResourceNotFoundException"&&H.message.toLowerCase().indexOf("device")!==-1?(T.DEVICE_KEY=null,n.deviceKey=null,n.randomPassword=null,n.deviceGroupKey=null,n.clearCachedDeviceKeyAndPassword(),L(j,Ce)):Ce(H,qe)})},q={ChallengeName:"PASSWORD_VERIFIER",ClientId:n.pool.getClientId(),ChallengeResponses:T,Session:p.Session,ClientMetadata:f};n.getUserContextData()&&(q.UserContextData=n.getUserContextData()),V(q,function(L,j){return L?r.onFailure(L):n.authenticateUserInternal(j,s,r)})})})})},t.authenticateUserPlainUsernamePassword=function(e,r){var n=this,s={};if(s.USERNAME=this.username,s.PASSWORD=e.getPassword(),!s.PASSWORD){r.onFailure(new Error("PASSWORD parameter is required"));return}var o=new F(this.pool.getUserPoolName());this.getCachedDeviceKeyAndPassword(),this.deviceKey!=null&&(s.DEVICE_KEY=this.deviceKey);var a=Object.keys(e.getValidationData()).length!==0?e.getValidationData():e.getClientMetadata(),u={AuthFlow:"USER_PASSWORD_AUTH",ClientId:this.pool.getClientId(),AuthParameters:s,ClientMetadata:a};this.getUserContextData(this.username)&&(u.UserContextData=this.getUserContextData(this.username)),this.client.request("InitiateAuth",u,function(c,h){return c?r.onFailure(c):n.authenticateUserInternal(h,o,r)})},t.authenticateUserInternal=function(e,r,n){var s=this,o=e.ChallengeName,a=e.ChallengeParameters;if(o==="SMS_MFA")return this.Session=e.Session,n.mfaRequired(o,a);if(o==="SELECT_MFA_TYPE")return this.Session=e.Session,n.selectMFAType(o,a);if(o==="MFA_SETUP")return this.Session=e.Session,n.mfaSetup(o,a);if(o==="SOFTWARE_TOKEN_MFA")return this.Session=e.Session,n.totpRequired(o,a);if(o==="CUSTOM_CHALLENGE")return this.Session=e.Session,n.customChallenge(a);if(o==="NEW_PASSWORD_REQUIRED"){this.Session=e.Session;var u=null,c=null,h=[],l=r.getNewPasswordRequiredChallengeUserAttributePrefix();if(a&&(u=JSON.parse(e.ChallengeParameters.userAttributes),c=JSON.parse(e.ChallengeParameters.requiredAttributes)),c)for(var f=0;f<c.length;f++)h[f]=c[f].substr(l.length);return n.newPasswordRequired(u,h)}if(o==="DEVICE_SRP_AUTH"){this.Session=e.Session,this.getDeviceResponse(n);return}this.signInUserSession=this.getCognitoUserSession(e.AuthenticationResult),this.challengeName=o,this.cacheTokens();var g=e.AuthenticationResult.NewDeviceMetadata;if(g==null)return n.onSuccess(this.signInUserSession);r.generateHashDevice(e.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,e.AuthenticationResult.NewDeviceMetadata.DeviceKey,function(v){if(v)return n.onFailure(v);var p={Salt:m.from(r.getSaltDevices(),"hex").toString("base64"),PasswordVerifier:m.from(r.getVerifierDevices(),"hex").toString("base64")};s.verifierDevices=p.PasswordVerifier,s.deviceGroupKey=g.DeviceGroupKey,s.randomPassword=r.getRandomPassword(),s.client.request("ConfirmDevice",{DeviceKey:g.DeviceKey,AccessToken:s.signInUserSession.getAccessToken().getJwtToken(),DeviceSecretVerifierConfig:p,DeviceName:Ne},function(S,y){return S?n.onFailure(S):(s.deviceKey=e.AuthenticationResult.NewDeviceMetadata.DeviceKey,s.cacheDeviceKeyAndPassword(),y.UserConfirmationNecessary===!0?n.onSuccess(s.signInUserSession,y.UserConfirmationNecessary):n.onSuccess(s.signInUserSession))})})},t.completeNewPasswordChallenge=function(e,r,n,s){var o=this;if(!e)return n.onFailure(new Error("New password is required."));var a=new F(this.pool.getUserPoolName()),u=a.getNewPasswordRequiredChallengeUserAttributePrefix(),c={};r&&Object.keys(r).forEach(function(l){c[u+l]=r[l]}),c.NEW_PASSWORD=e,c.USERNAME=this.username;var h={ChallengeName:"NEW_PASSWORD_REQUIRED",ClientId:this.pool.getClientId(),ChallengeResponses:c,Session:this.Session,ClientMetadata:s};this.getUserContextData()&&(h.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",h,function(l,f){return l?n.onFailure(l):o.authenticateUserInternal(f,a,n)})},t.getDeviceResponse=function(e,r){var n=this,s=new F(this.deviceGroupKey),o=new Oe,a={};a.USERNAME=this.username,a.DEVICE_KEY=this.deviceKey,s.getLargeAValue(function(u,c){u&&e.onFailure(u),a.SRP_A=c.toString(16);var h={ChallengeName:"DEVICE_SRP_AUTH",ClientId:n.pool.getClientId(),ChallengeResponses:a,ClientMetadata:r,Session:n.Session};n.getUserContextData()&&(h.UserContextData=n.getUserContextData()),n.client.request("RespondToAuthChallenge",h,function(l,f){if(l)return e.onFailure(l);var g=f.ChallengeParameters,v=new d(g.SRP_B,16),p=new d(g.SALT,16);s.getPasswordAuthenticationKey(n.deviceKey,n.randomPassword,v,p,function(S,y){if(S)return e.onFailure(S);var E=o.getNowString(),x=m.concat([m.from(n.deviceGroupKey,"utf8"),m.from(n.deviceKey,"utf8"),m.from(g.SECRET_BLOCK,"base64"),m.from(E,"utf8")]),B=new P.Sha256(y);B.update(x);var K=B.digestSync(),ne=m.from(K).toString("base64"),I={};I.USERNAME=n.username,I.PASSWORD_CLAIM_SECRET_BLOCK=g.SECRET_BLOCK,I.TIMESTAMP=E,I.PASSWORD_CLAIM_SIGNATURE=ne,I.DEVICE_KEY=n.deviceKey;var T={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:n.pool.getClientId(),ChallengeResponses:I,Session:f.Session};n.getUserContextData()&&(T.UserContextData=n.getUserContextData()),n.client.request("RespondToAuthChallenge",T,function(V,q){return V?e.onFailure(V):(n.signInUserSession=n.getCognitoUserSession(q.AuthenticationResult),n.cacheTokens(),e.onSuccess(n.signInUserSession))})})})})},t.confirmRegistration=function(e,r,n,s){var o={ClientId:this.pool.getClientId(),ConfirmationCode:e,Username:this.username,ForceAliasCreation:r,ClientMetadata:s};this.getUserContextData()&&(o.UserContextData=this.getUserContextData()),this.client.request("ConfirmSignUp",o,function(a){return a?n(a,null):n(null,"SUCCESS")})},t.sendCustomChallengeAnswer=function(e,r,n){var s=this,o={};o.USERNAME=this.username,o.ANSWER=e;var a=new F(this.pool.getUserPoolName());this.getCachedDeviceKeyAndPassword(),this.deviceKey!=null&&(o.DEVICE_KEY=this.deviceKey);var u={ChallengeName:"CUSTOM_CHALLENGE",ChallengeResponses:o,ClientId:this.pool.getClientId(),Session:this.Session,ClientMetadata:n};this.getUserContextData()&&(u.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",u,function(c,h){return c?r.onFailure(c):s.authenticateUserInternal(h,a,r)})},t.sendMFACode=function(e,r,n,s){var o=this,a={};a.USERNAME=this.username,a.SMS_MFA_CODE=e;var u=n||"SMS_MFA";u==="SOFTWARE_TOKEN_MFA"&&(a.SOFTWARE_TOKEN_MFA_CODE=e),this.deviceKey!=null&&(a.DEVICE_KEY=this.deviceKey);var c={ChallengeName:u,ChallengeResponses:a,ClientId:this.pool.getClientId(),Session:this.Session,ClientMetadata:s};this.getUserContextData()&&(c.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",c,function(h,l){if(h)return r.onFailure(h);var f=l.ChallengeName;if(f==="DEVICE_SRP_AUTH"){o.getDeviceResponse(r);return}if(o.signInUserSession=o.getCognitoUserSession(l.AuthenticationResult),o.cacheTokens(),l.AuthenticationResult.NewDeviceMetadata==null)return r.onSuccess(o.signInUserSession);var g=new F(o.pool.getUserPoolName());g.generateHashDevice(l.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,l.AuthenticationResult.NewDeviceMetadata.DeviceKey,function(v){if(v)return r.onFailure(v);var p={Salt:m.from(g.getSaltDevices(),"hex").toString("base64"),PasswordVerifier:m.from(g.getVerifierDevices(),"hex").toString("base64")};o.verifierDevices=p.PasswordVerifier,o.deviceGroupKey=l.AuthenticationResult.NewDeviceMetadata.DeviceGroupKey,o.randomPassword=g.getRandomPassword(),o.client.request("ConfirmDevice",{DeviceKey:l.AuthenticationResult.NewDeviceMetadata.DeviceKey,AccessToken:o.signInUserSession.getAccessToken().getJwtToken(),DeviceSecretVerifierConfig:p,DeviceName:Ne},function(S,y){return S?r.onFailure(S):(o.deviceKey=l.AuthenticationResult.NewDeviceMetadata.DeviceKey,o.cacheDeviceKeyAndPassword(),y.UserConfirmationNecessary===!0?r.onSuccess(o.signInUserSession,y.UserConfirmationNecessary):r.onSuccess(o.signInUserSession))})})})},t.changePassword=function(e,r,n,s){if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return n(new Error("User is not authenticated"),null);this.client.request("ChangePassword",{PreviousPassword:e,ProposedPassword:r,AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),ClientMetadata:s},function(o){return o?n(o,null):n(null,"SUCCESS")})},t.enableMFA=function(e){if(this.signInUserSession==null||!this.signInUserSession.isValid())return e(new Error("User is not authenticated"),null);var r=[],n={DeliveryMedium:"SMS",AttributeName:"phone_number"};r.push(n),this.client.request("SetUserSettings",{MFAOptions:r,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(s){return s?e(s,null):e(null,"SUCCESS")})},t.setUserMfaPreference=function(e,r,n){if(this.signInUserSession==null||!this.signInUserSession.isValid())return n(new Error("User is not authenticated"),null);this.client.request("SetUserMFAPreference",{SMSMfaSettings:e,SoftwareTokenMfaSettings:r,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(s){return s?n(s,null):n(null,"SUCCESS")})},t.disableMFA=function(e){if(this.signInUserSession==null||!this.signInUserSession.isValid())return e(new Error("User is not authenticated"),null);var r=[];this.client.request("SetUserSettings",{MFAOptions:r,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(n){return n?e(n,null):e(null,"SUCCESS")})},t.deleteUser=function(e,r){var n=this;if(this.signInUserSession==null||!this.signInUserSession.isValid())return e(new Error("User is not authenticated"),null);this.client.request("DeleteUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),ClientMetadata:r},function(s){return s?e(s,null):(n.clearCachedUser(),e(null,"SUCCESS"))})},t.updateAttributes=function(e,r,n){var s=this;if(this.signInUserSession==null||!this.signInUserSession.isValid())return r(new Error("User is not authenticated"),null);this.client.request("UpdateUserAttributes",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),UserAttributes:e,ClientMetadata:n},function(o,a){return o?r(o,null):s.getUserData(function(){return r(null,"SUCCESS",a)},{bypassCache:!0})})},t.getUserAttributes=function(e){if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return e(new Error("User is not authenticated"),null);this.client.request("GetUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(r,n){if(r)return e(r,null);for(var s=[],o=0;o<n.UserAttributes.length;o++){var a={Name:n.UserAttributes[o].Name,Value:n.UserAttributes[o].Value},u=new An(a);s.push(u)}return e(null,s)})},t.getMFAOptions=function(e){if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return e(new Error("User is not authenticated"),null);this.client.request("GetUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(r,n){return r?e(r,null):e(null,n.MFAOptions)})},t.createGetUserRequest=function(){return this.client.promisifyRequest("GetUser",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()})},t.refreshSessionIfPossible=function(e){var r=this;return e===void 0&&(e={}),new Promise(function(n){var s=r.signInUserSession.getRefreshToken();s&&s.getToken()?r.refreshSession(s,n,e.clientMetadata):n()})},t.getUserData=function(e,r){var n=this;if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return this.clearCachedUserData(),e(new Error("User is not authenticated"),null);var s=this.getUserDataFromCache();if(!s){this.fetchUserData().then(function(o){e(null,o)}).catch(e);return}if(this.isFetchUserDataAndTokenRequired(r)){this.fetchUserData().then(function(o){return n.refreshSessionIfPossible(r).then(function(){return o})}).then(function(o){return e(null,o)}).catch(e);return}try{e(null,JSON.parse(s));return}catch(o){this.clearCachedUserData(),e(o,null);return}},t.getUserDataFromCache=function(){var e=this.storage.getItem(this.userDataKey);return e},t.isFetchUserDataAndTokenRequired=function(e){var r=e||{},n=r.bypassCache,s=n===void 0?!1:n;return s},t.fetchUserData=function(){var e=this;return this.createGetUserRequest().then(function(r){return e.cacheUserData(r),r})},t.deleteAttributes=function(e,r){var n=this;if(!(this.signInUserSession!=null&&this.signInUserSession.isValid()))return r(new Error("User is not authenticated"),null);this.client.request("DeleteUserAttributes",{UserAttributeNames:e,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(s){return s?r(s,null):n.getUserData(function(){return r(null,"SUCCESS")},{bypassCache:!0})})},t.resendConfirmationCode=function(e,r){var n={ClientId:this.pool.getClientId(),Username:this.username,ClientMetadata:r};this.client.request("ResendConfirmationCode",n,function(s,o){return s?e(s,null):e(null,o)})},t.getSession=function(e,r){if(r===void 0&&(r={}),this.username==null)return e(new Error("Username is null. Cannot retrieve a new session"),null);if(this.signInUserSession!=null&&this.signInUserSession.isValid())return e(null,this.signInUserSession);var n="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,s=n+".idToken",o=n+".accessToken",a=n+".refreshToken",u=n+".clockDrift";if(this.storage.getItem(s)){var c=new Pe({IdToken:this.storage.getItem(s)}),h=new _e({AccessToken:this.storage.getItem(o)}),l=new ke({RefreshToken:this.storage.getItem(a)}),f=parseInt(this.storage.getItem(u),0)||0,g={IdToken:c,AccessToken:h,RefreshToken:l,ClockDrift:f},v=new Fe(g);if(v.isValid())return this.signInUserSession=v,e(null,this.signInUserSession);if(!l.getToken())return e(new Error("Cannot retrieve a new session. Please authenticate."),null);this.refreshSession(l,e,r.clientMetadata)}else e(new Error("Local storage is missing an ID Token, Please authenticate"),null)},t.refreshSession=function(e,r,n){var s=this,o=this.pool.wrapRefreshSessionCallback?this.pool.wrapRefreshSessionCallback(r):r,a={};a.REFRESH_TOKEN=e.getToken();var u="CognitoIdentityServiceProvider."+this.pool.getClientId(),c=u+".LastAuthUser";if(this.storage.getItem(c)){this.username=this.storage.getItem(c);var h=u+"."+this.username+".deviceKey";this.deviceKey=this.storage.getItem(h),a.DEVICE_KEY=this.deviceKey}var l={ClientId:this.pool.getClientId(),AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:a,ClientMetadata:n};this.getUserContextData()&&(l.UserContextData=this.getUserContextData()),this.client.request("InitiateAuth",l,function(f,g){if(f)return f.code==="NotAuthorizedException"&&s.clearCachedUser(),o(f,null);if(g){var v=g.AuthenticationResult;return Object.prototype.hasOwnProperty.call(v,"RefreshToken")||(v.RefreshToken=e.getToken()),s.signInUserSession=s.getCognitoUserSession(v),s.cacheTokens(),o(null,s.signInUserSession)}})},t.cacheTokens=function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId(),r=e+"."+this.username+".idToken",n=e+"."+this.username+".accessToken",s=e+"."+this.username+".refreshToken",o=e+"."+this.username+".clockDrift",a=e+".LastAuthUser";this.storage.setItem(r,this.signInUserSession.getIdToken().getJwtToken()),this.storage.setItem(n,this.signInUserSession.getAccessToken().getJwtToken()),this.storage.setItem(s,this.signInUserSession.getRefreshToken().getToken()),this.storage.setItem(o,""+this.signInUserSession.getClockDrift()),this.storage.setItem(a,this.username)},t.cacheUserData=function(e){this.storage.setItem(this.userDataKey,JSON.stringify(e))},t.clearCachedUserData=function(){this.storage.removeItem(this.userDataKey)},t.clearCachedUser=function(){this.clearCachedTokens(),this.clearCachedUserData()},t.cacheDeviceKeyAndPassword=function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,r=e+".deviceKey",n=e+".randomPasswordKey",s=e+".deviceGroupKey";this.storage.setItem(r,this.deviceKey),this.storage.setItem(n,this.randomPassword),this.storage.setItem(s,this.deviceGroupKey)},t.getCachedDeviceKeyAndPassword=function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,r=e+".deviceKey",n=e+".randomPasswordKey",s=e+".deviceGroupKey";this.storage.getItem(r)&&(this.deviceKey=this.storage.getItem(r),this.randomPassword=this.storage.getItem(n),this.deviceGroupKey=this.storage.getItem(s))},t.clearCachedDeviceKeyAndPassword=function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId()+"."+this.username,r=e+".deviceKey",n=e+".randomPasswordKey",s=e+".deviceGroupKey";this.storage.removeItem(r),this.storage.removeItem(n),this.storage.removeItem(s)},t.clearCachedTokens=function(){var e="CognitoIdentityServiceProvider."+this.pool.getClientId(),r=e+"."+this.username+".idToken",n=e+"."+this.username+".accessToken",s=e+"."+this.username+".refreshToken",o=e+".LastAuthUser",a=e+"."+this.username+".clockDrift";this.storage.removeItem(r),this.storage.removeItem(n),this.storage.removeItem(s),this.storage.removeItem(o),this.storage.removeItem(a)},t.getCognitoUserSession=function(e){var r=new Pe(e),n=new _e(e),s=new ke(e),o={IdToken:r,AccessToken:n,RefreshToken:s};return new Fe(o)},t.forgotPassword=function(e,r){var n={ClientId:this.pool.getClientId(),Username:this.username,ClientMetadata:r};this.getUserContextData()&&(n.UserContextData=this.getUserContextData()),this.client.request("ForgotPassword",n,function(s,o){return s?e.onFailure(s):typeof e.inputVerificationCode=="function"?e.inputVerificationCode(o):e.onSuccess(o)})},t.confirmPassword=function(e,r,n,s){var o={ClientId:this.pool.getClientId(),Username:this.username,ConfirmationCode:e,Password:r,ClientMetadata:s};this.getUserContextData()&&(o.UserContextData=this.getUserContextData()),this.client.request("ConfirmForgotPassword",o,function(a){return a?n.onFailure(a):n.onSuccess("SUCCESS")})},t.getAttributeVerificationCode=function(e,r,n){if(this.signInUserSession==null||!this.signInUserSession.isValid())return r.onFailure(new Error("User is not authenticated"));this.client.request("GetUserAttributeVerificationCode",{AttributeName:e,AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),ClientMetadata:n},function(s,o){return s?r.onFailure(s):typeof r.inputVerificationCode=="function"?r.inputVerificationCode(o):r.onSuccess("SUCCESS")})},t.verifyAttribute=function(e,r,n){if(this.signInUserSession==null||!this.signInUserSession.isValid())return n.onFailure(new Error("User is not authenticated"));this.client.request("VerifyUserAttribute",{AttributeName:e,Code:r,AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(s){return s?n.onFailure(s):n.onSuccess("SUCCESS")})},t.getDevice=function(e){if(this.signInUserSession==null||!this.signInUserSession.isValid())return e.onFailure(new Error("User is not authenticated"));this.client.request("GetDevice",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey},function(r,n){return r?e.onFailure(r):e.onSuccess(n)})},t.forgetSpecificDevice=function(e,r){if(this.signInUserSession==null||!this.signInUserSession.isValid())return r.onFailure(new Error("User is not authenticated"));this.client.request("ForgetDevice",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:e},function(n){return n?r.onFailure(n):r.onSuccess("SUCCESS")})},t.forgetDevice=function(e){var r=this;this.forgetSpecificDevice(this.deviceKey,{onFailure:e.onFailure,onSuccess:function(n){return r.deviceKey=null,r.deviceGroupKey=null,r.randomPassword=null,r.clearCachedDeviceKeyAndPassword(),e.onSuccess(n)}})},t.setDeviceStatusRemembered=function(e){if(this.signInUserSession==null||!this.signInUserSession.isValid())return e.onFailure(new Error("User is not authenticated"));this.client.request("UpdateDeviceStatus",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey,DeviceRememberedStatus:"remembered"},function(r){return r?e.onFailure(r):e.onSuccess("SUCCESS")})},t.setDeviceStatusNotRemembered=function(e){if(this.signInUserSession==null||!this.signInUserSession.isValid())return e.onFailure(new Error("User is not authenticated"));this.client.request("UpdateDeviceStatus",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),DeviceKey:this.deviceKey,DeviceRememberedStatus:"not_remembered"},function(r){return r?e.onFailure(r):e.onSuccess("SUCCESS")})},t.listDevices=function(e,r,n){if(this.signInUserSession==null||!this.signInUserSession.isValid())return n.onFailure(new Error("User is not authenticated"));var s={AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),Limit:e};r&&(s.PaginationToken=r),this.client.request("ListDevices",s,function(o,a){return o?n.onFailure(o):n.onSuccess(a)})},t.globalSignOut=function(e){var r=this;if(this.signInUserSession==null||!this.signInUserSession.isValid())return e.onFailure(new Error("User is not authenticated"));this.client.request("GlobalSignOut",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(n){return n?e.onFailure(n):(r.clearCachedUser(),e.onSuccess("SUCCESS"))})},t.signOut=function(e){var r=this;if(!e||typeof e!="function"){this.cleanClientData();return}this.getSession(function(n,s){if(n)return e(n);r.revokeTokens(function(o){r.cleanClientData(),e(o)})})},t.revokeTokens=function(e){if(e===void 0&&(e=function(){}),typeof e!="function")throw new Error("Invalid revokeTokenCallback. It should be a function.");if(!this.signInUserSession){var r=new Error("User is not authenticated");return e(r)}if(!this.signInUserSession.getAccessToken()){var n=new Error("No Access token available");return e(n)}var s=this.signInUserSession.getRefreshToken().getToken(),o=this.signInUserSession.getAccessToken();if(this.isSessionRevocable(o)&&s)return this.revokeToken({token:s,callback:e});e()},t.isSessionRevocable=function(e){if(e&&typeof e.decodePayload=="function")try{var r=e.decodePayload(),n=r.origin_jti;return!!n}catch{}return!1},t.cleanClientData=function(){this.signInUserSession=null,this.clearCachedUser()},t.revokeToken=function(e){var r=e.token,n=e.callback;this.client.requestWithRetry("RevokeToken",{Token:r,ClientId:this.pool.getClientId()},function(s){if(s)return n(s);n()})},t.sendMFASelectionAnswer=function(e,r){var n=this,s={};s.USERNAME=this.username,s.ANSWER=e;var o={ChallengeName:"SELECT_MFA_TYPE",ChallengeResponses:s,ClientId:this.pool.getClientId(),Session:this.Session};this.getUserContextData()&&(o.UserContextData=this.getUserContextData()),this.client.request("RespondToAuthChallenge",o,function(a,u){if(a)return r.onFailure(a);if(n.Session=u.Session,e==="SMS_MFA")return r.mfaRequired(u.ChallengeName,u.ChallengeParameters);if(e==="SOFTWARE_TOKEN_MFA")return r.totpRequired(u.ChallengeName,u.ChallengeParameters)})},t.getUserContextData=function(){var e=this.pool;return e.getUserContextData(this.username)},t.associateSoftwareToken=function(e){var r=this;this.signInUserSession!=null&&this.signInUserSession.isValid()?this.client.request("AssociateSoftwareToken",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken()},function(n,s){return n?e.onFailure(n):e.associateSecretCode(s.SecretCode)}):this.client.request("AssociateSoftwareToken",{Session:this.Session},function(n,s){return n?e.onFailure(n):(r.Session=s.Session,e.associateSecretCode(s.SecretCode))})},t.verifySoftwareToken=function(e,r,n){var s=this;this.signInUserSession!=null&&this.signInUserSession.isValid()?this.client.request("VerifySoftwareToken",{AccessToken:this.signInUserSession.getAccessToken().getJwtToken(),UserCode:e,FriendlyDeviceName:r},function(o,a){return o?n.onFailure(o):n.onSuccess(a)}):this.client.request("VerifySoftwareToken",{Session:this.Session,UserCode:e,FriendlyDeviceName:r},function(o,a){if(o)return n.onFailure(o);s.Session=a.Session;var u={};u.USERNAME=s.username;var c={ChallengeName:"MFA_SETUP",ClientId:s.pool.getClientId(),ChallengeResponses:u,Session:s.Session};s.getUserContextData()&&(c.UserContextData=s.getUserContextData()),s.client.request("RespondToAuthChallenge",c,function(h,l){return h?n.onFailure(h):(s.signInUserSession=s.getCognitoUserSession(l.AuthenticationResult),s.cacheTokens(),n.onSuccess(s.signInUserSession))})})},i}();function En(i,t){return t=t||{},new Promise(function(e,r){var n=new XMLHttpRequest,s=[],o=[],a={},u=function(){return{ok:(n.status/100|0)==2,statusText:n.statusText,status:n.status,url:n.responseURL,text:function(){return Promise.resolve(n.responseText)},json:function(){return Promise.resolve(n.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([n.response]))},clone:u,headers:{keys:function(){return s},entries:function(){return o},get:function(h){return a[h.toLowerCase()]},has:function(h){return h.toLowerCase()in a}}}};for(var c in n.open(t.method||"get",i,!0),n.onload=function(){n.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(h,l,f){s.push(l=l.toLowerCase()),o.push([l,f]),a[l]=a[l]?a[l]+","+f:f}),e(u())},n.onerror=r,n.withCredentials=t.credentials=="include",t.headers)n.setRequestHeader(c,t.headers[c]);n.send(t.body||null)})}const In=Object.freeze(Object.defineProperty({__proto__:null,default:En},Symbol.toStringTag,{value:"Module"})),xe=ie(In);self.fetch||(self.fetch=xe.default||xe);function O(){}O.prototype.userAgent=Cn();var bn=function(i){var t=O.category?" "+O.category:"",e=O.framework?" framework/"+O.framework:"",r=""+O.prototype.userAgent+t+e;return r};function _n(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,N(i,t)}function me(i){var t=typeof Map=="function"?new Map:void 0;return me=function(e){if(e===null||!kn(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return ee(e,arguments,ye(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),N(r,e)},me(i)}function ee(i,t,e){return Pn()?ee=Reflect.construct.bind():ee=function(r,n,s){var o=[null];o.push.apply(o,n);var a=Function.bind.apply(r,o),u=new a;return s&&N(u,s.prototype),u},ee.apply(null,arguments)}function Pn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kn(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}function N(i,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},N(i,t)}function ye(i){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ye(i)}var Rn=function(i){_n(t,i);function t(e,r,n,s){var o;return o=i.call(this,e)||this,o.code=r,o.name=n,o.statusCode=s,o}return t}(me(Error)),Fn=function(){function i(e,r,n){this.endpoint=r||"https://cognito-idp."+e+".amazonaws.com/";var s=n||{},o=s.credentials;this.fetchOptions=o?{credentials:o}:{}}var t=i.prototype;return t.promisifyRequest=function(e,r){var n=this;return new Promise(function(s,o){n.request(e,r,function(a,u){a?o(new Rn(a.message,a.code,a.name,a.statusCode)):s(u)})})},t.requestWithRetry=function(e,r,n){var s=this,o=5*1e3;xn(function(a){return new Promise(function(u,c){s.request(e,a,function(h,l){h?c(h):u(l)})})},[r],o).then(function(a){return n(null,a)}).catch(function(a){return n(a)})},t.request=function(e,r,n){var s={"Content-Type":"application/x-amz-json-1.1","X-Amz-Target":"AWSCognitoIdentityProviderService."+e,"X-Amz-User-Agent":bn(),"Cache-Control":"no-store"},o=Object.assign({},this.fetchOptions,{headers:s,method:"POST",mode:"cors",body:JSON.stringify(r)}),a;fetch(this.endpoint,o).then(function(u){return a=u,u},function(u){throw u instanceof TypeError?new Error("Network error"):u}).then(function(u){return u.json().catch(function(){return{}})}).then(function(u){if(a.ok)return n(null,u);var c=(u.__type||u.code).split("#").pop(),h=new Error(u.message||u.Message||null);return h.name=c,h.code=c,n(h)}).catch(function(u){if(a&&a.headers&&a.headers.get("x-amzn-errortype"))try{var c=a.headers.get("x-amzn-errortype").split(":")[0],h=new Error(a.status?a.status.toString():null);return h.code=c,h.name=c,h.statusCode=a.status,n(h)}catch{return n(u)}else u instanceof Error&&u.message==="Network error"&&(u.code="NetworkError");return n(u)})},i}(),te={debug:function(){}},On=function(i){var t="nonRetryable";return i&&i[t]};function Be(i,t,e,r){if(r===void 0&&(r=1),typeof i!="function")throw Error("functionToRetry must be a function");return te.debug(i.name+" attempt #"+r+" with args: "+JSON.stringify(t)),i.apply(void 0,t).catch(function(n){if(te.debug("error on "+i.name,n),On(n))throw te.debug(i.name+" non retryable error",n),n;var s=e(r,t,n);if(te.debug(i.name+" retrying in "+s+" ms"),s!==!1)return new Promise(function(o){return setTimeout(o,s)}).then(function(){return Be(i,t,e,r+1)});throw n})}function Mn(i){var t=100,e=100;return function(r){var n=Math.pow(2,r)*t+e*Math.random();return n>i?!1:n}}var Nn=5*60*1e3;function xn(i,t,e){return e===void 0&&(e=Nn),Be(i,t,Mn(e))}/*!
* Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
* SPDX-License-Identifier: Apache-2.0
*/var Bn=55,Kn=function(){function i(e,r){var n=e||{},s=n.UserPoolId,o=n.ClientId,a=n.endpoint,u=n.fetchOptions,c=n.AdvancedSecurityDataCollectionFlag;if(!s||!o)throw new Error("Both UserPoolId and ClientId are required.");if(s.length>Bn||!/^[\w-]+_[0-9a-zA-Z]+$/.test(s))throw new Error("Invalid UserPoolId format.");var h=s.split("_")[0];this.userPoolId=s,this.clientId=o,this.client=new Fn(h,a,u),this.advancedSecurityDataCollectionFlag=c!==!1,this.storage=e.Storage||new Me().getStorage(),r&&(this.wrapRefreshSessionCallback=r)}var t=i.prototype;return t.getUserPoolId=function(){return this.userPoolId},t.getUserPoolName=function(){return this.getUserPoolId().split("_")[1]},t.getClientId=function(){return this.clientId},t.signUp=function(e,r,n,s,o,a){var u=this,c={ClientId:this.clientId,Username:e,Password:r,UserAttributes:n,ValidationData:s,ClientMetadata:a};this.getUserContextData(e)&&(c.UserContextData=this.getUserContextData(e)),this.client.request("SignUp",c,function(h,l){if(h)return o(h,null);var f={Username:e,Pool:u,Storage:u.storage},g={user:new Se(f),userConfirmed:l.UserConfirmed,userSub:l.UserSub,codeDeliveryDetails:l.CodeDeliveryDetails};return o(null,g)})},t.getCurrentUser=function(){var e="CognitoIdentityServiceProvider."+this.clientId+".LastAuthUser",r=this.storage.getItem(e);if(r){var n={Username:r,Pool:this,Storage:this.storage};return new Se(n)}return null},t.getUserContextData=function(e){if(!(typeof AmazonCognitoAdvancedSecurityData>"u")){var r=AmazonCognitoAdvancedSecurityData;if(this.advancedSecurityDataCollectionFlag){var n=r.getData(e,this.userPoolId,this.clientId);if(n){var s={EncodedData:n};return s}}return{}}},i}(),Vn={exports:{}};/*!
* JavaScript Cookie v2.2.1
* https://github.com/js-cookie/js-cookie
*
* Copyright 2006, 2015 Klaus Hartl & Fagner Brack
* Released under the MIT license
*/(function(i,t){(function(e){var r;if(i.exports=e(),r=!0,!r){var n=window.Cookies,s=window.Cookies=e();s.noConflict=function(){return window.Cookies=n,s}}})(function(){function e(){for(var s=0,o={};s<arguments.length;s++){var a=arguments[s];for(var u in a)o[u]=a[u]}return o}function r(s){return s.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function n(s){function o(){}function a(c,h,l){if(!(typeof document>"u")){l=e({path:"/"},o.defaults,l),typeof l.expires=="number"&&(l.expires=new Date(new Date*1+l.expires*864e5)),l.expires=l.expires?l.expires.toUTCString():"";try{var f=JSON.stringify(h);/^[\{\[]/.test(f)&&(h=f)}catch{}h=s.write?s.write(h,c):encodeURIComponent(String(h)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),c=encodeURIComponent(String(c)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var g="";for(var v in l)l[v]&&(g+="; "+v,l[v]!==!0&&(g+="="+l[v].split(";")[0]));return document.cookie=c+"="+h+g}}function u(c,h){if(!(typeof document>"u")){for(var l={},f=document.cookie?document.cookie.split("; "):[],g=0;g<f.length;g++){var v=f[g].split("="),p=v.slice(1).join("=");!h&&p.charAt(0)==='"'&&(p=p.slice(1,-1));try{var S=r(v[0]);if(p=(s.read||s)(p,S)||r(p),h)try{p=JSON.parse(p)}catch{}if(l[S]=p,c===S)break}catch{}}return c?l[c]:l}}return o.set=a,o.get=function(c){return u(c,!1)},o.getJSON=function(c){return u(c,!0)},o.remove=function(c,h){a(c,"",e(h,{expires:-1}))},o.defaults={},o.withConverter=n,o}return n(function(){})})})(Vn);var Ke={appEnv:"development",sentryDsn:"",connectClientId:"5g5gmhc2r11df5vqoavvdvef5",connectOAuthUrl:"https://connect.dev.paas.reapit.cloud",connectUserPoolId:"eu-west-2_kiftR4qFc",chatbotAppId:"d0f4d712-c12a-4cdf-72a1-7e9795bc061a",marketplaceUrl:"https://marketplace.dev.paas.reapit.cloud/apps",platformApiUrl:"https://platform.dev.paas.reapit.cloud",developerEditionDownloadUrl:"https://updates.reapit.net/install/setupdev.exe",adobeSignApiKey:"CBFCIBAA3AAABLblqZhCDiTpm3mtYxQo6xlPEpdTIPMUeWo1RPWyJnzmq9hUu_O9-a96bDc8nX8bBYL8pztU",liveChatWhitelist:["421b65bc-dd09-4c34-90fa-dacc3cd2ff5a"],elementsUri:"https://elements.dev.paas.reapit.cloud/?path=/docs/welcome--docs",graphQLUri:"https://graphql.dev.paas.reapit.cloud/graphql",analyticsSchemaDocsUrl:"https://reapit-analytics-schema.dev.paas.reapit.cloud",swaggerUri:"https://reapit-swagger-dev.s3.eu-west-2.amazonaws.com/foundations_swagger.json",DEPLOYMENT_SERVICE_HOST:"https://deployments.dev.paas.reapit.cloud/",PUSHER_KEY:"c48c04b607a9201f6054",zendeskUri:"https://static.zdassets.com/ekr/snippet.js?key=e8ed8416-ceb4-4e91-8186-097321c3ceda",pipelineWhitelist:["421b65bc-dd09-4c34-90fa-dacc3cd2ff5a"],swaggerWhitelist:["421b65bc-dd09-4c34-90fa-dacc3cd2ff5a"]};const Ve=(i,t,e)=>{const r={UserPoolId:e||Ke.connectUserPoolId,ClientId:t},n=new Kn(r),s={Username:i,Pool:n};return new Se(s)},qn=async({password:i,userName:t,newPassword:e})=>new Promise((r,n)=>{const s={Username:t,Password:i},o=new Le(s),a=Ve(t,Ke.connectClientId);a.authenticateUser(o,{onSuccess:()=>{a.changePassword(i,e,u=>{u&&(J(new Error(u.message)),n(u)),r(!0)})},onFailure:u=>{J(new Error(u.message)),r(!1)}})}),Ln=async({verificationCode:i,userName:t,connectClientId:e})=>new Promise((r,n)=>{Ve(t,e).confirmRegistration(i,!0,s=>{s&&(J(new Error(s.message)),n(`Bad request, confirm registration service failed ${JSON.stringify(s)}`)),r("SUCCESS")})}),jn=async i=>{const{verificationCode:t,userName:e,connectClientId:r}=i,n=t&&e&&r;try{if(!n)throw new Error("Bad request, verification code and username are required");return await Ln(i)}catch(s){J(s),console.error(`Bad request, failed to confirm registration, ${s}`)}};export{qn as a,jn as c};
