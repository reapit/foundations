"use strict";var _o=Object.create;var Ae=Object.defineProperty;var Fo=Object.getOwnPropertyDescriptor;var Uo=Object.getOwnPropertyNames;var Vo=Object.getPrototypeOf,Go=Object.prototype.hasOwnProperty;var s=(e,r)=>Ae(e,"name",{value:r,configurable:!0});var p=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Ko=(e,r)=>{for(var t in r)Ae(e,t,{get:r[t],enumerable:!0})},jt=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of Uo(r))!Go.call(e,i)&&i!==t&&Ae(e,i,{get:()=>r[i],enumerable:!(n=Fo(r,i))||n.enumerable});return e};var Wo=(e,r,t)=>(t=e!=null?_o(Vo(e)):{},jt(r||!e||!e.__esModule?Ae(t,"default",{value:e,enumerable:!0}):t,e)),Ho=e=>jt(Ae({},"__esModule",{value:!0}),e);var ue=p((_r,Ct)=>{"use strict";var ze=require("buffer"),B=ze.Buffer;function Pt(e,r){for(var t in e)r[t]=e[t]}s(Pt,"copyProps");B.from&&B.alloc&&B.allocUnsafe&&B.allocUnsafeSlow?Ct.exports=ze:(Pt(ze,_r),_r.Buffer=Z);function Z(e,r,t){return B(e,r,t)}s(Z,"SafeBuffer");Z.prototype=Object.create(B.prototype);Pt(B,Z);Z.from=function(e,r,t){if(typeof e=="number")throw new TypeError("Argument must not be a number");return B(e,r,t)};Z.alloc=function(e,r,t){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=B(e);return r!==void 0?typeof t=="string"?n.fill(r,t):n.fill(r):n.fill(0),n};Z.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return B(e)};Z.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return ze.SlowBuffer(e)}});var Fr=p((Ip,Jt)=>{"use strict";var Ye=ue().Buffer,Mo=require("stream"),Xo=require("util");function Ze(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=Ye.alloc(0),this;if(typeof e.pipe=="function")return this.buffer=Ye.alloc(0),e.pipe(this),this;if(e.length||typeof e=="object")return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}s(Ze,"DataStream");Xo.inherits(Ze,Mo);Ze.prototype.write=s(function(r){this.buffer=Ye.concat([this.buffer,Ye.from(r)]),this.emit("data",r)},"write");Ze.prototype.end=s(function(r){r&&this.write(r),this.emit("end",r),this.emit("close"),this.writable=!1,this.readable=!1},"end");Jt.exports=Ze});var Bt=p((Rp,kt)=>{"use strict";var Te=require("buffer").Buffer,Ur=require("buffer").SlowBuffer;kt.exports=Qe;function Qe(e,r){if(!Te.isBuffer(e)||!Te.isBuffer(r)||e.length!==r.length)return!1;for(var t=0,n=0;n<e.length;n++)t|=e[n]^r[n];return t===0}s(Qe,"bufferEq");Qe.install=function(){Te.prototype.equal=Ur.prototype.equal=s(function(r){return Qe(this,r)},"equal")};var zo=Te.prototype.equal,Yo=Ur.prototype.equal;Qe.restore=function(){Te.prototype.equal=zo,Ur.prototype.equal=Yo}});var _t=p((Tp,Dt)=>{"use strict";function Vr(e){var r=(e/8|0)+(e%8===0?0:1);return r}s(Vr,"getParamSize");var Zo={ES256:Vr(256),ES384:Vr(384),ES512:Vr(521)};function Qo(e){var r=Zo[e];if(r)return r;throw new Error('Unknown algorithm "'+e+'"')}s(Qo,"getParamBytesForAlg");Dt.exports=Qo});var Ht=p((Op,Wt)=>{"use strict";var er=ue().Buffer,Ut=_t(),rr=128,Vt=0,ea=32,ra=16,ta=2,Gt=ra|ea|Vt<<6,tr=ta|Vt<<6;function na(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}s(na,"base64Url");function Kt(e){if(er.isBuffer(e))return e;if(typeof e=="string")return er.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}s(Kt,"signatureAsBuffer");function ia(e,r){e=Kt(e);var t=Ut(r),n=t+1,i=e.length,o=0;if(e[o++]!==Gt)throw new Error('Could not find expected "seq"');var a=e[o++];if(a===(rr|1)&&(a=e[o++]),i-o<a)throw new Error('"seq" specified length of "'+a+'", only "'+(i-o)+'" remaining');if(e[o++]!==tr)throw new Error('Could not find expected "int" for "r"');var c=e[o++];if(i-o-2<c)throw new Error('"r" specified length of "'+c+'", only "'+(i-o-2)+'" available');if(n<c)throw new Error('"r" specified length of "'+c+'", max of "'+n+'" is acceptable');var f=o;if(o+=c,e[o++]!==tr)throw new Error('Could not find expected "int" for "s"');var u=e[o++];if(i-o!==u)throw new Error('"s" specified length of "'+u+'", expected "'+(i-o)+'"');if(n<u)throw new Error('"s" specified length of "'+u+'", max of "'+n+'" is acceptable');var h=o;if(o+=u,o!==i)throw new Error('Expected to consume entire buffer, but "'+(i-o)+'" bytes remain');var l=t-c,w=t-u,y=er.allocUnsafe(l+c+w+u);for(o=0;o<l;++o)y[o]=0;e.copy(y,o,f+Math.max(-l,0),f+c),o=t;for(var b=o;o<b+w;++o)y[o]=0;return e.copy(y,o,h+Math.max(-w,0),h+u),y=y.toString("base64"),y=na(y),y}s(ia,"derToJose");function Ft(e,r,t){for(var n=0;r+n<t&&e[r+n]===0;)++n;var i=e[r+n]>=rr;return i&&--n,n}s(Ft,"countPadding");function sa(e,r){e=Kt(e);var t=Ut(r),n=e.length;if(n!==t*2)throw new TypeError('"'+r+'" signatures must be "'+t*2+'" bytes, saw "'+n+'"');var i=Ft(e,0,t),o=Ft(e,t,e.length),a=t-i,c=t-o,f=2+a+1+1+c,u=f<rr,h=er.allocUnsafe((u?2:3)+f),l=0;return h[l++]=Gt,u?h[l++]=f:(h[l++]=rr|1,h[l++]=f&255),h[l++]=tr,h[l++]=a,i<0?(h[l++]=0,l+=e.copy(h,l,0,t)):l+=e.copy(h,l,i,t),h[l++]=tr,h[l++]=c,o<0?(h[l++]=0,e.copy(h,l,t)):e.copy(h,l,t+o),h}s(sa,"joseToDer");Wt.exports={derToJose:ia,joseToDer:sa}});var Wr=p((Lp,tn)=>{"use strict";var oa=Bt(),le=ue().Buffer,D=require("crypto"),Xt=Ht(),Mt=require("util"),aa=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,$e="secret must be a string or buffer",fe="key must be a string or a buffer",ca="key must be a string, a buffer or an object",Gr=typeof D.createPublicKey=="function";Gr&&(fe+=" or a KeyObject",$e+="or a KeyObject");function zt(e){if(!le.isBuffer(e)&&typeof e!="string"&&(!Gr||typeof e!="object"||typeof e.type!="string"||typeof e.asymmetricKeyType!="string"||typeof e.export!="function"))throw J(fe)}s(zt,"checkIsPublicKey");function Yt(e){if(!le.isBuffer(e)&&typeof e!="string"&&typeof e!="object")throw J(ca)}s(Yt,"checkIsPrivateKey");function ua(e){if(!le.isBuffer(e)){if(typeof e=="string")return e;if(!Gr||typeof e!="object"||e.type!=="secret"||typeof e.export!="function")throw J($e)}}s(ua,"checkIsSecretKey");function Kr(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}s(Kr,"fromBase64");function Zt(e){e=e.toString();var r=4-e.length%4;if(r!==4)for(var t=0;t<r;++t)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}s(Zt,"toBase64");function J(e){var r=[].slice.call(arguments,1),t=Mt.format.bind(Mt,e).apply(null,r);return new TypeError(t)}s(J,"typeError");function fa(e){return le.isBuffer(e)||typeof e=="string"}s(fa,"bufferOrString");function Oe(e){return fa(e)||(e=JSON.stringify(e)),e}s(Oe,"normalizeInput");function Qt(e){return s(function(t,n){ua(n),t=Oe(t);var i=D.createHmac("sha"+e,n),o=(i.update(t),i.digest("base64"));return Kr(o)},"sign")}s(Qt,"createHmacSigner");function la(e){return s(function(t,n,i){var o=Qt(e)(t,i);return oa(le.from(n),le.from(o))},"verify")}s(la,"createHmacVerifier");function en(e){return s(function(t,n){Yt(n),t=Oe(t);var i=D.createSign("RSA-SHA"+e),o=(i.update(t),i.sign(n,"base64"));return Kr(o)},"sign")}s(en,"createKeySigner");function rn(e){return s(function(t,n,i){zt(i),t=Oe(t),n=Zt(n);var o=D.createVerify("RSA-SHA"+e);return o.update(t),o.verify(i,n,"base64")},"verify")}s(rn,"createKeyVerifier");function ha(e){return s(function(t,n){Yt(n),t=Oe(t);var i=D.createSign("RSA-SHA"+e),o=(i.update(t),i.sign({key:n,padding:D.constants.RSA_PKCS1_PSS_PADDING,saltLength:D.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return Kr(o)},"sign")}s(ha,"createPSSKeySigner");function pa(e){return s(function(t,n,i){zt(i),t=Oe(t),n=Zt(n);var o=D.createVerify("RSA-SHA"+e);return o.update(t),o.verify({key:i,padding:D.constants.RSA_PKCS1_PSS_PADDING,saltLength:D.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")},"verify")}s(pa,"createPSSKeyVerifier");function da(e){var r=en(e);return s(function(){var n=r.apply(null,arguments);return n=Xt.derToJose(n,"ES"+e),n},"sign")}s(da,"createECDSASigner");function ma(e){var r=rn(e);return s(function(n,i,o){i=Xt.joseToDer(i,"ES"+e).toString("base64");var a=r(n,i,o);return a},"verify")}s(ma,"createECDSAVerifer");function ya(){return s(function(){return""},"sign")}s(ya,"createNoneSigner");function ga(){return s(function(r,t){return t===""},"verify")}s(ga,"createNoneVerifier");tn.exports=s(function(r){var t={hs:Qt,rs:en,ps:ha,es:da,none:ya},n={hs:la,rs:rn,ps:pa,es:ma,none:ga},i=r.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!i)throw J(aa,r);var o=(i[1]||i[3]).toLowerCase(),a=i[2];return{sign:t[o](a),verify:n[o](a)}},"jwa")});var Hr=p((jp,nn)=>{"use strict";var wa=require("buffer").Buffer;nn.exports=s(function(r){return typeof r=="string"?r:typeof r=="number"||wa.isBuffer(r)?r.toString():JSON.stringify(r)},"toString")});var fn=p((Cp,un)=>{"use strict";var Ea=ue().Buffer,sn=Fr(),Sa=Wr(),va=require("stream"),on=Hr(),Mr=require("util");function an(e,r){return Ea.from(e,r).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}s(an,"base64url");function ba(e,r,t){t=t||"utf8";var n=an(on(e),"binary"),i=an(on(r),t);return Mr.format("%s.%s",n,i)}s(ba,"jwsSecuredInput");function cn(e){var r=e.header,t=e.payload,n=e.secret||e.privateKey,i=e.encoding,o=Sa(r.alg),a=ba(r,t,i),c=o.sign(a,n);return Mr.format("%s.%s",a,c)}s(cn,"jwsSign");function nr(e){var r=e.secret||e.privateKey||e.key,t=new sn(r);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=t,this.payload=new sn(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}s(nr,"SignStream");Mr.inherits(nr,va);nr.prototype.sign=s(function(){try{var r=cn({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",r),this.emit("data",r),this.emit("end"),this.readable=!1,r}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}},"sign");nr.sign=cn;un.exports=nr});var Sn=p((kp,En)=>{"use strict";var hn=ue().Buffer,ln=Fr(),Ia=Wr(),xa=require("stream"),pn=Hr(),Ra=require("util"),Aa=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function Ta(e){return Object.prototype.toString.call(e)==="[object Object]"}s(Ta,"isObject");function $a(e){if(Ta(e))return e;try{return JSON.parse(e)}catch{return}}s($a,"safeJsonParse");function dn(e){var r=e.split(".",1)[0];return $a(hn.from(r,"base64").toString("binary"))}s(dn,"headerFromJWS");function Oa(e){return e.split(".",2).join(".")}s(Oa,"securedInputFromJWS");function mn(e){return e.split(".")[2]}s(mn,"signatureFromJWS");function Na(e,r){r=r||"utf8";var t=e.split(".")[1];return hn.from(t,"base64").toString(r)}s(Na,"payloadFromJWS");function yn(e){return Aa.test(e)&&!!dn(e)}s(yn,"isValidJws");function gn(e,r,t){if(!r){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}e=pn(e);var i=mn(e),o=Oa(e),a=Ia(r);return a.verify(o,i,t)}s(gn,"jwsVerify");function wn(e,r){if(r=r||{},e=pn(e),!yn(e))return null;var t=dn(e);if(!t)return null;var n=Na(e);return(t.typ==="JWT"||r.json)&&(n=JSON.parse(n,r.encoding)),{header:t,payload:n,signature:mn(e)}}s(wn,"jwsDecode");function he(e){e=e||{};var r=e.secret||e.publicKey||e.key,t=new ln(r);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=t,this.signature=new ln(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}s(he,"VerifyStream");Ra.inherits(he,xa);he.prototype.verify=s(function(){try{var r=gn(this.signature.buffer,this.algorithm,this.key.buffer),t=wn(this.signature.buffer,this.encoding);return this.emit("done",r,t),this.emit("data",r),this.emit("end"),this.readable=!1,r}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}},"verify");he.decode=wn;he.isValid=yn;he.verify=gn;En.exports=he});var sr=p(X=>{"use strict";var vn=fn(),ir=Sn(),La=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];X.ALGORITHMS=La;X.sign=vn.sign;X.verify=ir.verify;X.decode=ir.decode;X.isValid=ir.isValid;X.createSign=s(function(r){return new vn(r)},"createSign");X.createVerify=s(function(r){return new ir(r)},"createVerify")});var Xr=p((Fp,bn)=>{"use strict";var qa=sr();bn.exports=function(e,r){r=r||{};var t=qa.decode(e,r);if(!t)return null;var n=t.payload;if(typeof n=="string")try{var i=JSON.parse(n);i!==null&&typeof i=="object"&&(n=i)}catch{}return r.complete===!0?{header:t.header,payload:n,signature:t.signature}:n}});var Ne=p((Up,In)=>{"use strict";var or=s(function(e,r){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,r&&(this.inner=r)},"JsonWebTokenError");or.prototype=Object.create(Error.prototype);or.prototype.constructor=or;In.exports=or});var zr=p((Gp,Rn)=>{"use strict";var xn=Ne(),ar=s(function(e,r){xn.call(this,e),this.name="NotBeforeError",this.date=r},"NotBeforeError");ar.prototype=Object.create(xn.prototype);ar.prototype.constructor=ar;Rn.exports=ar});var Yr=p((Wp,Tn)=>{"use strict";var An=Ne(),cr=s(function(e,r){An.call(this,e),this.name="TokenExpiredError",this.expiredAt=r},"TokenExpiredError");cr.prototype=Object.create(An.prototype);cr.prototype.constructor=cr;Tn.exports=cr});var On=p((Mp,$n)=>{"use strict";var pe=1e3,de=pe*60,me=de*60,Q=me*24,ja=Q*7,Pa=Q*365.25;$n.exports=function(e,r){r=r||{};var t=typeof e;if(t==="string"&&e.length>0)return Ca(e);if(t==="number"&&isFinite(e))return r.long?ka(e):Ja(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Ca(e){if(e=String(e),!(e.length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var t=parseFloat(r[1]),n=(r[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*Pa;case"weeks":case"week":case"w":return t*ja;case"days":case"day":case"d":return t*Q;case"hours":case"hour":case"hrs":case"hr":case"h":return t*me;case"minutes":case"minute":case"mins":case"min":case"m":return t*de;case"seconds":case"second":case"secs":case"sec":case"s":return t*pe;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}s(Ca,"parse");function Ja(e){var r=Math.abs(e);return r>=Q?Math.round(e/Q)+"d":r>=me?Math.round(e/me)+"h":r>=de?Math.round(e/de)+"m":r>=pe?Math.round(e/pe)+"s":e+"ms"}s(Ja,"fmtShort");function ka(e){var r=Math.abs(e);return r>=Q?ur(e,r,Q,"day"):r>=me?ur(e,r,me,"hour"):r>=de?ur(e,r,de,"minute"):r>=pe?ur(e,r,pe,"second"):e+" ms"}s(ka,"fmtLong");function ur(e,r,t,n){var i=r>=t*1.5;return Math.round(e/t)+" "+n+(i?"s":"")}s(ur,"plural")});var Zr=p((zp,Nn)=>{"use strict";var Ba=On();Nn.exports=function(e,r){var t=r||Math.floor(Date.now()/1e3);if(typeof e=="string"){var n=Ba(e);return typeof n>"u"?void 0:Math.floor(t+n/1e3)}else return typeof e=="number"?t+e:void 0}});var Le=p((Yp,Ln)=>{"use strict";var Da="2.0.0",_a=Number.MAX_SAFE_INTEGER||9007199254740991,Fa=16,Ua=250,Va=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Ln.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Fa,MAX_SAFE_BUILD_LENGTH:Ua,MAX_SAFE_INTEGER:_a,RELEASE_TYPES:Va,SEMVER_SPEC_VERSION:Da,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var qe=p((Zp,qn)=>{"use strict";var Ga=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};qn.exports=Ga});var ye=p((U,jn)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Qr,MAX_SAFE_BUILD_LENGTH:Ka,MAX_LENGTH:Wa}=Le(),Ha=qe();U=jn.exports={};var Ma=U.re=[],Xa=U.safeRe=[],d=U.src=[],m=U.t={},za=0,et="[a-zA-Z0-9-]",Ya=[["\\s",1],["\\d",Wa],[et,Ka]],Za=s(e=>{for(let[r,t]of Ya)e=e.split(`${r}*`).join(`${r}{0,${t}}`).split(`${r}+`).join(`${r}{1,${t}}`);return e},"makeSafeRegex"),g=s((e,r,t)=>{let n=Za(r),i=za++;Ha(e,i,r),m[e]=i,d[i]=r,Ma[i]=new RegExp(r,t?"g":void 0),Xa[i]=new RegExp(n,t?"g":void 0)},"createToken");g("NUMERICIDENTIFIER","0|[1-9]\\d*");g("NUMERICIDENTIFIERLOOSE","\\d+");g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${et}*`);g("MAINVERSION",`(${d[m.NUMERICIDENTIFIER]})\\.(${d[m.NUMERICIDENTIFIER]})\\.(${d[m.NUMERICIDENTIFIER]})`);g("MAINVERSIONLOOSE",`(${d[m.NUMERICIDENTIFIERLOOSE]})\\.(${d[m.NUMERICIDENTIFIERLOOSE]})\\.(${d[m.NUMERICIDENTIFIERLOOSE]})`);g("PRERELEASEIDENTIFIER",`(?:${d[m.NUMERICIDENTIFIER]}|${d[m.NONNUMERICIDENTIFIER]})`);g("PRERELEASEIDENTIFIERLOOSE",`(?:${d[m.NUMERICIDENTIFIERLOOSE]}|${d[m.NONNUMERICIDENTIFIER]})`);g("PRERELEASE",`(?:-(${d[m.PRERELEASEIDENTIFIER]}(?:\\.${d[m.PRERELEASEIDENTIFIER]})*))`);g("PRERELEASELOOSE",`(?:-?(${d[m.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${d[m.PRERELEASEIDENTIFIERLOOSE]})*))`);g("BUILDIDENTIFIER",`${et}+`);g("BUILD",`(?:\\+(${d[m.BUILDIDENTIFIER]}(?:\\.${d[m.BUILDIDENTIFIER]})*))`);g("FULLPLAIN",`v?${d[m.MAINVERSION]}${d[m.PRERELEASE]}?${d[m.BUILD]}?`);g("FULL",`^${d[m.FULLPLAIN]}$`);g("LOOSEPLAIN",`[v=\\s]*${d[m.MAINVERSIONLOOSE]}${d[m.PRERELEASELOOSE]}?${d[m.BUILD]}?`);g("LOOSE",`^${d[m.LOOSEPLAIN]}$`);g("GTLT","((?:<|>)?=?)");g("XRANGEIDENTIFIERLOOSE",`${d[m.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);g("XRANGEIDENTIFIER",`${d[m.NUMERICIDENTIFIER]}|x|X|\\*`);g("XRANGEPLAIN",`[v=\\s]*(${d[m.XRANGEIDENTIFIER]})(?:\\.(${d[m.XRANGEIDENTIFIER]})(?:\\.(${d[m.XRANGEIDENTIFIER]})(?:${d[m.PRERELEASE]})?${d[m.BUILD]}?)?)?`);g("XRANGEPLAINLOOSE",`[v=\\s]*(${d[m.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[m.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[m.XRANGEIDENTIFIERLOOSE]})(?:${d[m.PRERELEASELOOSE]})?${d[m.BUILD]}?)?)?`);g("XRANGE",`^${d[m.GTLT]}\\s*${d[m.XRANGEPLAIN]}$`);g("XRANGELOOSE",`^${d[m.GTLT]}\\s*${d[m.XRANGEPLAINLOOSE]}$`);g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Qr}})(?:\\.(\\d{1,${Qr}}))?(?:\\.(\\d{1,${Qr}}))?`);g("COERCE",`${d[m.COERCEPLAIN]}(?:$|[^\\d])`);g("COERCEFULL",d[m.COERCEPLAIN]+`(?:${d[m.PRERELEASE]})?(?:${d[m.BUILD]})?(?:$|[^\\d])`);g("COERCERTL",d[m.COERCE],!0);g("COERCERTLFULL",d[m.COERCEFULL],!0);g("LONETILDE","(?:~>?)");g("TILDETRIM",`(\\s*)${d[m.LONETILDE]}\\s+`,!0);U.tildeTrimReplace="$1~";g("TILDE",`^${d[m.LONETILDE]}${d[m.XRANGEPLAIN]}$`);g("TILDELOOSE",`^${d[m.LONETILDE]}${d[m.XRANGEPLAINLOOSE]}$`);g("LONECARET","(?:\\^)");g("CARETTRIM",`(\\s*)${d[m.LONECARET]}\\s+`,!0);U.caretTrimReplace="$1^";g("CARET",`^${d[m.LONECARET]}${d[m.XRANGEPLAIN]}$`);g("CARETLOOSE",`^${d[m.LONECARET]}${d[m.XRANGEPLAINLOOSE]}$`);g("COMPARATORLOOSE",`^${d[m.GTLT]}\\s*(${d[m.LOOSEPLAIN]})$|^$`);g("COMPARATOR",`^${d[m.GTLT]}\\s*(${d[m.FULLPLAIN]})$|^$`);g("COMPARATORTRIM",`(\\s*)${d[m.GTLT]}\\s*(${d[m.LOOSEPLAIN]}|${d[m.XRANGEPLAIN]})`,!0);U.comparatorTrimReplace="$1$2$3";g("HYPHENRANGE",`^\\s*(${d[m.XRANGEPLAIN]})\\s+-\\s+(${d[m.XRANGEPLAIN]})\\s*$`);g("HYPHENRANGELOOSE",`^\\s*(${d[m.XRANGEPLAINLOOSE]})\\s+-\\s+(${d[m.XRANGEPLAINLOOSE]})\\s*$`);g("STAR","(<|>)?=?\\s*\\*");g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var fr=p((ed,Pn)=>{"use strict";var Qa=Object.freeze({loose:!0}),ec=Object.freeze({}),rc=s(e=>e?typeof e!="object"?Qa:e:ec,"parseOptions");Pn.exports=rc});var rt=p((td,kn)=>{"use strict";var Cn=/^[0-9]+$/,Jn=s((e,r)=>{let t=Cn.test(e),n=Cn.test(r);return t&&n&&(e=+e,r=+r),e===r?0:t&&!n?-1:n&&!t?1:e<r?-1:1},"compareIdentifiers"),tc=s((e,r)=>Jn(r,e),"rcompareIdentifiers");kn.exports={compareIdentifiers:Jn,rcompareIdentifiers:tc}});var A=p((id,Fn)=>{"use strict";var lr=qe(),{MAX_LENGTH:Bn,MAX_SAFE_INTEGER:hr}=Le(),{safeRe:Dn,t:_n}=ye(),nc=fr(),{compareIdentifiers:ge}=rt(),ic=class _{static{s(this,"SemVer")}constructor(r,t){if(t=nc(t),r instanceof _){if(r.loose===!!t.loose&&r.includePrerelease===!!t.includePrerelease)return r;r=r.version}else if(typeof r!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof r}".`);if(r.length>Bn)throw new TypeError(`version is longer than ${Bn} characters`);lr("SemVer",r,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=r.trim().match(t.loose?Dn[_n.LOOSE]:Dn[_n.FULL]);if(!n)throw new TypeError(`Invalid Version: ${r}`);if(this.raw=r,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>hr||this.major<0)throw new TypeError("Invalid major version");if(this.minor>hr||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>hr||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let o=+i;if(o>=0&&o<hr)return o}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(r){if(lr("SemVer.compare",this.version,this.options,r),!(r instanceof _)){if(typeof r=="string"&&r===this.version)return 0;r=new _(r,this.options)}return r.version===this.version?0:this.compareMain(r)||this.comparePre(r)}compareMain(r){return r instanceof _||(r=new _(r,this.options)),ge(this.major,r.major)||ge(this.minor,r.minor)||ge(this.patch,r.patch)}comparePre(r){if(r instanceof _||(r=new _(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=r.prerelease[t];if(lr("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return ge(n,i)}while(++t)}compareBuild(r){r instanceof _||(r=new _(r,this.options));let t=0;do{let n=this.build[t],i=r.build[t];if(lr("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return ge(n,i)}while(++t)}inc(r,t,n){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let o=[t,i];n===!1&&(o=[t]),ge(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${r}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Fn.exports=ic});var ee=p((od,Vn)=>{"use strict";var Un=A(),sc=s((e,r,t=!1)=>{if(e instanceof Un)return e;try{return new Un(e,r)}catch(n){if(!t)return null;throw n}},"parse");Vn.exports=sc});var Kn=p((cd,Gn)=>{"use strict";var oc=ee(),ac=s((e,r)=>{let t=oc(e,r);return t?t.version:null},"valid");Gn.exports=ac});var Hn=p((fd,Wn)=>{"use strict";var cc=ee(),uc=s((e,r)=>{let t=cc(e.trim().replace(/^[=v]+/,""),r);return t?t.version:null},"clean");Wn.exports=uc});var zn=p((hd,Xn)=>{"use strict";var Mn=A(),fc=s((e,r,t,n,i)=>{typeof t=="string"&&(i=n,n=t,t=void 0);try{return new Mn(e instanceof Mn?e.version:e,t).inc(r,n,i).version}catch{return null}},"inc");Xn.exports=fc});var Qn=p((dd,Zn)=>{"use strict";var Yn=ee(),lc=s((e,r)=>{let t=Yn(e,null,!0),n=Yn(r,null,!0),i=t.compare(n);if(i===0)return null;let o=i>0,a=o?t:n,c=o?n:t,f=!!a.prerelease.length;if(!!c.prerelease.length&&!f)return!c.patch&&!c.minor?"major":a.patch?"patch":a.minor?"minor":"major";let h=f?"pre":"";return t.major!==n.major?h+"major":t.minor!==n.minor?h+"minor":t.patch!==n.patch?h+"patch":"prerelease"},"diff");Zn.exports=lc});var ri=p((yd,ei)=>{"use strict";var hc=A(),pc=s((e,r)=>new hc(e,r).major,"major");ei.exports=pc});var ni=p((wd,ti)=>{"use strict";var dc=A(),mc=s((e,r)=>new dc(e,r).minor,"minor");ti.exports=mc});var si=p((Sd,ii)=>{"use strict";var yc=A(),gc=s((e,r)=>new yc(e,r).patch,"patch");ii.exports=gc});var ai=p((bd,oi)=>{"use strict";var wc=ee(),Ec=s((e,r)=>{let t=wc(e,r);return t&&t.prerelease.length?t.prerelease:null},"prerelease");oi.exports=Ec});var P=p((xd,ui)=>{"use strict";var ci=A(),Sc=s((e,r,t)=>new ci(e,t).compare(new ci(r,t)),"compare");ui.exports=Sc});var li=p((Ad,fi)=>{"use strict";var vc=P(),bc=s((e,r,t)=>vc(r,e,t),"rcompare");fi.exports=bc});var pi=p(($d,hi)=>{"use strict";var Ic=P(),xc=s((e,r)=>Ic(e,r,!0),"compareLoose");hi.exports=xc});var pr=p((Nd,mi)=>{"use strict";var di=A(),Rc=s((e,r,t)=>{let n=new di(e,t),i=new di(r,t);return n.compare(i)||n.compareBuild(i)},"compareBuild");mi.exports=Rc});var gi=p((qd,yi)=>{"use strict";var Ac=pr(),Tc=s((e,r)=>e.sort((t,n)=>Ac(t,n,r)),"sort");yi.exports=Tc});var Ei=p((Pd,wi)=>{"use strict";var $c=pr(),Oc=s((e,r)=>e.sort((t,n)=>$c(n,t,r)),"rsort");wi.exports=Oc});var je=p((Jd,Si)=>{"use strict";var Nc=P(),Lc=s((e,r,t)=>Nc(e,r,t)>0,"gt");Si.exports=Lc});var dr=p((Bd,vi)=>{"use strict";var qc=P(),jc=s((e,r,t)=>qc(e,r,t)<0,"lt");vi.exports=jc});var tt=p((_d,bi)=>{"use strict";var Pc=P(),Cc=s((e,r,t)=>Pc(e,r,t)===0,"eq");bi.exports=Cc});var nt=p((Ud,Ii)=>{"use strict";var Jc=P(),kc=s((e,r,t)=>Jc(e,r,t)!==0,"neq");Ii.exports=kc});var mr=p((Gd,xi)=>{"use strict";var Bc=P(),Dc=s((e,r,t)=>Bc(e,r,t)>=0,"gte");xi.exports=Dc});var yr=p((Wd,Ri)=>{"use strict";var _c=P(),Fc=s((e,r,t)=>_c(e,r,t)<=0,"lte");Ri.exports=Fc});var it=p((Md,Ai)=>{"use strict";var Uc=tt(),Vc=nt(),Gc=je(),Kc=mr(),Wc=dr(),Hc=yr(),Mc=s((e,r,t,n)=>{switch(r){case"===":return typeof e=="object"&&(e=e.version),typeof t=="object"&&(t=t.version),e===t;case"!==":return typeof e=="object"&&(e=e.version),typeof t=="object"&&(t=t.version),e!==t;case"":case"=":case"==":return Uc(e,t,n);case"!=":return Vc(e,t,n);case">":return Gc(e,t,n);case">=":return Kc(e,t,n);case"<":return Wc(e,t,n);case"<=":return Hc(e,t,n);default:throw new TypeError(`Invalid operator: ${r}`)}},"cmp");Ai.exports=Mc});var $i=p((zd,Ti)=>{"use strict";var Xc=A(),zc=ee(),{safeRe:gr,t:wr}=ye(),Yc=s((e,r)=>{if(e instanceof Xc)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;r=r||{};let t=null;if(!r.rtl)t=e.match(r.includePrerelease?gr[wr.COERCEFULL]:gr[wr.COERCE]);else{let f=r.includePrerelease?gr[wr.COERCERTLFULL]:gr[wr.COERCERTL],u;for(;(u=f.exec(e))&&(!t||t.index+t[0].length!==e.length);)(!t||u.index+u[0].length!==t.index+t[0].length)&&(t=u),f.lastIndex=u.index+u[1].length+u[2].length;f.lastIndex=-1}if(t===null)return null;let n=t[2],i=t[3]||"0",o=t[4]||"0",a=r.includePrerelease&&t[5]?`-${t[5]}`:"",c=r.includePrerelease&&t[6]?`+${t[6]}`:"";return zc(`${n}.${i}.${o}${a}${c}`,r)},"coerce");Ti.exports=Yc});var Ni=p((Zd,Oi)=>{"use strict";Oi.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let r=this.head;r;r=r.next)yield r.value}}});var qi=p((Qd,Li)=>{"use strict";Li.exports=E;E.Node=re;E.create=E;function E(e){var r=this;if(r instanceof E||(r=new E),r.tail=null,r.head=null,r.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){r.push(i)});else if(arguments.length>0)for(var t=0,n=arguments.length;t<n;t++)r.push(arguments[t]);return r}s(E,"Yallist");E.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var r=e.next,t=e.prev;return r&&(r.prev=t),t&&(t.next=r),e===this.head&&(this.head=r),e===this.tail&&(this.tail=t),e.list.length--,e.next=null,e.prev=null,e.list=null,r};E.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var r=this.head;e.list=this,e.next=r,r&&(r.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};E.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var r=this.tail;e.list=this,e.prev=r,r&&(r.next=e),this.tail=e,this.head||(this.head=e),this.length++}};E.prototype.push=function(){for(var e=0,r=arguments.length;e<r;e++)Qc(this,arguments[e]);return this.length};E.prototype.unshift=function(){for(var e=0,r=arguments.length;e<r;e++)eu(this,arguments[e]);return this.length};E.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};E.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};E.prototype.forEach=function(e,r){r=r||this;for(var t=this.head,n=0;t!==null;n++)e.call(r,t.value,n,this),t=t.next};E.prototype.forEachReverse=function(e,r){r=r||this;for(var t=this.tail,n=this.length-1;t!==null;n--)e.call(r,t.value,n,this),t=t.prev};E.prototype.get=function(e){for(var r=0,t=this.head;t!==null&&r<e;r++)t=t.next;if(r===e&&t!==null)return t.value};E.prototype.getReverse=function(e){for(var r=0,t=this.tail;t!==null&&r<e;r++)t=t.prev;if(r===e&&t!==null)return t.value};E.prototype.map=function(e,r){r=r||this;for(var t=new E,n=this.head;n!==null;)t.push(e.call(r,n.value,this)),n=n.next;return t};E.prototype.mapReverse=function(e,r){r=r||this;for(var t=new E,n=this.tail;n!==null;)t.push(e.call(r,n.value,this)),n=n.prev;return t};E.prototype.reduce=function(e,r){var t,n=this.head;if(arguments.length>1)t=r;else if(this.head)n=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)t=e(t,n.value,i),n=n.next;return t};E.prototype.reduceReverse=function(e,r){var t,n=this.tail;if(arguments.length>1)t=r;else if(this.tail)n=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)t=e(t,n.value,i),n=n.prev;return t};E.prototype.toArray=function(){for(var e=new Array(this.length),r=0,t=this.head;t!==null;r++)e[r]=t.value,t=t.next;return e};E.prototype.toArrayReverse=function(){for(var e=new Array(this.length),r=0,t=this.tail;t!==null;r++)e[r]=t.value,t=t.prev;return e};E.prototype.slice=function(e,r){r=r||this.length,r<0&&(r+=this.length),e=e||0,e<0&&(e+=this.length);var t=new E;if(r<e||r<0)return t;e<0&&(e=0),r>this.length&&(r=this.length);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(;i!==null&&n<r;n++,i=i.next)t.push(i.value);return t};E.prototype.sliceReverse=function(e,r){r=r||this.length,r<0&&(r+=this.length),e=e||0,e<0&&(e+=this.length);var t=new E;if(r<e||r<0)return t;e<0&&(e=0),r>this.length&&(r=this.length);for(var n=this.length,i=this.tail;i!==null&&n>r;n--)i=i.prev;for(;i!==null&&n>e;n--,i=i.prev)t.push(i.value);return t};E.prototype.splice=function(e,r,...t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(var o=[],n=0;i&&n<r;n++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<t.length;n++)i=Zc(this,i,t[n]);return o};E.prototype.reverse=function(){for(var e=this.head,r=this.tail,t=e;t!==null;t=t.prev){var n=t.prev;t.prev=t.next,t.next=n}return this.head=r,this.tail=e,this};function Zc(e,r,t){var n=r===e.head?new re(t,null,r,e):new re(t,r,r.next,e);return n.next===null&&(e.tail=n),n.prev===null&&(e.head=n),e.length++,n}s(Zc,"insert");function Qc(e,r){e.tail=new re(r,e.tail,null,e),e.head||(e.head=e.tail),e.length++}s(Qc,"push");function eu(e,r){e.head=new re(r,null,e.head,e),e.tail||(e.tail=e.head),e.length++}s(eu,"unshift");function re(e,r,t,n){if(!(this instanceof re))return new re(e,r,t,n);this.list=n,this.value=e,r?(r.next=this,this.prev=r):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}s(re,"Node");try{Ni()(E)}catch{}});var ki=p((nm,Ji)=>{"use strict";var ru=qi(),te=Symbol("max"),G=Symbol("length"),we=Symbol("lengthCalculator"),Ce=Symbol("allowStale"),ne=Symbol("maxAge"),V=Symbol("dispose"),ji=Symbol("noDisposeOnSet"),x=Symbol("lruList"),k=Symbol("cache"),Ci=Symbol("updateAgeOnGet"),st=s(()=>1,"naiveLength"),tu=class{static{s(this,"LRUCache")}constructor(r){if(typeof r=="number"&&(r={max:r}),r||(r={}),r.max&&(typeof r.max!="number"||r.max<0))throw new TypeError("max must be a non-negative number");let t=this[te]=r.max||1/0,n=r.length||st;if(this[we]=typeof n!="function"?st:n,this[Ce]=r.stale||!1,r.maxAge&&typeof r.maxAge!="number")throw new TypeError("maxAge must be a number");this[ne]=r.maxAge||0,this[V]=r.dispose,this[ji]=r.noDisposeOnSet||!1,this[Ci]=r.updateAgeOnGet||!1,this.reset()}set max(r){if(typeof r!="number"||r<0)throw new TypeError("max must be a non-negative number");this[te]=r||1/0,Pe(this)}get max(){return this[te]}set allowStale(r){this[Ce]=!!r}get allowStale(){return this[Ce]}set maxAge(r){if(typeof r!="number")throw new TypeError("maxAge must be a non-negative number");this[ne]=r,Pe(this)}get maxAge(){return this[ne]}set lengthCalculator(r){typeof r!="function"&&(r=st),r!==this[we]&&(this[we]=r,this[G]=0,this[x].forEach(t=>{t.length=this[we](t.value,t.key),this[G]+=t.length})),Pe(this)}get lengthCalculator(){return this[we]}get length(){return this[G]}get itemCount(){return this[x].length}rforEach(r,t){t=t||this;for(let n=this[x].tail;n!==null;){let i=n.prev;Pi(this,r,n,t),n=i}}forEach(r,t){t=t||this;for(let n=this[x].head;n!==null;){let i=n.next;Pi(this,r,n,t),n=i}}keys(){return this[x].toArray().map(r=>r.key)}values(){return this[x].toArray().map(r=>r.value)}reset(){this[V]&&this[x]&&this[x].length&&this[x].forEach(r=>this[V](r.key,r.value)),this[k]=new Map,this[x]=new ru,this[G]=0}dump(){return this[x].map(r=>Er(this,r)?!1:{k:r.key,v:r.value,e:r.now+(r.maxAge||0)}).toArray().filter(r=>r)}dumpLru(){return this[x]}set(r,t,n){if(n=n||this[ne],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let i=n?Date.now():0,o=this[we](t,r);if(this[k].has(r)){if(o>this[te])return Ee(this,this[k].get(r)),!1;let f=this[k].get(r).value;return this[V]&&(this[ji]||this[V](r,f.value)),f.now=i,f.maxAge=n,f.value=t,this[G]+=o-f.length,f.length=o,this.get(r),Pe(this),!0}let a=new nu(r,t,o,i,n);return a.length>this[te]?(this[V]&&this[V](r,t),!1):(this[G]+=a.length,this[x].unshift(a),this[k].set(r,this[x].head),Pe(this),!0)}has(r){if(!this[k].has(r))return!1;let t=this[k].get(r).value;return!Er(this,t)}get(r){return ot(this,r,!0)}peek(r){return ot(this,r,!1)}pop(){let r=this[x].tail;return r?(Ee(this,r),r.value):null}del(r){Ee(this,this[k].get(r))}load(r){this.reset();let t=Date.now();for(let n=r.length-1;n>=0;n--){let i=r[n],o=i.e||0;if(o===0)this.set(i.k,i.v);else{let a=o-t;a>0&&this.set(i.k,i.v,a)}}}prune(){this[k].forEach((r,t)=>ot(this,t,!1))}},ot=s((e,r,t)=>{let n=e[k].get(r);if(n){let i=n.value;if(Er(e,i)){if(Ee(e,n),!e[Ce])return}else t&&(e[Ci]&&(n.value.now=Date.now()),e[x].unshiftNode(n));return i.value}},"get"),Er=s((e,r)=>{if(!r||!r.maxAge&&!e[ne])return!1;let t=Date.now()-r.now;return r.maxAge?t>r.maxAge:e[ne]&&t>e[ne]},"isStale"),Pe=s(e=>{if(e[G]>e[te])for(let r=e[x].tail;e[G]>e[te]&&r!==null;){let t=r.prev;Ee(e,r),r=t}},"trim"),Ee=s((e,r)=>{if(r){let t=r.value;e[V]&&e[V](t.key,t.value),e[G]-=t.length,e[k].delete(t.key),e[x].removeNode(r)}},"del"),nu=class{static{s(this,"Entry")}constructor(r,t,n,i,o){this.key=r,this.value=t,this.length=n,this.now=i,this.maxAge=o||0}},Pi=s((e,r,t,n)=>{let i=t.value;Er(e,i)&&(Ee(e,t),e[Ce]||(i=void 0)),i&&r.call(n,i.value,i.key,e)},"forEachStep");Ji.exports=tu});var C=p((sm,Fi)=>{"use strict";var iu=class Sr{static{s(this,"Range")}constructor(r,t){if(t=ou(t),r instanceof Sr)return r.loose===!!t.loose&&r.includePrerelease===!!t.includePrerelease?r:new Sr(r.raw,t);if(r instanceof at)return this.raw=r.value,this.set=[[r]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=r.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(i=>!Di(i[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&pu(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(r=>r.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(r){let n=((this.options.includePrerelease&&lu)|(this.options.loose&&hu))+":"+r,i=Bi.get(n);if(i)return i;let o=this.options.loose,a=o?L[$.HYPHENRANGELOOSE]:L[$.HYPHENRANGE];r=r.replace(a,Iu(this.options.includePrerelease)),v("hyphen replace",r),r=r.replace(L[$.COMPARATORTRIM],cu),v("comparator trim",r),r=r.replace(L[$.TILDETRIM],uu),v("tilde trim",r),r=r.replace(L[$.CARETTRIM],fu),v("caret trim",r);let c=r.split(" ").map(l=>du(l,this.options)).join(" ").split(/\s+/).map(l=>bu(l,this.options));o&&(c=c.filter(l=>(v("loose invalid filter",l,this.options),!!l.match(L[$.COMPARATORLOOSE])))),v("range list",c);let f=new Map,u=c.map(l=>new at(l,this.options));for(let l of u){if(Di(l))return[l];f.set(l.value,l)}f.size>1&&f.has("")&&f.delete("");let h=[...f.values()];return Bi.set(n,h),h}intersects(r,t){if(!(r instanceof Sr))throw new TypeError("a Range is required");return this.set.some(n=>_i(n,t)&&r.set.some(i=>_i(i,t)&&n.every(o=>i.every(a=>o.intersects(a,t)))))}test(r){if(!r)return!1;if(typeof r=="string")try{r=new au(r,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(xu(this.set[t],r,this.options))return!0;return!1}};Fi.exports=iu;var su=ki(),Bi=new su({max:1e3}),ou=fr(),at=Je(),v=qe(),au=A(),{safeRe:L,t:$,comparatorTrimReplace:cu,tildeTrimReplace:uu,caretTrimReplace:fu}=ye(),{FLAG_INCLUDE_PRERELEASE:lu,FLAG_LOOSE:hu}=Le(),Di=s(e=>e.value==="<0.0.0-0","isNullSet"),pu=s(e=>e.value==="","isAny"),_i=s((e,r)=>{let t=!0,n=e.slice(),i=n.pop();for(;t&&n.length;)t=n.every(o=>i.intersects(o,r)),i=n.pop();return t},"isSatisfiable"),du=s((e,r)=>(v("comp",e,r),e=gu(e,r),v("caret",e),e=mu(e,r),v("tildes",e),e=Eu(e,r),v("xrange",e),e=vu(e,r),v("stars",e),e),"parseComparator"),O=s(e=>!e||e.toLowerCase()==="x"||e==="*","isX"),mu=s((e,r)=>e.trim().split(/\s+/).map(t=>yu(t,r)).join(" "),"replaceTildes"),yu=s((e,r)=>{let t=r.loose?L[$.TILDELOOSE]:L[$.TILDE];return e.replace(t,(n,i,o,a,c)=>{v("tilde",e,n,i,o,a,c);let f;return O(i)?f="":O(o)?f=`>=${i}.0.0 <${+i+1}.0.0-0`:O(a)?f=`>=${i}.${o}.0 <${i}.${+o+1}.0-0`:c?(v("replaceTilde pr",c),f=`>=${i}.${o}.${a}-${c} <${i}.${+o+1}.0-0`):f=`>=${i}.${o}.${a} <${i}.${+o+1}.0-0`,v("tilde return",f),f})},"replaceTilde"),gu=s((e,r)=>e.trim().split(/\s+/).map(t=>wu(t,r)).join(" "),"replaceCarets"),wu=s((e,r)=>{v("caret",e,r);let t=r.loose?L[$.CARETLOOSE]:L[$.CARET],n=r.includePrerelease?"-0":"";return e.replace(t,(i,o,a,c,f)=>{v("caret",e,i,o,a,c,f);let u;return O(o)?u="":O(a)?u=`>=${o}.0.0${n} <${+o+1}.0.0-0`:O(c)?o==="0"?u=`>=${o}.${a}.0${n} <${o}.${+a+1}.0-0`:u=`>=${o}.${a}.0${n} <${+o+1}.0.0-0`:f?(v("replaceCaret pr",f),o==="0"?a==="0"?u=`>=${o}.${a}.${c}-${f} <${o}.${a}.${+c+1}-0`:u=`>=${o}.${a}.${c}-${f} <${o}.${+a+1}.0-0`:u=`>=${o}.${a}.${c}-${f} <${+o+1}.0.0-0`):(v("no pr"),o==="0"?a==="0"?u=`>=${o}.${a}.${c}${n} <${o}.${a}.${+c+1}-0`:u=`>=${o}.${a}.${c}${n} <${o}.${+a+1}.0-0`:u=`>=${o}.${a}.${c} <${+o+1}.0.0-0`),v("caret return",u),u})},"replaceCaret"),Eu=s((e,r)=>(v("replaceXRanges",e,r),e.split(/\s+/).map(t=>Su(t,r)).join(" ")),"replaceXRanges"),Su=s((e,r)=>{e=e.trim();let t=r.loose?L[$.XRANGELOOSE]:L[$.XRANGE];return e.replace(t,(n,i,o,a,c,f)=>{v("xRange",e,n,i,o,a,c,f);let u=O(o),h=u||O(a),l=h||O(c),w=l;return i==="="&&w&&(i=""),f=r.includePrerelease?"-0":"",u?i===">"||i==="<"?n="<0.0.0-0":n="*":i&&w?(h&&(a=0),c=0,i===">"?(i=">=",h?(o=+o+1,a=0,c=0):(a=+a+1,c=0)):i==="<="&&(i="<",h?o=+o+1:a=+a+1),i==="<"&&(f="-0"),n=`${i+o}.${a}.${c}${f}`):h?n=`>=${o}.0.0${f} <${+o+1}.0.0-0`:l&&(n=`>=${o}.${a}.0${f} <${o}.${+a+1}.0-0`),v("xRange return",n),n})},"replaceXRange"),vu=s((e,r)=>(v("replaceStars",e,r),e.trim().replace(L[$.STAR],"")),"replaceStars"),bu=s((e,r)=>(v("replaceGTE0",e,r),e.trim().replace(L[r.includePrerelease?$.GTE0PRE:$.GTE0],"")),"replaceGTE0"),Iu=s(e=>(r,t,n,i,o,a,c,f,u,h,l,w,y)=>(O(n)?t="":O(i)?t=`>=${n}.0.0${e?"-0":""}`:O(o)?t=`>=${n}.${i}.0${e?"-0":""}`:a?t=`>=${t}`:t=`>=${t}${e?"-0":""}`,O(u)?f="":O(h)?f=`<${+u+1}.0.0-0`:O(l)?f=`<${u}.${+h+1}.0-0`:w?f=`<=${u}.${h}.${l}-${w}`:e?f=`<${u}.${h}.${+l+1}-0`:f=`<=${f}`,`${t} ${f}`.trim()),"hyphenReplace"),xu=s((e,r,t)=>{for(let n=0;n<e.length;n++)if(!e[n].test(r))return!1;if(r.prerelease.length&&!t.includePrerelease){for(let n=0;n<e.length;n++)if(v(e[n].semver),e[n].semver!==at.ANY&&e[n].semver.prerelease.length>0){let i=e[n].semver;if(i.major===r.major&&i.minor===r.minor&&i.patch===r.patch)return!0}return!1}return!0},"testSet")});var Je=p((am,Hi)=>{"use strict";var ke=Symbol("SemVer ANY"),Ru=class ft{static{s(this,"Comparator")}static get ANY(){return ke}constructor(r,t){if(t=Ui(t),r instanceof ft){if(r.loose===!!t.loose)return r;r=r.value}r=r.trim().split(/\s+/).join(" "),ut("comparator",r,t),this.options=t,this.loose=!!t.loose,this.parse(r),this.semver===ke?this.value="":this.value=this.operator+this.semver.version,ut("comp",this)}parse(r){let t=this.options.loose?Vi[Gi.COMPARATORLOOSE]:Vi[Gi.COMPARATOR],n=r.match(t);if(!n)throw new TypeError(`Invalid comparator: ${r}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new Ki(n[2],this.options.loose):this.semver=ke}toString(){return this.value}test(r){if(ut("Comparator.test",r,this.options.loose),this.semver===ke||r===ke)return!0;if(typeof r=="string")try{r=new Ki(r,this.options)}catch{return!1}return ct(r,this.operator,this.semver,this.options)}intersects(r,t){if(!(r instanceof ft))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Wi(r.value,t).test(this.value):r.operator===""?r.value===""?!0:new Wi(this.value,t).test(r.semver):(t=Ui(t),t.includePrerelease&&(this.value==="<0.0.0-0"||r.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||r.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&r.operator.startsWith(">")||this.operator.startsWith("<")&&r.operator.startsWith("<")||this.semver.version===r.semver.version&&this.operator.includes("=")&&r.operator.includes("=")||ct(this.semver,"<",r.semver,t)&&this.operator.startsWith(">")&&r.operator.startsWith("<")||ct(this.semver,">",r.semver,t)&&this.operator.startsWith("<")&&r.operator.startsWith(">")))}};Hi.exports=Ru;var Ui=fr(),{safeRe:Vi,t:Gi}=ye(),ct=it(),ut=qe(),Ki=A(),Wi=C()});var Be=p((um,Mi)=>{"use strict";var Au=C(),Tu=s((e,r,t)=>{try{r=new Au(r,t)}catch{return!1}return r.test(e)},"satisfies");Mi.exports=Tu});var zi=p((lm,Xi)=>{"use strict";var $u=C(),Ou=s((e,r)=>new $u(e,r).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" ")),"toComparators");Xi.exports=Ou});var Zi=p((pm,Yi)=>{"use strict";var Nu=A(),Lu=C(),qu=s((e,r,t)=>{let n=null,i=null,o=null;try{o=new Lu(r,t)}catch{return null}return e.forEach(a=>{o.test(a)&&(!n||i.compare(a)===-1)&&(n=a,i=new Nu(n,t))}),n},"maxSatisfying");Yi.exports=qu});var es=p((mm,Qi)=>{"use strict";var ju=A(),Pu=C(),Cu=s((e,r,t)=>{let n=null,i=null,o=null;try{o=new Pu(r,t)}catch{return null}return e.forEach(a=>{o.test(a)&&(!n||i.compare(a)===1)&&(n=a,i=new ju(n,t))}),n},"minSatisfying");Qi.exports=Cu});var ns=p((gm,ts)=>{"use strict";var lt=A(),Ju=C(),rs=je(),ku=s((e,r)=>{e=new Ju(e,r);let t=new lt("0.0.0");if(e.test(t)||(t=new lt("0.0.0-0"),e.test(t)))return t;t=null;for(let n=0;n<e.set.length;++n){let i=e.set[n],o=null;i.forEach(a=>{let c=new lt(a.semver.version);switch(a.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!o||rs(c,o))&&(o=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),o&&(!t||rs(t,o))&&(t=o)}return t&&e.test(t)?t:null},"minVersion");ts.exports=ku});var ss=p((Em,is)=>{"use strict";var Bu=C(),Du=s((e,r)=>{try{return new Bu(e,r).range||"*"}catch{return null}},"validRange");is.exports=Du});var vr=p((vm,us)=>{"use strict";var _u=A(),cs=Je(),{ANY:Fu}=cs,Uu=C(),Vu=Be(),os=je(),as=dr(),Gu=yr(),Ku=mr(),Wu=s((e,r,t,n)=>{e=new _u(e,n),r=new Uu(r,n);let i,o,a,c,f;switch(t){case">":i=os,o=Gu,a=as,c=">",f=">=";break;case"<":i=as,o=Ku,a=os,c="<",f="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Vu(e,r,n))return!1;for(let u=0;u<r.set.length;++u){let h=r.set[u],l=null,w=null;if(h.forEach(y=>{y.semver===Fu&&(y=new cs(">=0.0.0")),l=l||y,w=w||y,i(y.semver,l.semver,n)?l=y:a(y.semver,w.semver,n)&&(w=y)}),l.operator===c||l.operator===f||(!w.operator||w.operator===c)&&o(e,w.semver))return!1;if(w.operator===f&&a(e,w.semver))return!1}return!0},"outside");us.exports=Wu});var ls=p((Im,fs)=>{"use strict";var Hu=vr(),Mu=s((e,r,t)=>Hu(e,r,">",t),"gtr");fs.exports=Mu});var ps=p((Rm,hs)=>{"use strict";var Xu=vr(),zu=s((e,r,t)=>Xu(e,r,"<",t),"ltr");hs.exports=zu});var ys=p((Tm,ms)=>{"use strict";var ds=C(),Yu=s((e,r,t)=>(e=new ds(e,t),r=new ds(r,t),e.intersects(r,t)),"intersects");ms.exports=Yu});var ws=p((Om,gs)=>{"use strict";var Zu=Be(),Qu=P();gs.exports=(e,r,t)=>{let n=[],i=null,o=null,a=e.sort((h,l)=>Qu(h,l,t));for(let h of a)Zu(h,r,t)?(o=h,i||(i=h)):(o&&n.push([i,o]),o=null,i=null);i&&n.push([i,null]);let c=[];for(let[h,l]of n)h===l?c.push(h):!l&&h===a[0]?c.push("*"):l?h===a[0]?c.push(`<=${l}`):c.push(`${h} - ${l}`):c.push(`>=${h}`);let f=c.join(" || "),u=typeof r.raw=="string"?r.raw:String(r);return f.length<u.length?f:r}});var xs=p((Nm,Is)=>{"use strict";var Es=C(),pt=Je(),{ANY:ht}=pt,De=Be(),dt=P(),ef=s((e,r,t={})=>{if(e===r)return!0;e=new Es(e,t),r=new Es(r,t);let n=!1;e:for(let i of e.set){for(let o of r.set){let a=tf(i,o,t);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},"subset"),rf=[new pt(">=0.0.0-0")],Ss=[new pt(">=0.0.0")],tf=s((e,r,t)=>{if(e===r)return!0;if(e.length===1&&e[0].semver===ht){if(r.length===1&&r[0].semver===ht)return!0;t.includePrerelease?e=rf:e=Ss}if(r.length===1&&r[0].semver===ht){if(t.includePrerelease)return!0;r=Ss}let n=new Set,i,o;for(let y of e)y.operator===">"||y.operator===">="?i=vs(i,y,t):y.operator==="<"||y.operator==="<="?o=bs(o,y,t):n.add(y.semver);if(n.size>1)return null;let a;if(i&&o){if(a=dt(i.semver,o.semver,t),a>0)return null;if(a===0&&(i.operator!==">="||o.operator!=="<="))return null}for(let y of n){if(i&&!De(y,String(i),t)||o&&!De(y,String(o),t))return null;for(let b of r)if(!De(y,String(b),t))return!1;return!0}let c,f,u,h,l=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1,w=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;l&&l.prerelease.length===1&&o.operator==="<"&&l.prerelease[0]===0&&(l=!1);for(let y of r){if(h=h||y.operator===">"||y.operator===">=",u=u||y.operator==="<"||y.operator==="<=",i){if(w&&y.semver.prerelease&&y.semver.prerelease.length&&y.semver.major===w.major&&y.semver.minor===w.minor&&y.semver.patch===w.patch&&(w=!1),y.operator===">"||y.operator===">="){if(c=vs(i,y,t),c===y&&c!==i)return!1}else if(i.operator===">="&&!De(i.semver,String(y),t))return!1}if(o){if(l&&y.semver.prerelease&&y.semver.prerelease.length&&y.semver.major===l.major&&y.semver.minor===l.minor&&y.semver.patch===l.patch&&(l=!1),y.operator==="<"||y.operator==="<="){if(f=bs(o,y,t),f===y&&f!==o)return!1}else if(o.operator==="<="&&!De(o.semver,String(y),t))return!1}if(!y.operator&&(o||i)&&a!==0)return!1}return!(i&&u&&!o&&a!==0||o&&h&&!i&&a!==0||w||l)},"simpleSubset"),vs=s((e,r,t)=>{if(!e)return r;let n=dt(e.semver,r.semver,t);return n>0?e:n<0||r.operator===">"&&e.operator===">="?r:e},"higherGT"),bs=s((e,r,t)=>{if(!e)return r;let n=dt(e.semver,r.semver,t);return n<0?e:n>0||r.operator==="<"&&e.operator==="<="?r:e},"lowerLT");Is.exports=ef});var br=p((qm,Ts)=>{"use strict";var mt=ye(),Rs=Le(),nf=A(),As=rt(),sf=ee(),of=Kn(),af=Hn(),cf=zn(),uf=Qn(),ff=ri(),lf=ni(),hf=si(),pf=ai(),df=P(),mf=li(),yf=pi(),gf=pr(),wf=gi(),Ef=Ei(),Sf=je(),vf=dr(),bf=tt(),If=nt(),xf=mr(),Rf=yr(),Af=it(),Tf=$i(),$f=Je(),Of=C(),Nf=Be(),Lf=zi(),qf=Zi(),jf=es(),Pf=ns(),Cf=ss(),Jf=vr(),kf=ls(),Bf=ps(),Df=ys(),_f=ws(),Ff=xs();Ts.exports={parse:sf,valid:of,clean:af,inc:cf,diff:uf,major:ff,minor:lf,patch:hf,prerelease:pf,compare:df,rcompare:mf,compareLoose:yf,compareBuild:gf,sort:wf,rsort:Ef,gt:Sf,lt:vf,eq:bf,neq:If,gte:xf,lte:Rf,cmp:Af,coerce:Tf,Comparator:$f,Range:Of,satisfies:Nf,toComparators:Lf,maxSatisfying:qf,minSatisfying:jf,minVersion:Pf,validRange:Cf,outside:Jf,gtr:kf,ltr:Bf,intersects:Df,simplifyRange:_f,subset:Ff,SemVer:nf,re:mt.re,src:mt.src,tokens:mt.t,SEMVER_SPEC_VERSION:Rs.SEMVER_SPEC_VERSION,RELEASE_TYPES:Rs.RELEASE_TYPES,compareIdentifiers:As.compareIdentifiers,rcompareIdentifiers:As.rcompareIdentifiers}});var Os=p((jm,$s)=>{"use strict";var Uf=br();$s.exports=Uf.satisfies(process.version,">=15.7.0")});var Ls=p((Pm,Ns)=>{"use strict";var Vf=br();Ns.exports=Vf.satisfies(process.version,">=16.9.0")});var yt=p((Cm,qs)=>{"use strict";var Gf=Os(),Kf=Ls(),Wf={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},Hf={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};qs.exports=function(e,r){if(!e||!r)return;let t=r.asymmetricKeyType;if(!t)return;let n=Wf[t];if(!n)throw new Error(`Unknown key type "${t}".`);if(!n.includes(e))throw new Error(`"alg" parameter for "${t}" key type must be one of: ${n.join(", ")}.`);if(Gf)switch(t){case"ec":let i=r.asymmetricKeyDetails.namedCurve,o=Hf[e];if(i!==o)throw new Error(`"alg" parameter "${e}" requires curve "${o}".`);break;case"rsa-pss":if(Kf){let a=parseInt(e.slice(-3),10),{hashAlgorithm:c,mgf1HashAlgorithm:f,saltLength:u}=r.asymmetricKeyDetails;if(c!==`sha${a}`||f!==c)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}.`);if(u!==void 0&&u>a>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}.`)}break}}});var gt=p((Jm,js)=>{"use strict";var Mf=br();js.exports=Mf.satisfies(process.version,"^6.12.0 || >=8.0.0")});var Js=p((km,Cs)=>{"use strict";var S=Ne(),Xf=zr(),Ps=Yr(),zf=Xr(),Yf=Zr(),Zf=yt(),Qf=gt(),el=sr(),{KeyObject:rl,createSecretKey:tl,createPublicKey:nl}=require("crypto"),wt=["RS256","RS384","RS512"],il=["ES256","ES384","ES512"],Et=["RS256","RS384","RS512"],sl=["HS256","HS384","HS512"];Qf&&(wt.splice(wt.length,0,"PS256","PS384","PS512"),Et.splice(Et.length,0,"PS256","PS384","PS512"));Cs.exports=function(e,r,t,n){typeof t=="function"&&!n&&(n=t,t={}),t||(t={}),t=Object.assign({},t);let i;if(n?i=n:i=s(function(h,l){if(h)throw h;return l},"done"),t.clockTimestamp&&typeof t.clockTimestamp!="number")return i(new S("clockTimestamp must be a number"));if(t.nonce!==void 0&&(typeof t.nonce!="string"||t.nonce.trim()===""))return i(new S("nonce must be a non-empty string"));if(t.allowInvalidAsymmetricKeyTypes!==void 0&&typeof t.allowInvalidAsymmetricKeyTypes!="boolean")return i(new S("allowInvalidAsymmetricKeyTypes must be a boolean"));let o=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return i(new S("jwt must be provided"));if(typeof e!="string")return i(new S("jwt must be a string"));let a=e.split(".");if(a.length!==3)return i(new S("jwt malformed"));let c;try{c=zf(e,{complete:!0})}catch(h){return i(h)}if(!c)return i(new S("invalid token"));let f=c.header,u;if(typeof r=="function"){if(!n)return i(new S("verify must be called asynchronous if secret or public key is provided as a callback"));u=r}else u=s(function(h,l){return l(null,r)},"getSecret");return u(f,function(h,l){if(h)return i(new S("error in secret or public key callback: "+h.message));let w=a[2].trim()!=="";if(!w&&l)return i(new S("jwt signature is required"));if(w&&!l)return i(new S("secret or public key must be provided"));if(!w&&!t.algorithms)return i(new S('please specify "none" in "algorithms" to verify unsigned tokens'));if(l!=null&&!(l instanceof rl))try{l=nl(l)}catch{try{l=tl(typeof l=="string"?Buffer.from(l):l)}catch{return i(new S("secretOrPublicKey is not valid key material"))}}if(t.algorithms||(l.type==="secret"?t.algorithms=sl:["rsa","rsa-pss"].includes(l.asymmetricKeyType)?t.algorithms=Et:l.asymmetricKeyType==="ec"?t.algorithms=il:t.algorithms=wt),t.algorithms.indexOf(c.header.alg)===-1)return i(new S("invalid algorithm"));if(f.alg.startsWith("HS")&&l.type!=="secret")return i(new S(`secretOrPublicKey must be a symmetric key when using ${f.alg}`));if(/^(?:RS|PS|ES)/.test(f.alg)&&l.type!=="public")return i(new S(`secretOrPublicKey must be an asymmetric key when using ${f.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{Zf(f.alg,l)}catch(N){return i(N)}let y;try{y=el.verify(e,c.header.alg,l)}catch(N){return i(N)}if(!y)return i(new S("invalid signature"));let b=c.payload;if(typeof b.nbf<"u"&&!t.ignoreNotBefore){if(typeof b.nbf!="number")return i(new S("invalid nbf value"));if(b.nbf>o+(t.clockTolerance||0))return i(new Xf("jwt not active",new Date(b.nbf*1e3)))}if(typeof b.exp<"u"&&!t.ignoreExpiration){if(typeof b.exp!="number")return i(new S("invalid exp value"));if(o>=b.exp+(t.clockTolerance||0))return i(new Ps("jwt expired",new Date(b.exp*1e3)))}if(t.audience){let N=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(b.aud)?b.aud:[b.aud]).some(function(qt){return N.some(function(Dr){return Dr instanceof RegExp?Dr.test(qt):Dr===qt})}))return i(new S("jwt audience invalid. expected: "+N.join(" or ")))}if(t.issuer&&(typeof t.issuer=="string"&&b.iss!==t.issuer||Array.isArray(t.issuer)&&t.issuer.indexOf(b.iss)===-1))return i(new S("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&b.sub!==t.subject)return i(new S("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&b.jti!==t.jwtid)return i(new S("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&b.nonce!==t.nonce)return i(new S("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if(typeof b.iat!="number")return i(new S("iat required when maxAge is specified"));let N=Yf(t.maxAge,b.iat);if(typeof N>"u")return i(new S('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(o>=N+(t.clockTolerance||0))return i(new Ps("maxAge exceeded",new Date(N*1e3)))}if(t.complete===!0){let N=c.signature;return i(null,{header:f,payload:b,signature:N})}return i(null,b)})}});var Us=p((Dm,Fs)=>{"use strict";var ks=1/0,Ds=9007199254740991,ol=17976931348623157e292,Bs=NaN,al="[object Arguments]",cl="[object Function]",ul="[object GeneratorFunction]",fl="[object String]",ll="[object Symbol]",hl=/^\s+|\s+$/g,pl=/^[-+]0x[0-9a-f]+$/i,dl=/^0b[01]+$/i,ml=/^0o[0-7]+$/i,yl=/^(?:0|[1-9]\d*)$/,gl=parseInt;function wl(e,r){for(var t=-1,n=e?e.length:0,i=Array(n);++t<n;)i[t]=r(e[t],t,e);return i}s(wl,"arrayMap");function El(e,r,t,n){for(var i=e.length,o=t+(n?1:-1);n?o--:++o<i;)if(r(e[o],o,e))return o;return-1}s(El,"baseFindIndex");function Sl(e,r,t){if(r!==r)return El(e,vl,t);for(var n=t-1,i=e.length;++n<i;)if(e[n]===r)return n;return-1}s(Sl,"baseIndexOf");function vl(e){return e!==e}s(vl,"baseIsNaN");function bl(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}s(bl,"baseTimes");function Il(e,r){return wl(r,function(t){return e[t]})}s(Il,"baseValues");function xl(e,r){return function(t){return e(r(t))}}s(xl,"overArg");var Ir=Object.prototype,vt=Ir.hasOwnProperty,xr=Ir.toString,Rl=Ir.propertyIsEnumerable,Al=xl(Object.keys,Object),Tl=Math.max;function $l(e,r){var t=_s(e)||jl(e)?bl(e.length,String):[],n=t.length,i=!!n;for(var o in e)(r||vt.call(e,o))&&!(i&&(o=="length"||Nl(o,n)))&&t.push(o);return t}s($l,"arrayLikeKeys");function Ol(e){if(!Ll(e))return Al(e);var r=[];for(var t in Object(e))vt.call(e,t)&&t!="constructor"&&r.push(t);return r}s(Ol,"baseKeys");function Nl(e,r){return r=r??Ds,!!r&&(typeof e=="number"||yl.test(e))&&e>-1&&e%1==0&&e<r}s(Nl,"isIndex");function Ll(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||Ir;return e===t}s(Ll,"isPrototype");function ql(e,r,t,n){e=bt(e)?e:Vl(e),t=t&&!n?_l(t):0;var i=e.length;return t<0&&(t=Tl(i+t,0)),kl(e)?t<=i&&e.indexOf(r,t)>-1:!!i&&Sl(e,r,t)>-1}s(ql,"includes");function jl(e){return Pl(e)&&vt.call(e,"callee")&&(!Rl.call(e,"callee")||xr.call(e)==al)}s(jl,"isArguments");var _s=Array.isArray;function bt(e){return e!=null&&Jl(e.length)&&!Cl(e)}s(bt,"isArrayLike");function Pl(e){return It(e)&&bt(e)}s(Pl,"isArrayLikeObject");function Cl(e){var r=St(e)?xr.call(e):"";return r==cl||r==ul}s(Cl,"isFunction");function Jl(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ds}s(Jl,"isLength");function St(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}s(St,"isObject");function It(e){return!!e&&typeof e=="object"}s(It,"isObjectLike");function kl(e){return typeof e=="string"||!_s(e)&&It(e)&&xr.call(e)==fl}s(kl,"isString");function Bl(e){return typeof e=="symbol"||It(e)&&xr.call(e)==ll}s(Bl,"isSymbol");function Dl(e){if(!e)return e===0?e:0;if(e=Fl(e),e===ks||e===-ks){var r=e<0?-1:1;return r*ol}return e===e?e:0}s(Dl,"toFinite");function _l(e){var r=Dl(e),t=r%1;return r===r?t?r-t:r:0}s(_l,"toInteger");function Fl(e){if(typeof e=="number")return e;if(Bl(e))return Bs;if(St(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=St(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(hl,"");var t=dl.test(e);return t||ml.test(e)?gl(e.slice(2),t?2:8):pl.test(e)?Bs:+e}s(Fl,"toNumber");function Ul(e){return bt(e)?$l(e):Ol(e)}s(Ul,"keys");function Vl(e){return e?Il(e,Ul(e)):[]}s(Vl,"values");Fs.exports=ql});var Gs=p((Fm,Vs)=>{"use strict";var Gl="[object Boolean]",Kl=Object.prototype,Wl=Kl.toString;function Hl(e){return e===!0||e===!1||Ml(e)&&Wl.call(e)==Gl}s(Hl,"isBoolean");function Ml(e){return!!e&&typeof e=="object"}s(Ml,"isObjectLike");Vs.exports=Hl});var Xs=p((Vm,Ms)=>{"use strict";var Ks=1/0,Xl=17976931348623157e292,Ws=NaN,zl="[object Symbol]",Yl=/^\s+|\s+$/g,Zl=/^[-+]0x[0-9a-f]+$/i,Ql=/^0b[01]+$/i,eh=/^0o[0-7]+$/i,rh=parseInt,th=Object.prototype,nh=th.toString;function ih(e){return typeof e=="number"&&e==ch(e)}s(ih,"isInteger");function Hs(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}s(Hs,"isObject");function sh(e){return!!e&&typeof e=="object"}s(sh,"isObjectLike");function oh(e){return typeof e=="symbol"||sh(e)&&nh.call(e)==zl}s(oh,"isSymbol");function ah(e){if(!e)return e===0?e:0;if(e=uh(e),e===Ks||e===-Ks){var r=e<0?-1:1;return r*Xl}return e===e?e:0}s(ah,"toFinite");function ch(e){var r=ah(e),t=r%1;return r===r?t?r-t:r:0}s(ch,"toInteger");function uh(e){if(typeof e=="number")return e;if(oh(e))return Ws;if(Hs(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=Hs(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(Yl,"");var t=Ql.test(e);return t||eh.test(e)?rh(e.slice(2),t?2:8):Zl.test(e)?Ws:+e}s(uh,"toNumber");Ms.exports=ih});var Ys=p((Km,zs)=>{"use strict";var fh="[object Number]",lh=Object.prototype,hh=lh.toString;function ph(e){return!!e&&typeof e=="object"}s(ph,"isObjectLike");function dh(e){return typeof e=="number"||ph(e)&&hh.call(e)==fh}s(dh,"isNumber");zs.exports=dh});var ro=p((Hm,eo)=>{"use strict";var mh="[object Object]";function yh(e){var r=!1;if(e!=null&&typeof e.toString!="function")try{r=!!(e+"")}catch{}return r}s(yh,"isHostObject");function gh(e,r){return function(t){return e(r(t))}}s(gh,"overArg");var wh=Function.prototype,Zs=Object.prototype,Qs=wh.toString,Eh=Zs.hasOwnProperty,Sh=Qs.call(Object),vh=Zs.toString,bh=gh(Object.getPrototypeOf,Object);function Ih(e){return!!e&&typeof e=="object"}s(Ih,"isObjectLike");function xh(e){if(!Ih(e)||vh.call(e)!=mh||yh(e))return!1;var r=bh(e);if(r===null)return!0;var t=Eh.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t instanceof t&&Qs.call(t)==Sh}s(xh,"isPlainObject");eo.exports=xh});var no=p((Xm,to)=>{"use strict";var Rh="[object String]",Ah=Object.prototype,Th=Ah.toString,$h=Array.isArray;function Oh(e){return!!e&&typeof e=="object"}s(Oh,"isObjectLike");function Nh(e){return typeof e=="string"||!$h(e)&&Oh(e)&&Th.call(e)==Rh}s(Nh,"isString");to.exports=Nh});var co=p((Ym,ao)=>{"use strict";var Lh="Expected a function",io=1/0,qh=17976931348623157e292,so=NaN,jh="[object Symbol]",Ph=/^\s+|\s+$/g,Ch=/^[-+]0x[0-9a-f]+$/i,Jh=/^0b[01]+$/i,kh=/^0o[0-7]+$/i,Bh=parseInt,Dh=Object.prototype,_h=Dh.toString;function Fh(e,r){var t;if(typeof r!="function")throw new TypeError(Lh);return e=Wh(e),function(){return--e>0&&(t=r.apply(this,arguments)),e<=1&&(r=void 0),t}}s(Fh,"before");function Uh(e){return Fh(2,e)}s(Uh,"once");function oo(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}s(oo,"isObject");function Vh(e){return!!e&&typeof e=="object"}s(Vh,"isObjectLike");function Gh(e){return typeof e=="symbol"||Vh(e)&&_h.call(e)==jh}s(Gh,"isSymbol");function Kh(e){if(!e)return e===0?e:0;if(e=Hh(e),e===io||e===-io){var r=e<0?-1:1;return r*qh}return e===e?e:0}s(Kh,"toFinite");function Wh(e){var r=Kh(e),t=r%1;return r===r?t?r-t:r:0}s(Wh,"toInteger");function Hh(e){if(typeof e=="number")return e;if(Gh(e))return so;if(oo(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=oo(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(Ph,"");var t=Jh.test(e);return t||kh.test(e)?Bh(e.slice(2),t?2:8):Ch.test(e)?so:+e}s(Hh,"toNumber");ao.exports=Uh});var wo=p((Qm,go)=>{"use strict";var uo=Zr(),Mh=gt(),Xh=yt(),fo=sr(),zh=Us(),Rr=Gs(),lo=Xs(),xt=Ys(),po=ro(),z=no(),Yh=co(),{KeyObject:Zh,createSecretKey:Qh,createPrivateKey:ep}=require("crypto"),mo=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];Mh&&mo.splice(3,0,"PS256","PS384","PS512");var rp={expiresIn:{isValid:s(function(e){return lo(e)||z(e)&&e},"isValid"),message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:s(function(e){return lo(e)||z(e)&&e},"isValid"),message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:s(function(e){return z(e)||Array.isArray(e)},"isValid"),message:'"audience" must be a string or array'},algorithm:{isValid:zh.bind(null,mo),message:'"algorithm" must be a valid string enum value'},header:{isValid:po,message:'"header" must be an object'},encoding:{isValid:z,message:'"encoding" must be a string'},issuer:{isValid:z,message:'"issuer" must be a string'},subject:{isValid:z,message:'"subject" must be a string'},jwtid:{isValid:z,message:'"jwtid" must be a string'},noTimestamp:{isValid:Rr,message:'"noTimestamp" must be a boolean'},keyid:{isValid:z,message:'"keyid" must be a string'},mutatePayload:{isValid:Rr,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:Rr,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:Rr,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},tp={iat:{isValid:xt,message:'"iat" should be a number of seconds'},exp:{isValid:xt,message:'"exp" should be a number of seconds'},nbf:{isValid:xt,message:'"nbf" should be a number of seconds'}};function yo(e,r,t,n){if(!po(t))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(i){let o=e[i];if(!o){if(!r)throw new Error('"'+i+'" is not allowed in "'+n+'"');return}if(!o.isValid(t[i]))throw new Error(o.message)})}s(yo,"validate");function np(e){return yo(rp,!1,e,"options")}s(np,"validateOptions");function ip(e){return yo(tp,!0,e,"payload")}s(ip,"validatePayload");var ho={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},sp=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];go.exports=function(e,r,t,n){typeof t=="function"?(n=t,t={}):t=t||{};let i=typeof e=="object"&&!Buffer.isBuffer(e),o=Object.assign({alg:t.algorithm||"HS256",typ:i?"JWT":void 0,kid:t.keyid},t.header);function a(u){if(n)return n(u);throw u}if(s(a,"failure"),!r&&t.algorithm!=="none")return a(new Error("secretOrPrivateKey must have a value"));if(r!=null&&!(r instanceof Zh))try{r=ep(r)}catch{try{r=Qh(typeof r=="string"?Buffer.from(r):r)}catch{return a(new Error("secretOrPrivateKey is not valid key material"))}}if(o.alg.startsWith("HS")&&r.type!=="secret")return a(new Error(`secretOrPrivateKey must be a symmetric key when using ${o.alg}`));if(/^(?:RS|PS|ES)/.test(o.alg)){if(r.type!=="private")return a(new Error(`secretOrPrivateKey must be an asymmetric key when using ${o.alg}`));if(!t.allowInsecureKeySizes&&!o.alg.startsWith("ES")&&r.asymmetricKeyDetails!==void 0&&r.asymmetricKeyDetails.modulusLength<2048)return a(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${o.alg}`))}if(typeof e>"u")return a(new Error("payload is required"));if(i){try{ip(e)}catch(u){return a(u)}t.mutatePayload||(e=Object.assign({},e))}else{let u=sp.filter(function(h){return typeof t[h]<"u"});if(u.length>0)return a(new Error("invalid "+u.join(",")+" option for "+typeof e+" payload"))}if(typeof e.exp<"u"&&typeof t.expiresIn<"u")return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof e.nbf<"u"&&typeof t.notBefore<"u")return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{np(t)}catch(u){return a(u)}if(!t.allowInvalidAsymmetricKeyTypes)try{Xh(o.alg,r)}catch(u){return a(u)}let c=e.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete e.iat:i&&(e.iat=c),typeof t.notBefore<"u"){try{e.nbf=uo(t.notBefore,c)}catch(u){return a(u)}if(typeof e.nbf>"u")return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof t.expiresIn<"u"&&typeof e=="object"){try{e.exp=uo(t.expiresIn,c)}catch(u){return a(u)}if(typeof e.exp>"u")return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(ho).forEach(function(u){let h=ho[u];if(typeof t[u]<"u"){if(typeof e[h]<"u")return a(new Error('Bad "options.'+u+'" option. The payload already has an "'+h+'" property.'));e[h]=t[u]}});let f=t.encoding||"utf8";if(typeof n=="function")n=n&&Yh(n),fo.createSign({header:o,privateKey:r,payload:e,encoding:f}).once("error",n).once("done",function(u){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(o.alg)&&u.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${o.alg}`));n(null,u)});else{let u=fo.sign({header:o,payload:e,secret:r,encoding:f});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(o.alg)&&u.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${o.alg}`);return u}}});var So=p((ry,Eo)=>{"use strict";Eo.exports={decode:Xr(),verify:Js(),sign:wo(),JsonWebTokenError:Ne(),NotBeforeError:zr(),TokenExpiredError:Yr()}});var Ep={};Ko(Ep,{handler:()=>wp});module.exports=Ho(Ep);var ko=Wo(So());var j=class extends Error{static{s(this,"JwtBaseError")}},F=class extends j{static{s(this,"FailedAssertionError")}constructor(r,t,n){super(r),this.failedAssertion={actual:t,expected:n}}},I=class extends j{static{s(this,"JwtParseError")}constructor(r,t){let n=t!=null?`${r}: ${t}`:r;super(n)}},R=class extends j{static{s(this,"ParameterValidationError")}},_e=class extends j{static{s(this,"JwtInvalidSignatureError")}},Fe=class extends F{static{s(this,"JwtInvalidSignatureAlgorithmError")}},T=class extends F{static{s(this,"JwtInvalidClaimError")}withRawJwt({header:r,payload:t}){return this.rawJwt={header:r,payload:t},this}},Se=class extends T{static{s(this,"JwtInvalidIssuerError")}},Ar=class extends T{static{s(this,"JwtInvalidAudienceError")}},Tr=class extends T{static{s(this,"JwtInvalidScopeError")}},$r=class extends T{static{s(this,"JwtExpiredError")}},Or=class extends T{static{s(this,"JwtNotBeforeError")}},Nr=class extends T{static{s(this,"CognitoJwtInvalidGroupError")}},Ue=class extends T{static{s(this,"CognitoJwtInvalidTokenUseError")}},Ve=class extends T{static{s(this,"CognitoJwtInvalidClientIdError")}};var ie=class extends j{static{s(this,"JwksValidationError")}},K=class extends j{static{s(this,"JwkValidationError")}},ve=class extends j{static{s(this,"JwtWithoutValidKidError")}},Y=class extends j{static{s(this,"KidNotFoundInJwksError")}},Lr=class extends j{static{s(this,"WaitPeriodNotYetEndedJwkError")}},qr=class extends j{static{s(this,"JwksNotAvailableInCacheError")}},jr=class extends F{static{s(this,"JwkInvalidUseError")}},Pr=class extends F{static{s(this,"JwkInvalidKtyError")}},W=class extends j{static{s(this,"FetchError")}constructor(r,t){super(`Failed to fetch ${r}: ${t}`)}},H=class extends W{static{s(this,"NonRetryableFetchError")}};var Ie=require("crypto");var se;(function(e){e[e.Universal=0]="Universal"})(se||(se={}));var oe;(function(e){e[e.Primitive=0]="Primitive",e[e.Constructed=1]="Constructed"})(oe||(oe={}));var ae;(function(e){e[e.BitString=3]="BitString",e[e.ObjectIdentifier=6]="ObjectIdentifier",e[e.Sequence=16]="Sequence",e[e.Null=5]="Null",e[e.Integer=2]="Integer"})(ae||(ae={}));function Ge(e){let r=e.class<<7|e.primitiveOrConstructed<<5|e.tag;return Buffer.from([r])}s(Ge,"encodeIdentifier");function Ke(e){if(e<128)return Buffer.from([e]);let r=[];for(;e>0;)r.push(e%256),e=e>>8;return r.reverse(),Buffer.from([128|r.length,...r])}s(Ke,"encodeLength");function vo(e){return e[0]>>7&&(e=Buffer.concat([Buffer.from([0]),e])),Buffer.concat([Ge({class:se.Universal,primitiveOrConstructed:oe.Primitive,tag:ae.Integer}),Ke(e.length),e])}s(vo,"encodeBufferAsPositiveInteger");function op(e){let r=e.split(".").map(o=>parseInt(o)),t=r[0]*40+r[1],n=r.slice(2).reduce((o,a)=>{let c=[];do c.push(a%128),a=a>>7;while(a);return o.concat(c.map((f,u)=>u?f+128:f).reverse())},[]),i=Buffer.from([t,...n]);return Buffer.concat([Ge({class:se.Universal,primitiveOrConstructed:oe.Primitive,tag:ae.ObjectIdentifier}),Ke(i.length),i])}s(op,"encodeObjectIdentifier");function ap(e){let r=Buffer.concat([Buffer.from([0]),e]);return Buffer.concat([Ge({class:se.Universal,primitiveOrConstructed:oe.Primitive,tag:ae.BitString}),Ke(r.length),r])}s(ap,"encodeBufferAsBitString");function Rt(e){let r=Buffer.concat(e);return Buffer.concat([Ge({class:se.Universal,primitiveOrConstructed:oe.Constructed,tag:ae.Sequence}),Ke(r.length),r])}s(Rt,"encodeSequence");function cp(){return Buffer.concat([Ge({class:se.Universal,primitiveOrConstructed:oe.Primitive,tag:ae.Null}),Ke(0)])}s(cp,"encodeNull");var up=Rt([op("1.2.840.113549.1.1.1"),cp()]);function At(e,r){return Rt([up,ap(Rt([vo(e),vo(r)]))])}s(At,"constructPublicKeyInDerFormat");var Io=require("https");function bo(e,r,t){if(r===429)throw new W(e,"Too many requests");if(r!==200)throw new H(e,`Status code is ${r}, expected 200`);if(!t||!t.toLowerCase().startsWith("application/json"))throw new H(e,`Content-type is "${t}", expected "application/json"`)}s(bo,"validateHttpsJsonResponse");var xo=require("stream"),Ro=require("util");function be(e){return typeof e=="object"&&!Array.isArray(e)&&e!==null}s(be,"isJsonObject");function We(e){return JSON.parse(e,(r,t)=>(typeof t=="object"&&!Array.isArray(t)&&t!==null&&(delete t.__proto__,delete t.constructor),t))}s(We,"safeJsonParse");async function Ao(e,r,t){let n;return new Promise((i,o)=>{let a=(0,Io.request)(e,{method:"GET",...r},f=>{(0,xo.pipeline)([f,fp(e,f.statusCode,f.headers)],c)});r?.responseTimeout&&(n=setTimeout(()=>c(new W(e,`Response time-out (after ${r.responseTimeout} ms.)`)),r.responseTimeout),n.unref());function c(...f){if(n&&clearTimeout(n),f[0]==null){i(f[1]);return}a.socket?.emit("agentRemove");let u=f[0];u instanceof W||(u=new W(e,u.message)),a.destroy(),o(u)}s(c,"done"),a.on("error",c),a.end(t)})}s(Ao,"fetchJson");function fp(e,r,t){return async n=>{bo(e,r,t["content-type"]);let i=[];for await(let o of n)i.push(o);try{return We(new Ro.TextDecoder("utf8",{fatal:!0,ignoreBOM:!0}).decode(Buffer.concat(i)))}catch(o){throw new H(e,o)}}}s(fp,"getJsonDestination");var Cr;(function(e){e.RS256="RSA-SHA256",e.RS384="RSA-SHA384",e.RS512="RSA-SHA512"})(Cr||(Cr={}));var q={fetchJson:Ao,transformJwkToKeyObjectSync:s(e=>(0,Ie.createPublicKey)({key:At(Buffer.from(e.n,"base64"),Buffer.from(e.e,"base64")),format:"der",type:"spki"}),"transformJwkToKeyObjectSync"),transformJwkToKeyObjectAsync:s(async e=>(0,Ie.createPublicKey)({key:At(Buffer.from(e.n,"base64"),Buffer.from(e.e,"base64")),format:"der",type:"spki"}),"transformJwkToKeyObjectAsync"),parseB64UrlString:s(e=>Buffer.from(e,"base64").toString("utf8"),"parseB64UrlString"),verifySignatureSync:s(({alg:e,keyObject:r,jwsSigningInput:t,signature:n})=>(0,Ie.createVerify)(Cr[e]).update(t).verify(r,n,"base64"),"verifySignatureSync"),verifySignatureAsync:s(async({alg:e,keyObject:r,jwsSigningInput:t,signature:n})=>(0,Ie.createVerify)(Cr[e]).update(t).verify(r,n,"base64"),"verifySignatureAsync"),defaultFetchTimeouts:{socketIdle:500,response:1500},setTimeoutUnref:s((...e)=>setTimeout(...e).unref(),"setTimeoutUnref")};var Jr=q.fetchJson,kr=class{static{s(this,"SimpleJsonFetcher")}constructor(r){this.defaultRequestOptions={timeout:q.defaultFetchTimeouts.socketIdle,responseTimeout:q.defaultFetchTimeouts.response,...r?.defaultRequestOptions}}async fetch(r,t,n){t={...this.defaultRequestOptions,...t};try{return await Jr(r,t,n)}catch(i){if(i instanceof H)throw i;return Jr(r,t,n)}}};function ce(e,r,t,n=F){if(!r)throw new n(`Missing ${e}. Expected: ${t}`,r,t);if(typeof r!="string")throw new n(`${e} is not of type string`,r,t);if(t!==r)throw new n(`${e} not allowed: ${r}. Expected: ${t}`,r,t)}s(ce,"assertStringEquals");function M(e,r,t,n=F){if(!r)throw new n(`Missing ${e}. ${Tt(t)}`,r,t);if(typeof r!="string")throw new n(`${e} is not of type string`,r,t);return xe(e,r,t,n)}s(M,"assertStringArrayContainsString");function xe(e,r,t,n=F){if(!r)throw new n(`Missing ${e}. ${Tt(t)}`,r,t);let i=new Set(Array.isArray(t)?t:[t]);if(typeof r=="string"&&(r=[r]),!Array.isArray(r))throw new n(`${e} is not an array`,r,t);if(!r.some(a=>{if(typeof a!="string")throw new n(`${e} includes elements that are not of type string`,r,t);return i.has(a)}))throw new n(`${e} not allowed: ${r.join(", ")}. ${Tt(t)}`,r,t)}s(xe,"assertStringArraysOverlap");function Tt(e){return Array.isArray(e)?e.length>1?`Expected one of: ${e.join(", ")}`:`Expected: ${e[0]}`:`Expected: ${e}`}s(Tt,"expectationMessage");function To(e,r){if(e&&typeof e.then=="function")throw r()}s(To,"assertIsNotPromise");var lp=["use","alg","kid","n","e"],hp=["kty"];function Re(e,r){return e.keys.find(t=>t.kid!=null&&t.kid===r)}s(Re,"findJwkInJwks");async function pp(e){let r=await Jr(e);return Ot(r),r}s(pp,"fetchJwks");async function $o(e,r){if(!r.header.kid)throw new ve("JWT header does not have valid kid claim");let t=await pp(e),n=Re(t,r.header.kid);if(!n)throw new Y(`JWK for kid "${r.header.kid}" not found in the JWKS`);return n}s($o,"fetchJwk");function Ot(e){if(!e)throw new ie("JWKS empty");if(!be(e))throw new ie("JWKS should be an object");if(!Object.keys(e).includes("keys"))throw new ie("JWKS does not include keys");if(!Array.isArray(e.keys))throw new ie("JWKS keys should be an array");for(let r of e.keys)No(r)}s(Ot,"assertIsJwks");function Oo(e){if(ce("JWK use",e.use,"sig",jr),ce("JWK kty",e.kty,"RSA",Pr),!e.n)throw new K("Missing modulus (n)");if(!e.e)throw new K("Missing exponent (e)")}s(Oo,"assertIsRsaSignatureJwk");function No(e){if(!e)throw new K("JWK empty");if(!be(e))throw new K("JWK should be an object");for(let r of hp)if(typeof e[r]!="string")throw new K(`JWK ${r} should be a string`);for(let r of lp)if(r in e&&typeof e[r]!="string")throw new K(`JWK ${r} should be a string`)}s(No,"assertIsJwk");function Lo(e){try{return Ot(e),!0}catch{return!1}}s(Lo,"isJwks");function qo(e){try{return No(e),!0}catch{return!1}}s(qo,"isJwk");var $t=class{static{s(this,"SimplePenaltyBox")}constructor(r){this.waitingUris=new Map,this.waitSeconds=r?.waitSeconds??10}async wait(r){if(this.waitingUris.has(r))throw new Lr("Not allowed to fetch JWKS yet, still waiting for back off period to end")}release(r){let t=this.waitingUris.get(r);t&&(clearTimeout(t),this.waitingUris.delete(r))}registerFailedAttempt(r){let t=q.setTimeoutUnref(()=>{this.waitingUris.delete(r)},this.waitSeconds*1e3);this.waitingUris.set(r,t)}registerSuccessfulAttempt(r){this.release(r)}},Br=class{static{s(this,"SimpleJwksCache")}constructor(r){this.jwksCache=new Map,this.fetchingJwks=new Map,this.penaltyBox=r?.penaltyBox??new $t,this.fetcher=r?.fetcher??new kr}addJwks(r,t){this.jwksCache.set(r,t)}async getJwks(r){let t=this.fetchingJwks.get(r);if(t)return t;let n=this.fetcher.fetch(r).then(o=>(Ot(o),o));this.fetchingJwks.set(r,n);let i;try{i=await n}finally{this.fetchingJwks.delete(r)}return this.jwksCache.set(r,i),i}getCachedJwk(r,t){if(typeof t.header.kid!="string")throw new ve("JWT header does not have valid kid claim");if(!this.jwksCache.has(r))throw new qr(`JWKS for uri ${r} not yet available in cache`);let n=Re(this.jwksCache.get(r),t.header.kid);if(!n)throw new Y(`JWK for kid ${t.header.kid} not found in the JWKS`);return n}async getJwk(r,t){if(typeof t.header.kid!="string")throw new ve("JWT header does not have valid kid claim");let n=this.jwksCache.get(r);if(n){let a=Re(n,t.header.kid);if(a)return a}await this.penaltyBox.wait(r,t.header.kid);let i=await this.getJwks(r),o=Re(i,t.header.kid);if(o)this.penaltyBox.registerSuccessfulAttempt(r,t.header.kid);else throw this.penaltyBox.registerFailedAttempt(r,t.header.kid),new Y(`JWK for kid "${t.header.kid}" not found in the JWKS`);return o}};var jo=["RS256","RS384","RS512"];function dp(e){if(!be(e))throw new I("JWT header is not an object");if(e.alg!==void 0&&typeof e.alg!="string")throw new I("JWT header alg claim is not a string");if(e.kid!==void 0&&typeof e.kid!="string")throw new I("JWT header kid claim is not a string")}s(dp,"assertJwtHeader");function mp(e){if(!be(e))throw new I("JWT payload is not an object");if(e.exp!==void 0&&!Number.isFinite(e.exp))throw new I("JWT payload exp claim is not a number");if(e.iss!==void 0&&typeof e.iss!="string")throw new I("JWT payload iss claim is not a string");if(e.sub!==void 0&&typeof e.sub!="string")throw new I("JWT payload sub claim is not a string");if(e.aud!==void 0&&typeof e.aud!="string"&&(!Array.isArray(e.aud)||e.aud.some(r=>typeof r!="string")))throw new I("JWT payload aud claim is not a string or array of strings");if(e.nbf!==void 0&&!Number.isFinite(e.nbf))throw new I("JWT payload nbf claim is not a number");if(e.iat!==void 0&&!Number.isFinite(e.iat))throw new I("JWT payload iat claim is not a number");if(e.scope!==void 0&&typeof e.scope!="string")throw new I("JWT payload scope claim is not a string");if(e.jti!==void 0&&typeof e.jti!="string")throw new I("JWT payload jti claim is not a string")}s(mp,"assertJwtPayload");function Po(e){if(!e)throw new I("Empty JWT");if(typeof e!="string")throw new I("JWT is not a string");if(!e.match(/^[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+$/))throw new I("JWT string does not consist of exactly 3 parts (header, payload, signature)");let[r,t,n]=e.split("."),[i,o]=[r,t].map(q.parseB64UrlString),a;try{a=We(i)}catch(f){throw new I("Invalid JWT. Header is not a valid JSON object",f)}dp(a);let c;try{c=We(o)}catch(f){throw new I("Invalid JWT. Payload is not a valid JSON object",f)}return mp(c),{header:a,headerB64:r,payload:c,payloadB64:t,signatureB64:n}}s(Po,"decomposeUnverifiedJwt");function Nt(e,r){if(e.exp!==void 0&&e.exp+(r.graceSeconds??0)<Date.now()/1e3)throw new $r(`Token expired at ${new Date(e.exp*1e3).toISOString()}`,e.exp);if(e.nbf!==void 0&&e.nbf-(r.graceSeconds??0)>Date.now()/1e3)throw new Or(`Token can't be used before ${new Date(e.nbf*1e3).toISOString()}`,e.nbf);if(r.issuer!==null){if(r.issuer===void 0)throw new R("issuer must be provided or set to null explicitly");M("Issuer",e.iss,r.issuer,Se)}if(r.audience!==null){if(r.audience===void 0)throw new R("audience must be provided or set to null explicitly");xe("Audience",e.aud,r.audience,Ar)}r.scope!=null&&xe("Scope",e.scope?.split(" "),r.scope,Tr)}s(Nt,"validateJwtFields");function Co(e,r){Oo(r),r.alg&&ce("JWT signature algorithm",e.alg,r.alg,Fe),M("JWT signature algorithm",e.alg,jo,Fe)}s(Co,"validateJwtHeaderAndJwk");async function yp(e,r,t,n=$o,i=q.transformJwkToKeyObjectAsync){let{header:o,headerB64:a,payload:c,payloadB64:f,signatureB64:u}=e,h=await n(r,e);Co(e.header,h);let l=await i(h,o.alg,c.iss);if(!await q.verifySignatureAsync({jwsSigningInput:`${a}.${f}`,signature:u,alg:o.alg,keyObject:l}))throw new _e("Invalid signature");try{Nt(c,t),t.customJwtCheck&&await t.customJwtCheck({header:o,payload:c,jwk:h})}catch(y){throw t.includeRawJwtInErrors&&y instanceof T?y.withRawJwt(e):y}return c}s(yp,"verifyDecomposedJwt");function gp(e,r,t,n){let{header:i,headerB64:o,payload:a,payloadB64:c,signatureB64:f}=e,u;if(qo(r))u=r;else if(Lo(r)){let w=i.kid?Re(r,i.kid):void 0;if(!w)throw new Y(`JWK for kid ${i.kid} not found in the JWKS`);u=w}else throw new R([`Expected a valid JWK or JWKS (parsed as JavaScript object), but received: ${r}.`,"If you're passing a JWKS URI, use the async verify() method instead, it will download and parse the JWKS for you"].join());Co(e.header,u);let h=n(u,i.alg,a.iss);if(!q.verifySignatureSync({jwsSigningInput:`${o}.${c}`,signature:f,alg:i.alg,keyObject:h}))throw new _e("Invalid signature");try{if(Nt(a,t),t.customJwtCheck){let w=t.customJwtCheck({header:i,payload:a,jwk:u});To(w,()=>new R("Custom JWT checks must be synchronous but a promise was returned"))}}catch(w){throw t.includeRawJwtInErrors&&w instanceof T?w.withRawJwt(e):w}return a}s(gp,"verifyDecomposedJwtSync");var He=class{static{s(this,"JwtRsaVerifierBase")}constructor(r,t=new Br){if(this.jwksCache=t,this.issuersConfig=new Map,this.publicKeyCache=new Lt,Array.isArray(r)){if(!r.length)throw new R("Provide at least one issuer configuration");for(let n of r){if(this.issuersConfig.has(n.issuer))throw new R(`issuer ${n.issuer} supplied multiple times`);this.issuersConfig.set(n.issuer,this.withJwksUri(n))}}else this.issuersConfig.set(r.issuer,this.withJwksUri(r))}get expectedIssuers(){return Array.from(this.issuersConfig.keys())}getIssuerConfig(r){if(!r){if(this.issuersConfig.size!==1)throw new R("issuer must be provided");r=this.issuersConfig.keys().next().value}let t=this.issuersConfig.get(r);if(!t)throw new R(`issuer not configured: ${r}`);return t}cacheJwks(...[r,t]){let n=this.getIssuerConfig(t);this.jwksCache.addJwks(n.jwksUri,r),this.publicKeyCache.clearCache(n.issuer)}async hydrate(){let r=this.expectedIssuers.map(t=>this.getIssuerConfig(t).jwksUri).map(t=>this.jwksCache.getJwks(t));await Promise.all(r)}verifySync(...[r,t]){let{decomposedJwt:n,jwksUri:i,verifyProperties:o}=this.getVerifyParameters(r,t);return this.verifyDecomposedJwtSync(n,i,o)}verifyDecomposedJwtSync(r,t,n){let i=this.jwksCache.getCachedJwk(t,r);return gp(r,i,n,this.publicKeyCache.transformJwkToKeyObjectSync.bind(this.publicKeyCache))}async verify(...[r,t]){let{decomposedJwt:n,jwksUri:i,verifyProperties:o}=this.getVerifyParameters(r,t);return this.verifyDecomposedJwt(n,i,o)}verifyDecomposedJwt(r,t,n){return yp(r,t,n,this.jwksCache.getJwk.bind(this.jwksCache),this.publicKeyCache.transformJwkToKeyObjectAsync.bind(this.publicKeyCache))}getVerifyParameters(r,t){let n=Po(r);M("Issuer",n.payload.iss,this.expectedIssuers,Se);let i=this.getIssuerConfig(n.payload.iss);return{decomposedJwt:n,jwksUri:i.jwksUri,verifyProperties:{...i,...t}}}withJwksUri(r){if(r.jwksUri)return r;let t=new URL(r.issuer).pathname.replace(/\/$/,"");return{jwksUri:new URL(`${t}/.well-known/jwks.json`,r.issuer).href,...r}}},Me=class extends He{static{s(this,"JwtRsaVerifier")}static create(r,t){return new this(r,t?.jwksCache)}},Lt=class{static{s(this,"KeyObjectCache")}constructor(r=q.transformJwkToKeyObjectSync,t=q.transformJwkToKeyObjectAsync){this.transformJwkToKeyObjectSyncFn=r,this.transformJwkToKeyObjectAsyncFn=t,this.publicKeys=new Map}transformJwkToKeyObjectSync(r,t,n){let i=r.alg??t;if(!n||!r.kid||!i)return this.transformJwkToKeyObjectSyncFn(r,i,n);let o=this.publicKeys.get(n)?.get(r.kid)?.get(i);if(o)return o;let a=this.transformJwkToKeyObjectSyncFn(r,i,n);return this.putKeyObjectInCache(n,r.kid,i,a),a}async transformJwkToKeyObjectAsync(r,t,n){let i=r.alg??t;if(!n||!r.kid||!i)return this.transformJwkToKeyObjectAsyncFn(r,i,n);let o=this.publicKeys.get(n)?.get(r.kid)?.get(i);if(o)return o;let a=await this.transformJwkToKeyObjectAsyncFn(r,i,n);return this.putKeyObjectInCache(n,r.kid,i,a),a}putKeyObjectInCache(r,t,n,i){let o=this.publicKeys.get(r),a=o?.get(t);a?a.set(n,i):o?o.set(t,new Map([[n,i]])):this.publicKeys.set(r,new Map([[t,new Map([[n,i]])]]))}clearCache(r){this.publicKeys.delete(r)}};function Jo(e,r){if(r.groups!=null&&xe("Cognito group",e["cognito:groups"],r.groups,Nr),M("Token use",e.token_use,["id","access"],Ue),r.tokenUse!==null){if(r.tokenUse===void 0)throw new R("tokenUse must be provided or set to null explicitly");ce("Token use",e.token_use,r.tokenUse,Ue)}if(r.clientId!==null){if(r.clientId===void 0)throw new R("clientId must be provided or set to null explicitly");e.token_use==="id"?M('Client ID ("audience")',e.aud,r.clientId,Ve):M("Client ID",e.client_id,r.clientId,Ve)}}s(Jo,"validateCognitoJwtFields");var Xe=class e extends He{static{s(this,"CognitoJwtVerifier")}constructor(r,t){let n=Array.isArray(r)?r.map(i=>({...i,...e.parseUserPoolId(i.userPoolId),audience:null})):{...r,...e.parseUserPoolId(r.userPoolId),audience:null};super(n,t)}static parseUserPoolId(r){let t=r.match(/^(?<region>(\w+-)?\w+-\w+-\d)+_\w+$/);if(!t)throw new R(`Invalid Cognito User Pool ID: ${r}`);let i=`https://cognito-idp.${t.groups.region}.amazonaws.com/${r}`;return{issuer:i,jwksUri:`${i}/.well-known/jwks.json`}}static create(r,t){return new this(r,t?.jwksCache)}verifySync(...[r,t]){let{decomposedJwt:n,jwksUri:i,verifyProperties:o}=this.getVerifyParameters(r,t);this.verifyDecomposedJwtSync(n,i,o);try{Jo(n.payload,o)}catch(a){throw o.includeRawJwtInErrors&&a instanceof T?a.withRawJwt(n):a}return n.payload}async verify(...[r,t]){let{decomposedJwt:n,jwksUri:i,verifyProperties:o}=this.getVerifyParameters(r,t);await this.verifyDecomposedJwt(n,i,o);try{Jo(n.payload,o)}catch(a){throw o.includeRawJwtInErrors&&a instanceof T?a.withRawJwt(n):a}return n.payload}cacheJwks(...[r,t]){let n;if(t!==void 0)n=e.parseUserPoolId(t).issuer;else if(this.expectedIssuers.length>1)throw new R("userPoolId must be provided");let i=this.getIssuerConfig(n);super.cacheJwks(r,i.issuer)}};var Bo=s(e=>async r=>{try{let t=process.env.ISSUERS.split(","),n=r.headers,i=n.authorization||n.Authorization;if(!i)throw new Error("No authorization header provided");let o=i.replace("Bearer ",""),a=ko.decode(o,{complete:!0});if(!a)throw new Error("Token failed to decode");if(typeof a.payload=="string")throw new Error("Decoded token payload is a string");if(!a.payload.sub)throw new Error("Token does not contain a sub");let c=a.payload.iss;if(c?.includes("cognito")&&t.includes(c)){if(!await Xe.create([{userPoolId:process.env.CONNECT_USER_POOL??"",tokenUse:"access",clientId:process.env.CLIENT_ID??""}]).verify(o))throw new Error("Token failed to verify")}else if(c?.includes("auth0")&&t.includes(c)){if(!a.payload.aud)throw new Error("Token does not contain an aud");if(!Me.create([{issuer:c,audience:a?.payload.aud,jwksUri:`${c}/.well-known/jwks.json`}]).verify(o))throw new Error("Token failed to verify")}else throw new Error(`Invalid issuer [${c}]`);return e&&await e(r,a),{principalId:a.payload.sub,policyDocument:{Version:"2012-10-17",Statement:[{Action:"execute-api:Invoke",Effect:"Allow",Resource:r.methodArn}]}}}catch(t){return console.error("Error:",t),{principalId:"user",policyDocument:{Version:"2012-10-17",Statement:[{Action:"execute-api:Invoke",Effect:"Deny",Resource:r.methodArn}]}}}},"authorizerHandler");var wp=Bo();0&&(module.exports={handler});
/*! Bundled license information:

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)
*/
