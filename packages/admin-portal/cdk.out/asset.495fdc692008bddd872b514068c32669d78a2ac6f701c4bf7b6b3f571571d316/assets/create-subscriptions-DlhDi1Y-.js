import{r as c,j as o,aa as y,ai as U,ao as T,ap as j,as as L,v as S}from"./vendor-ZH71Hs13.js";import{r as p,o as N,u as w,g as O,G as P,a as b,U as B}from"./index-CnnFfG24.js";import{u as f}from"./use-reapit-update-BDOupWKb.js";import{u as _}from"./use-permissions-state-DNuR5f40.js";import{u as k}from"./index.esm-Ch-ie6LE.js";const G=(i,s,t,a,n)=>()=>{if(i!=null&&i.data&&s==="applicationListing"&&n){const e=i.data.find(r=>r.type==="applicationListing"&&!r.cancelled&&n===r.applicationId)??null;t(e),a({isSubscribed:e?"SUBSCRIBED":"NOT_SUBSCRIBED"})}if(i!=null&&i.data&&s==="developerRegistration"){const e=i.data.find(r=>r.type==="developerRegistration"&&!r.cancelled)??null;t(e),a({isSubscribed:e?"SUBSCRIBED":"NOT_SUBSCRIBED"})}},$=(i,s)=>()=>{i(s)},q=i=>()=>{i()},A=(i,s)=>()=>{s&&i()},z=(i,s)=>({isSubscribed:t})=>{t==="SUBSCRIBED"?i():s()},H=(i,s,t)=>()=>{const a=t(z(i,s));return()=>a.unsubscribe()},K=({subscriptionType:i,developerId:s,appId:t})=>{const{connectSession:a}=_(p),n=a==null?void 0:a.loginIdentity.email,[e,r]=c.useState(null),{register:m,watch:I,reset:g}=k(),C=N({developerId:s,subscriptionType:i}),[d,,,E]=w({reapitConnectBrowserSession:p,action:O[P.getSubscriptions],queryParams:{...C,pageSize:999}}),[,,h,u]=f({reapitConnectBrowserSession:p,action:b[B.deleteSubscription],method:"DELETE",uriParams:{subscriptionId:e==null?void 0:e.id}}),[,,R,l]=f({reapitConnectBrowserSession:p,action:b[B.createSubscription],method:"POST"}),v=u||l,D=$(R,{developerId:s,applicationId:t,user:n,type:i}),x=q(h);return c.useEffect(G(d,i,r,g,t),[d,i,t]),c.useEffect(A(E,v),[u,l]),c.useEffect(H(D,x,I),[d,e]),o.jsx("form",{children:o.jsx(y,{className:U,children:o.jsxs(T,{children:[o.jsxs(j,{children:["Is Subscribed ",i==="applicationListing"?"Application Listing":"Developer Registration"]}),o.jsx(L,{...m("isSubscribed"),hasGreyBg:!0,options:[{id:`option-subscribed-true-${S()}`,value:"SUBSCRIBED",text:"Subscribed",isChecked:!!e},{id:`option-subscribed-false-${S()}`,value:"NOT_SUBSCRIBED",text:"Not Subscribed",isChecked:e===null}]})]})})})};export{K as C};
