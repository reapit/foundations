import{n as K,o as N,r as O,aK as R,t as g}from"./vendor-ZH71Hs13.js";import{b as f,h as y,c as k,d as A,N as B,l as D}from"./index-CnnFfG24.js";const H=({action:r,method:S="POST",returnType:l="none",headers:E={},uriParams:o,withCredentials:v,reapitConnectBrowserSession:p})=>{const{error:C,success:M}=K(),P=N(),{successMessage:h,errorMessage:m}=r,n=O.useMemo(f(r,void 0,o),[o,r]);console.log("url",n);const{mutateAsync:T,error:w,data:b,isSuccess:L,isLoading:x}=R([n,o],{mutationFn:async s=>{const{data:a,options:e}=s,d={...E,...(e==null?void 0:e.headers)??{}},t=e!=null&&e.uriParams?f(r,void 0,{...o,...e.uriParams})():n,u=await k(p,d);if(!u)throw new Error("Missing valid Reapit Connect Session, please try logging in again.");const i=await g(t,{method:S,headers:u,data:a,withCredentials:v});if(l==="response")return i.data;if(l==="location"&&i.headers){const c=i.headers.location;if(!c)throw new Error("Location was not returned by server");const G=c.includes(".prod.paas")?c.replace(".prod.paas",""):c;return(await g(G,{method:"GET",headers:u})).data}return console.log("response",i,n),!0},onSuccess:()=>{h&&M(h,1e5)},onError:async s=>{const a=await p.connectSession(),e=s.message===A,d=s.code===B;if(e||d||!a)return P("/login");const t=y(s,m);C(t,5e3),D(new Error(t),a)}}),F=w?y(w,m):null;return[x,b,(s,a)=>T({data:s,options:a}),L,F]};export{H as u};
