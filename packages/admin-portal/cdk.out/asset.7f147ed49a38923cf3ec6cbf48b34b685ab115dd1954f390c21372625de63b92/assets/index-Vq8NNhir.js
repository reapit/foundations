import{j as e,a7 as ie,a8 as N,ae as E,z as x,i as oe,af as ge,r as c,a9 as Z,B as $,aa as M,g as ee,L as J,ab as de,k as P,c as i,e as fe,F as O,ad as ce,y as k,ag as we,ah as ye,d as me,W as Te,ac as Se}from"./vendor-troV5kp-.js";import{E as Ce}from"./index-7TJbm2qB.js";import{u as ue,t as R,a as De}from"./index.esm-zVN26rm4.js";import{f as Me}from"./index-tSHtSDOC.js";import{u as ae,r as v,g as se,G as le,a as F,U as A,o as ke}from"./index-7tW5-Pg7.js";import{S as Ie}from"./index-1k5r5oX4.js";import{C as Le}from"./create-subscriptions-uFj9BO_G.js";import{u as U}from"./use-reapit-update-Z5Casrho.js";import{a as pe,u as Ne}from"./use-permissions-state-3iXP9x9E.js";import{c as he,a as T,o as be}from"./yup-pS53ROqe.js";import{p as Ee,e as Pe,l as Re}from"./regexs-Ux5wzQ2i.js";import"./FileSaver.min-JSyqwKbI.js";const Fe=({setDeveloperFilters:a})=>{const{register:s,handleSubmit:l}=ue({mode:"onChange"});return e.jsx("form",{onChange:l(Me(a,500)),children:e.jsxs(ie,{className:N,children:[e.jsx(E,{children:e.jsx(x,{...s("name"),label:"Developer Name",type:"search"})}),e.jsx(E,{children:e.jsx(x,{...s("company"),label:"Company Name",type:"search"})}),e.jsx(E,{children:e.jsx(x,{...s("gitHubUsername"),label:"Github Username",type:"search"})}),e.jsx(E,{children:e.jsx(x,{...s("registeredFrom"),label:"Registered From",type:"date"})}),e.jsx(E,{children:e.jsx(x,{...s("registeredTo"),label:"Registered To",type:"date"})}),e.jsx(E,{children:e.jsxs(x,{children:[e.jsx(oe,{children:"Status"}),e.jsx(x,{children:e.jsxs(ge,{...s("status"),children:[e.jsx("option",{value:"",children:"Please Select"}),e.jsx("option",{value:"incomplete",children:"Incomplete"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"underReview",children:"Under Review"}),e.jsx("option",{value:"removed",children:"Removed"})]})})]})})]})})},Ae=(a,s)=>()=>{s&&a(s)},Ue=(a,s)=>()=>{s&&a(s)},xe=(a,s)=>()=>{a(s)},Be=(a,s,l)=>()=>{(s||l)&&a()},Ge=(a,s,l)=>()=>{l&&(a(l),s())},We=(a,s,l)=>async()=>{await l()&&(s(),a(null))},He=({devIdMembers:a})=>{var _,K;const[s,l]=c.useState(null),[t,o]=c.useState(1),[m,r]=c.useState(null),[n,u]=c.useState(null),{hasReadAccess:p}=pe(),{Modal:g,openModal:j,closeModal:h}=Z(),[d,w,,B]=ae({reapitConnectBrowserSession:v,action:se[le.getDeveloperMembers],uriParams:{developerId:a,memberId:s==null?void 0:s.id},queryParams:{pageNumber:t,pageSize:12},fetchWhenTrue:[a]}),[f,I]=ae({reapitConnectBrowserSession:v,action:se[le.getUserInfo],queryParams:{email:encodeURIComponent(m??""),includeIdpData:!0},fetchWhenTrue:[m]}),[y,,re,G]=U({reapitConnectBrowserSession:v,action:F[A.updateMember],method:"PUT",uriParams:{developerId:a,memberId:s==null?void 0:s.id}}),[,,V,Y]=U({reapitConnectBrowserSession:v,action:F[A.deleteMember],method:"DELETE",uriParams:{developerId:n==null?void 0:n.developerId,memberId:n==null?void 0:n.id}});c.useEffect(Be(B,G,Y),[G,Y]),c.useEffect(Ae(re,s),[s]);const S=((_=f==null?void 0:f.idpData)==null?void 0:_.authEvents)??[];return w?e.jsx($,{}):(K=d==null?void 0:d.data)!=null&&K.length?e.jsxs("div",{className:M,children:[e.jsx(ee,{children:"Total Members"}),e.jsx(J,{hasGreyText:!0,children:d.totalCount}),e.jsx(de,{className:N,rows:d.data.map(C=>{var X,q;const{name:W,jobTitle:te,status:H,role:b,gitHubUsername:ne,agreedTerms:L,created:Q,email:D}=C;return{cells:[{label:"Developer Name",value:W,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Member Email",value:D,narrowTable:{showLabel:!0}},{label:"Job Title",value:te,narrowTable:{showLabel:!0}},{label:"Role",value:b,narrowTable:{showLabel:!0}},{label:"Github Username",value:ne,narrowTable:{showLabel:!0}},{label:"Member Status",value:H,narrowTable:{showLabel:!0}},{label:"Agreed Terms Date",value:L?R(L):"-",narrowTable:{showLabel:!0}},{label:"Created Date",value:Q?R(Q):"-",narrowTable:{showLabel:!0}}],expandableContent:{content:e.jsxs(e.Fragment,{children:[e.jsxs(P,{alignment:"center",children:[e.jsxs(i,{intent:"primary",disabled:p||y,loading:y,onClick:xe(l,{...C,role:b==="admin"?"user":"admin"}),children:["Set As ",b==="admin"?"User":"Admin"]}),e.jsx(i,{intent:"primary",disabled:I,loading:I,onClick:Ue(r,D),children:"Get Login Info"}),e.jsx(i,{type:"button",intent:"danger",disabled:p,onClick:Ge(u,j,C),children:"Delete Member"}),e.jsx(i,{intent:"danger",disabled:p||y,loading:y,onClick:xe(l,{...C,status:H==="active"?"inactive":"active"}),children:H==="active"?"Disable":"Enable"})]}),I&&e.jsx($,{className:M}),f&&m===D&&S.length?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:M,children:"Recent Logins"}),(q=(X=f.idpData)==null?void 0:X.authEvents)==null?void 0:q.map((z,ve)=>ve<5?e.jsx(fe,{hasGreyText:!0,children:z},z):null)]}):f&&m===D?e.jsx(O,{className:M,isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"No login information for user"}):null]})}}})}),e.jsx(ce,{callback:o,currentPage:t,numberPages:Math.ceil(((d==null?void 0:d.totalCount)??1)/12)}),e.jsxs(g,{title:"Delete Member",children:[e.jsx(J,{hasGreyText:!0,children:"Are you sure you want to delete this member? This action cannot be undone."}),e.jsxs(P,{alignment:"right",children:[e.jsx(i,{onClick:h,children:"Cancel"}),e.jsx(i,{intent:"danger",onClick:We(u,h,V),children:"Delete"})]})]})]}):e.jsx(O,{className:M,isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"No results found for your selected filters"})},qe=he().shape({status:T().trim().required(),reapitReference:T().trim().when("status",{is:a=>a=="confirmed",then:T().required().max(50,"Maximum of 50 characters allowed")}),notes:T().trim().max(200,"Maximum of 200 characters allowed")}),ze=(a,s)=>l=>{s&&a({...s,companyName:s.company,...l})},Je=(a,s,l,t)=>()=>{t&&(a(),s(null),l())},Oe=({developer:a,closeModal:s,setDeveloperUpdate:l,refreshDevelopers:t})=>{var j,h;const{register:o,handleSubmit:m,control:r,formState:{errors:n}}=ue({resolver:be(qe),defaultValues:{status:a==null?void 0:a.status,reapitReference:a==null?void 0:a.reapitReference,notes:a==null?void 0:a.notes}}),[,,u,p]=U({reapitConnectBrowserSession:v,action:F[A.updateDeveloper],method:"PUT",uriParams:{developerId:a==null?void 0:a.id}});c.useEffect(Je(t,l,s,p),[p]);const g=De({control:r,name:"status"});return a?e.jsxs("form",{onSubmit:m(ze(u,a)),children:[e.jsxs(ie,{className:N,children:[e.jsxs(k,{children:[e.jsx(oe,{children:"Update Developer Status"}),e.jsx(we,{...o("status"),hasGreyBg:!0,options:[{id:"option-status-incomplete",value:"incomplete",text:"Incomplete",isChecked:a.status==="incomplete"},{id:"option-status-pending",value:"pending",text:"Pending",isChecked:a.status==="pending"},{id:"option-status-confirmed",value:"confirmed",text:"Confirmed",isChecked:a.status==="confirmed"},{id:"option-status-underReview",value:"underReview",text:"Under Review",isChecked:a.status==="underReview"},{id:"option-status-removed",value:"removed",text:"Removed",isChecked:a.status==="removed"}]})]}),e.jsx(k,{children:e.jsx(x,{...o("reapitReference"),label:"Reapit Reference",placeholder:"Reapit Reference if account confirmed",errorMessage:(j=n==null?void 0:n.reapitReference)==null?void 0:j.message,icon:(h=n==null?void 0:n.reapitReference)!=null&&h.message?"asteriskSystem":null,intent:"danger",disabled:g!=="confirmed"})}),e.jsx(k,{children:e.jsxs(x,{children:[e.jsx(ye,{type:"text",...o("notes"),placeholder:"Notes on developer"}),e.jsx(oe,{children:"Notes"})]})})]}),e.jsxs(P,{alignment:"right",children:[e.jsx(i,{onClick:s,children:"Cancel"}),e.jsx(i,{intent:"primary",type:"submit",children:"Confirm"})]})]}):null},Ve=({devIdApps:a})=>{var m;const[s,l]=c.useState(1),[t,o]=ae({reapitConnectBrowserSession:v,action:se[le.getApps],queryParams:{pageNumber:s,pageSize:12,developerId:a},fetchWhenTrue:[a]});return o?e.jsx($,{}):(m=t==null?void 0:t.data)!=null&&m.length?e.jsxs("div",{className:M,children:[e.jsx(ee,{children:"Total Apps"}),e.jsx(J,{hasGreyText:!0,children:t.totalCount}),e.jsx(de,{className:N,rows:t.data.map(({name:r,id:n,summary:u,isListed:p,isDirectApi:g,isFeatured:j,created:h,publicListedDate:d})=>({cells:[{label:"App Name",value:r??"",cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"AppId",value:n??"",narrowTable:{showLabel:!0}},{label:"Summary",value:u??"",narrowTable:{showLabel:!0}},{label:"Listed",value:e.jsx(me,{icon:p?"check":"close"}),narrowTable:{showLabel:!0}},{label:"Integration",value:e.jsx(me,{icon:g?"check":"close"}),narrowTable:{showLabel:!0}},{label:"Featured",value:e.jsx(me,{icon:j?"check":"close"}),narrowTable:{showLabel:!0}},{label:"Created",value:R(h)??"",narrowTable:{showLabel:!0}},{label:"Publicly Listed",value:d?R(d):"-",narrowTable:{showLabel:!0}}],expandableContent:{content:e.jsx(O,{isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"Visit the dedicated apps page to perform actions on this app"})}}))}),e.jsx(ce,{callback:l,currentPage:s,numberPages:Math.ceil(((t==null?void 0:t.totalCount)??1)/12)})]}):e.jsx("div",{className:M,children:e.jsx(O,{isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"No results found for your selected filters"})})},Ye=he().shape({name:T().trim().required().matches(Ee,"Full name is not valid").max(256,"Maximum character length of 256"),email:T().trim().required().matches(Pe,"Email address is not valid").max(256,"Maximum character length of 256"),jobTitle:T().trim().required().matches(Re,"Job title is not valid").max(256,"Maximum character length of 256"),message:T().trim()}),_e=(a,s)=>async l=>{await a(l)&&s()},Ke=({developerId:a,closeModal:s})=>{var n,u,p,g,j,h,d,w;const{connectSession:l}=Ne(v),[,,t]=U({reapitConnectBrowserSession:v,action:F[A.inviteMember],method:"POST",uriParams:{developerId:a}}),{register:o,handleSubmit:m,formState:{errors:r}}=ue({resolver:be(Ye),defaultValues:{name:"",email:"",jobTitle:"",message:"",sender:l==null?void 0:l.loginIdentity.email}});return e.jsxs("form",{onSubmit:m(_e(t,s)),children:[e.jsxs(ie,{hasMargin:!0,children:[e.jsx(k,{children:e.jsx(x,{...o("name"),label:"Name",placeholder:"Your colleague's full name",errorMessage:(n=r==null?void 0:r.name)==null?void 0:n.message,icon:(u=r==null?void 0:r.name)!=null&&u.message?"asteriskSystem":null,intent:"danger"})}),e.jsx(k,{children:e.jsx(x,{...o("email"),type:"email",label:"Email",placeholder:"An email address we can contact your colleague at",errorMessage:(p=r==null?void 0:r.email)==null?void 0:p.message,icon:(g=r==null?void 0:r.email)!=null&&g.message?"asteriskSystem":null,intent:"danger"})}),e.jsx(k,{children:e.jsx(x,{...o("jobTitle"),label:"Job Title",placeholder:"Your colleague's role at your company'",errorMessage:(j=r==null?void 0:r.jobTitle)==null?void 0:j.message,icon:(h=r==null?void 0:r.jobTitle)!=null&&h.message?"asteriskSystem":null,intent:"danger"})}),e.jsx(k,{children:e.jsx(x,{...o("message"),label:"Invite Message",placeholder:"An optional invite message",errorMessage:(d=r==null?void 0:r.message)==null?void 0:d.message,icon:(w=r==null?void 0:r.message)!=null&&w.message?"asteriskSystem":null,intent:"danger"})})]}),e.jsxs(P,{alignment:"right",children:[e.jsx(i,{onClick:s,children:"Close"}),e.jsx(i,{intent:"primary",type:"submit",children:"Send Invite"})]})]})},Qe=(a,s,l)=>()=>{l&&(s(l),a())},Xe=(a,s,l,t)=>()=>{t&&(a(t),s(null),l(null))},Ze=(a,s,l,t)=>()=>{t&&(a(t),s(null),l(null))},$e=(a,s,l,t)=>()=>{t&&(a(t),s(null),l(null))},ea=(a,s,l)=>()=>{l&&(a(l),s())},aa=(a,s,l,t)=>async()=>{await l()&&(s(),a(null),t())},sa=(a,s,l,t)=>async()=>{const o=t?0:300;await s({...a,companyName:a.company,developerEditionSubscriptionCost:o},{uriParams:{developerId:a==null?void 0:a.id}})&&l()},la=(a,s,l,t)=>()=>{t&&(s(null),a(t),l())},ra=({developers:a,refreshDevelopers:s})=>{var C;const{Modal:l,openModal:t,closeModal:o}=Z(),{Modal:m,openModal:r,closeModal:n}=Z(),{Modal:u,openModal:p,closeModal:g}=Z(),[j,h]=c.useState(null),[d,w]=c.useState(null),[B,f]=c.useState(null),[I,y]=c.useState(null),[re,G]=c.useState(null),[V,Y]=c.useState(null),{hasReadAccess:S}=pe(),[,,_]=U({reapitConnectBrowserSession:v,action:F[A.updateDeveloper],method:"PUT"}),[,,K]=U({reapitConnectBrowserSession:v,action:F[A.deleteDeveloper],method:"DELETE",uriParams:{developerId:re}});return(C=a==null?void 0:a.data)!=null&&C.length?e.jsxs("div",{className:N,children:[e.jsx(ee,{children:"Total Developers"}),e.jsx(J,{hasGreyText:!0,children:a.totalCount}),e.jsx(de,{rows:a.data.map(W=>{const{company:te,name:H,id:b,jobTitle:ne,status:L,email:Q,agreedTerms:D,created:X,developerEditionSubscriptionCost:q}=W,z=!!(q===null||Math.round(q??0));return{cells:[{label:"Company Name",value:te,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Developer Name",value:H,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Developer Email",value:Q,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Job Title",value:ne,narrowTable:{showLabel:!0}},{label:"Account Status",value:L,narrowTable:{showLabel:!0}},{label:"Created Date",value:R(X),narrowTable:{showLabel:!0}},{label:"Agreed Terms Date",value:D?R(D):"-",narrowTable:{showLabel:!0}}],expandableContent:{content:e.jsxs(e.Fragment,{children:[e.jsxs(P,{alignment:"center",children:[e.jsx(i,{type:"button",intent:"primary",disabled:S,onClick:Qe(t,h,W),children:"Update Status"}),e.jsx(i,{type:"button",intent:"primary",disabled:S,onClick:sa(W,_,s,z),children:z?"Pays For DevEdition":"DevEdition is Free"}),e.jsxs(i,{onClick:$e(y,f,w,b),intent:"primary",disabled:S||L!=="confirmed",children:["Toggle Subscription ",L!=="confirmed"?"(Status Not Confirmed)":""]}),e.jsx(i,{onClick:la(Y,w,p,b),intent:"primary",disabled:S,children:"Invite Member"}),e.jsx(i,{intent:"primary",onClick:Xe(w,y,f,b),children:"Fetch Members"}),e.jsx(i,{intent:"primary",onClick:Ze(f,y,w,b),children:"Fetch Apps"}),e.jsx(i,{type:"button",intent:"danger",disabled:S,onClick:ea(G,r,b),children:"Delete Developer"})]}),d&&d===b&&e.jsx(He,{devIdMembers:d}),B&&B===b&&e.jsx(Ve,{devIdApps:B}),I&&I===b&&e.jsx(Le,{developerId:b,subscriptionType:"developerRegistration"})]})}}})}),e.jsx(l,{title:"Update Developer Status",children:e.jsx(Oe,{developer:j,closeModal:o,setDeveloperUpdate:h,refreshDevelopers:s})}),e.jsxs(m,{title:"Delete Developer",children:[e.jsx(J,{hasGreyText:!0,children:"Are you sure you want to delete this developer? This action cannot be undone."}),e.jsxs(P,{alignment:"right",children:[e.jsx(i,{onClick:n,children:"Cancel"}),e.jsx(i,{intent:"danger",onClick:aa(G,n,K,s),children:"Delete"})]})]}),e.jsx(u,{title:"Invite Developer Org Member",children:V&&e.jsx(Ke,{developerId:V,closeModal:g})})]}):e.jsx("div",{className:N,children:e.jsx(O,{isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"No results found for your selected filters"})})},ta=a=>()=>{a(!1)},je=()=>{const[a,s]=c.useState({}),[l,t]=c.useState(1),[o,m]=c.useState(12),[r,n,,u]=ae({reapitConnectBrowserSession:v,action:se[le.getDevelopers],queryParams:{pageNumber:l,pageSize:o,...ke(a)}});return e.jsx(Ce,{children:e.jsxs(Te,{children:[e.jsx(Se,{children:"Developers"}),e.jsx(Fe,{setDeveloperFilters:s}),n?e.jsx($,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{area:"DEVELOPERS",data:r,setPageSize:m}),e.jsx(ra,{developers:r,refreshDevelopers:u}),e.jsx(ce,{callback:t,currentPage:l,numberPages:Math.ceil(((r==null?void 0:r.totalCount)??1)/12)})]})]})})};export{je as DevsManagement,ta as closeDisableMemberModal,je as default};
