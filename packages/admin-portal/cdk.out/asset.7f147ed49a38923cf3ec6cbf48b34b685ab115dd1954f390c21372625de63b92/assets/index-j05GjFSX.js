import{j as e,a7 as A,ae as o,z as t,i as j,af as x,r,a9 as G,W as H,ac as O,B as W,ab as $,a8 as J,ad as K,L as Q,k as V,c as S}from"./vendor-troV5kp-.js";import{E as X}from"./index-7TJbm2qB.js";import{u as Y,t as c}from"./index.esm-zVN26rm4.js";import{u as Z,r as v,g as _,G as ee,o as ae,a as se,U as le}from"./index-7tW5-Pg7.js";import{u as ne}from"./use-reapit-update-Z5Casrho.js";import{f as re}from"./index-tSHtSDOC.js";import{S as ie}from"./index-1k5r5oX4.js";import{a as oe}from"./use-permissions-state-3iXP9x9E.js";import"./FileSaver.min-JSyqwKbI.js";const te=({setSubscriptionsFilters:s})=>{const{register:a,handleSubmit:l}=Y({mode:"all"});return e.jsx("form",{onChange:l(re(s,500)),children:e.jsxs(A,{hasMargin:!0,children:[e.jsx(o,{children:e.jsx(t,{...a("organisationName"),label:"Company Name"})}),e.jsx(o,{children:e.jsx(t,{...a("userEmail"),type:"email",label:"User Email"})}),e.jsx(o,{children:e.jsxs(t,{children:[e.jsx(j,{children:"Subscription Type"}),e.jsxs(x,{...a("subscriptionType"),children:[e.jsx("option",{value:"",children:"Please Select"}),e.jsx("option",{value:"applicationListing",children:"Application Listing"}),e.jsx("option",{value:"developerRegistration",children:"Developer Registration"}),e.jsx("option",{value:"developerEdition",children:"Developer Edition"})]})]})}),e.jsx(o,{children:e.jsxs(t,{children:[e.jsx(j,{children:"Status"}),e.jsxs(x,{...a("status"),children:[e.jsx("option",{value:"",children:"Please Select"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})})]})})},w=(s,a)=>async()=>{await s()&&a(null)},C=(s,a,l)=>()=>{l&&(s(),a())},g=(s,a,l)=>()=>{l&&(a(),s(l))},ce=()=>{var b;const[s,a]=r.useState({}),[l,f]=r.useState(1),[y,T]=r.useState(12),[E,u]=r.useState(null),{Modal:L,openModal:P,closeModal:d}=G(),{hasReadAccess:h}=oe(),[n,N,,k]=Z({reapitConnectBrowserSession:v,action:_[ee.getSubscriptions],queryParams:{...ae(s),userEmail:s.userEmail?encodeURIComponent(s.userEmail??""):void 0,pageSize:y,pageNumber:l}}),[,,M,p]=ne({reapitConnectBrowserSession:v,action:se[le.deleteSubscription],method:"DELETE",uriParams:{subscriptionId:E}});return r.useEffect(C(k,d,p),[p]),e.jsx(X,{children:e.jsxs(H,{children:[e.jsx(O,{children:"Subscriptions"}),e.jsx(te,{setSubscriptionsFilters:a}),e.jsx(ie,{area:"SUBSCRIPTIONS",data:n,setPageSize:T}),N?e.jsx(W,{}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:J,numberColumns:10,rows:(b=n==null?void 0:n.data)==null?void 0:b.map(({id:R,type:U,summary:B,organisationName:D,user:I,created:q,renews:m,frequency:z,cost:F,cancelled:i})=>({cells:[{label:"Subcription Type",value:U,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Summary",value:B,narrowTable:{showLabel:!0}},{label:"Company Name",value:D,narrowTable:{showLabel:!0}},{label:"User Email",value:I,narrowTable:{showLabel:!0}},{label:"Start Date",value:c(q),narrowTable:{showLabel:!0}},{label:"Renews",value:m?c(m):"-",narrowTable:{showLabel:!0}},{label:"Frequency",value:z,narrowTable:{showLabel:!0}},{label:"Cost",value:`\xA3${F}`,narrowTable:{showLabel:!0}},{label:"Cancelled",value:i?c(i):"-",narrowTable:{showLabel:!0}}],ctaContent:{headerContent:"Cancel",icon:i||h?void 0:"trashSystem",onClick:i||h?void 0:g(u,P,R)}}))}),e.jsx(K,{callback:f,currentPage:l,numberPages:Math.ceil(((n==null?void 0:n.totalCount)??1)/12)}),e.jsxs(L,{title:"Cancel Subscription",children:[e.jsx(Q,{children:"Please confirm you wish to cancel this subscription"}),e.jsxs(V,{alignment:"right",children:[e.jsx(S,{type:"button",onClick:d,children:"Close"}),e.jsx(S,{intent:"danger",onClick:w(M,u),children:"Cancel"})]})]})]})]})})};export{ce as default,w as handleCancelSub,C as handleCancelSubSuccess,g as handleSetSubId};
