import{j as e,aa as ie,ab as L,ao as E,ad as x,ap as oe,aq as ge,r as c,ag as _,a7 as $,ai as M,ah as ee,al as z,aj as de,ae as P,af as i,ar as we,X as O,an as ce,ac as k,as as fe,at as ye,a5 as me,W as Te,am as Ce}from"./vendor-ZH71Hs13.js";import{E as Se}from"./index-CwlvE5Y3.js";import{u as ue,t as R,a as De}from"./index.esm-Ch-ie6LE.js";import{f as Me}from"./index-C-eCv2z-.js";import{u as ae,r as v,g as se,G as le,a as F,U as A,o as ke}from"./index-D0FSyh0V.js";import{S as Ie}from"./index-Co6JqKJd.js";import{C as Ne}from"./create-subscriptions-C-jIRU8x.js";import{u as U}from"./use-reapit-update-dp8F_tvZ.js";import{a as pe,u as Le}from"./use-permissions-state-Dfv7KUEy.js";import{c as he,a as T,o as be}from"./yup-pf5yA_MY.js";import{p as Ee,e as Pe,l as Re}from"./regexs-6gdYqTky.js";import"./FileSaver.min-BZwjJ9VL.js";const Fe=({setDeveloperFilters:a})=>{const{register:s,handleSubmit:l}=ue({mode:"onChange"});return e.jsx("form",{onChange:l(Me(a,500)),children:e.jsxs(ie,{className:L,children:[e.jsx(E,{children:e.jsx(x,{...s("name"),label:"Developer Name",type:"search"})}),e.jsx(E,{children:e.jsx(x,{...s("company"),label:"Company Name",type:"search"})}),e.jsx(E,{children:e.jsx(x,{...s("gitHubUsername"),label:"Github Username",type:"search"})}),e.jsx(E,{children:e.jsx(x,{...s("registeredFrom"),label:"Registered From",type:"date"})}),e.jsx(E,{children:e.jsx(x,{...s("registeredTo"),label:"Registered To",type:"date"})}),e.jsx(E,{children:e.jsxs(x,{children:[e.jsx(oe,{children:"Status"}),e.jsxs(ge,{...s("status"),children:[e.jsx("option",{value:"",children:"Please Select"}),e.jsx("option",{value:"incomplete",children:"Incomplete"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"underReview",children:"Under Review"}),e.jsx("option",{value:"removed",children:"Removed"})]})]})})]})})},Ae=(a,s)=>()=>{s&&a(s)},Ue=(a,s)=>()=>{s&&a(s)},xe=(a,s)=>()=>{a(s)},Ge=(a,s,l)=>()=>{(s||l)&&a()},qe=(a,s,l)=>()=>{l&&(a(l),s())},Be=(a,s,l)=>async()=>{await l()&&(s(),a(null))},He=({devIdMembers:a})=>{var X,K;const[s,l]=c.useState(null),[t,o]=c.useState(1),[m,r]=c.useState(null),[n,u]=c.useState(null),{hasReadAccess:p}=pe(),{Modal:g,openModal:j,closeModal:h}=_(),[d,f,,G]=ae({reapitConnectBrowserSession:v,action:se[le.getDeveloperMembers],uriParams:{developerId:a,memberId:s==null?void 0:s.id},queryParams:{pageNumber:t,pageSize:12},fetchWhenTrue:[a]}),[w,I]=ae({reapitConnectBrowserSession:v,action:se[le.getUserInfo],queryParams:{email:encodeURIComponent(m??""),includeIdpData:!0},fetchWhenTrue:[m]}),[y,,re,q]=U({reapitConnectBrowserSession:v,action:F[A.updateMember],method:"PUT",uriParams:{developerId:a,memberId:s==null?void 0:s.id}}),[,,J,Y]=U({reapitConnectBrowserSession:v,action:F[A.deleteMember],method:"DELETE",uriParams:{developerId:n==null?void 0:n.developerId,memberId:n==null?void 0:n.id}});c.useEffect(Ge(G,q,Y),[q,Y]),c.useEffect(Ae(re,s),[s]);const C=((X=w==null?void 0:w.idpData)==null?void 0:X.authEvents)??[];return f?e.jsx($,{}):(K=d==null?void 0:d.data)!=null&&K.length?e.jsxs("div",{className:M,children:[e.jsx(ee,{children:"Total Members"}),e.jsx(z,{hasGreyText:!0,children:d.totalCount}),e.jsx(de,{className:L,rows:d.data.map(S=>{var Z,W;const{name:B,jobTitle:te,status:H,role:b,gitHubUsername:ne,agreedTerms:N,created:Q,email:D}=S;return{cells:[{label:"Developer Name",value:B,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Member Email",value:D,narrowTable:{showLabel:!0}},{label:"Job Title",value:te,narrowTable:{showLabel:!0}},{label:"Role",value:b,narrowTable:{showLabel:!0}},{label:"Github Username",value:ne,narrowTable:{showLabel:!0}},{label:"Member Status",value:H,narrowTable:{showLabel:!0}},{label:"Agreed Terms Date",value:N?R(N):"-",narrowTable:{showLabel:!0}},{label:"Created Date",value:Q?R(Q):"-",narrowTable:{showLabel:!0}}],expandableContent:{content:e.jsxs(e.Fragment,{children:[e.jsxs(P,{alignment:"center",children:[e.jsxs(i,{intent:"primary",disabled:p||y,loading:y,onClick:xe(l,{...S,role:b==="admin"?"user":"admin"}),children:["Set As ",b==="admin"?"User":"Admin"]}),e.jsx(i,{intent:"primary",disabled:I,loading:I,onClick:Ue(r,D),children:"Get Login Info"}),e.jsx(i,{type:"button",intent:"danger",disabled:p,onClick:qe(u,j,S),children:"Delete Member"}),e.jsx(i,{intent:"danger",disabled:p||y,loading:y,onClick:xe(l,{...S,status:H==="active"?"inactive":"active"}),children:H==="active"?"Disable":"Enable"})]}),I&&e.jsx($,{className:M}),w&&m===D&&C.length?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:M,children:"Recent Logins"}),(W=(Z=w.idpData)==null?void 0:Z.authEvents)==null?void 0:W.map((V,ve)=>ve<5?e.jsx(we,{hasGreyText:!0,children:V},V):null)]}):w&&m===D?e.jsx(O,{className:M,isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"No login information for user"}):null]})}}})}),e.jsx(ce,{callback:o,currentPage:t,numberPages:Math.ceil(((d==null?void 0:d.totalCount)??1)/12)}),e.jsxs(g,{title:"Delete Member",children:[e.jsx(z,{hasGreyText:!0,children:"Are you sure you want to delete this member? This action cannot be undone."}),e.jsxs(P,{alignment:"right",children:[e.jsx(i,{onClick:h,children:"Cancel"}),e.jsx(i,{intent:"danger",onClick:Be(u,h,J),children:"Delete"})]})]})]}):e.jsx(O,{className:M,isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"No results found for your selected filters"})},We=he().shape({status:T().trim().required(),reapitReference:T().trim().when("status",{is:a=>a=="confirmed",then:T().required().max(50,"Maximum of 50 characters allowed")}),notes:T().trim().max(200,"Maximum of 200 characters allowed")}),Ve=(a,s)=>l=>{s&&a({...s,companyName:s.company,...l})},ze=(a,s,l,t)=>()=>{t&&(a(),s(null),l())},Oe=({developer:a,closeModal:s,setDeveloperUpdate:l,refreshDevelopers:t})=>{var j,h;const{register:o,handleSubmit:m,control:r,formState:{errors:n}}=ue({resolver:be(We),defaultValues:{status:a==null?void 0:a.status,reapitReference:a==null?void 0:a.reapitReference,notes:a==null?void 0:a.notes}}),[,,u,p]=U({reapitConnectBrowserSession:v,action:F[A.updateDeveloper],method:"PUT",uriParams:{developerId:a==null?void 0:a.id}});c.useEffect(ze(t,l,s,p),[p]);const g=De({control:r,name:"status"});return a?e.jsxs("form",{onSubmit:m(Ve(u,a)),children:[e.jsxs(ie,{className:L,children:[e.jsxs(k,{children:[e.jsx(oe,{children:"Update Developer Status"}),e.jsx(fe,{...o("status"),hasGreyBg:!0,options:[{id:"option-status-incomplete",value:"incomplete",text:"Incomplete",isChecked:a.status==="incomplete"},{id:"option-status-pending",value:"pending",text:"Pending",isChecked:a.status==="pending"},{id:"option-status-confirmed",value:"confirmed",text:"Confirmed",isChecked:a.status==="confirmed"},{id:"option-status-underReview",value:"underReview",text:"Under Review",isChecked:a.status==="underReview"},{id:"option-status-removed",value:"removed",text:"Removed",isChecked:a.status==="removed"}]})]}),e.jsx(k,{children:e.jsx(x,{...o("reapitReference"),label:"Reapit Reference",placeholder:"Reapit Reference if account confirmed",errorMessage:(j=n==null?void 0:n.reapitReference)==null?void 0:j.message,icon:(h=n==null?void 0:n.reapitReference)!=null&&h.message?"asterisk":null,intent:"danger",disabled:g!=="confirmed"})}),e.jsx(k,{children:e.jsxs(x,{children:[e.jsx(ye,{type:"text",...o("notes"),placeholder:"Notes on developer"}),e.jsx(oe,{children:"Notes"})]})})]}),e.jsxs(P,{alignment:"right",children:[e.jsx(i,{onClick:s,children:"Cancel"}),e.jsx(i,{intent:"primary",type:"submit",children:"Confirm"})]})]}):null},Je=({devIdApps:a})=>{var m;const[s,l]=c.useState(1),[t,o]=ae({reapitConnectBrowserSession:v,action:se[le.getApps],queryParams:{pageNumber:s,pageSize:12,developerId:a},fetchWhenTrue:[a]});return o?e.jsx($,{}):(m=t==null?void 0:t.data)!=null&&m.length?e.jsxs("div",{className:M,children:[e.jsx(ee,{children:"Total Apps"}),e.jsx(z,{hasGreyText:!0,children:t.totalCount}),e.jsx(de,{className:L,rows:t.data.map(({name:r,id:n,summary:u,isListed:p,isDirectApi:g,isFeatured:j,created:h,publicListedDate:d})=>({cells:[{label:"App Name",value:r??"",cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"AppId",value:n??"",narrowTable:{showLabel:!0}},{label:"Summary",value:u??"",narrowTable:{showLabel:!0}},{label:"Listed",value:e.jsx(me,{icon:p?"check":"close"}),narrowTable:{showLabel:!0}},{label:"Integration",value:e.jsx(me,{icon:g?"check":"close"}),narrowTable:{showLabel:!0}},{label:"Featured",value:e.jsx(me,{icon:j?"check":"close"}),narrowTable:{showLabel:!0}},{label:"Created",value:R(h)??"",narrowTable:{showLabel:!0}},{label:"Publicly Listed",value:d?R(d):"-",narrowTable:{showLabel:!0}}],expandableContent:{content:e.jsx(O,{isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"Visit the dedicated apps page to perform actions on this app"})}}))}),e.jsx(ce,{callback:l,currentPage:s,numberPages:Math.ceil(((t==null?void 0:t.totalCount)??1)/12)})]}):e.jsx("div",{className:M,children:e.jsx(O,{isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"No results found for your selected filters"})})},Ye=he().shape({name:T().trim().required().matches(Ee,"Full name is not valid").max(256,"Maximum character length of 256"),email:T().trim().required().matches(Pe,"Email address is not valid").max(256,"Maximum character length of 256"),jobTitle:T().trim().required().matches(Re,"Job title is not valid").max(256,"Maximum character length of 256"),message:T().trim()}),Xe=(a,s)=>async l=>{await a(l)&&s()},Ke=({developerId:a,closeModal:s})=>{var n,u,p,g,j,h,d,f;const{connectSession:l}=Le(v),[,,t]=U({reapitConnectBrowserSession:v,action:F[A.inviteMember],method:"POST",uriParams:{developerId:a}}),{register:o,handleSubmit:m,formState:{errors:r}}=ue({resolver:be(Ye),defaultValues:{name:"",email:"",jobTitle:"",message:"",sender:l==null?void 0:l.loginIdentity.email}});return e.jsxs("form",{onSubmit:m(Xe(t,s)),children:[e.jsxs(ie,{hasMargin:!0,children:[e.jsx(k,{children:e.jsx(x,{...o("name"),label:"Name",placeholder:"Your colleague's full name",errorMessage:(n=r==null?void 0:r.name)==null?void 0:n.message,icon:(u=r==null?void 0:r.name)!=null&&u.message?"asterisk":null,intent:"danger"})}),e.jsx(k,{children:e.jsx(x,{...o("email"),type:"email",label:"Email",placeholder:"An email address we can contact your colleague at",errorMessage:(p=r==null?void 0:r.email)==null?void 0:p.message,icon:(g=r==null?void 0:r.email)!=null&&g.message?"asterisk":null,intent:"danger"})}),e.jsx(k,{children:e.jsx(x,{...o("jobTitle"),label:"Job Title",placeholder:"Your colleague's role at your company'",errorMessage:(j=r==null?void 0:r.jobTitle)==null?void 0:j.message,icon:(h=r==null?void 0:r.jobTitle)!=null&&h.message?"asterisk":null,intent:"danger"})}),e.jsx(k,{children:e.jsx(x,{...o("message"),label:"Invite Message",placeholder:"An optional invite message",errorMessage:(d=r==null?void 0:r.message)==null?void 0:d.message,icon:(f=r==null?void 0:r.message)!=null&&f.message?"asterisk":null,intent:"danger"})})]}),e.jsxs(P,{alignment:"right",children:[e.jsx(i,{onClick:s,children:"Close"}),e.jsx(i,{intent:"primary",type:"submit",children:"Send Invite"})]})]})},Qe=(a,s,l)=>()=>{l&&(s(l),a())},Ze=(a,s,l,t)=>()=>{t&&(a(t),s(null),l(null))},_e=(a,s,l,t)=>()=>{t&&(a(t),s(null),l(null))},$e=(a,s,l,t)=>()=>{t&&(a(t),s(null),l(null))},ea=(a,s,l)=>()=>{l&&(a(l),s())},aa=(a,s,l,t)=>async()=>{await l()&&(s(),a(null),t())},sa=(a,s,l,t)=>async()=>{const o=t?0:300;await s({...a,companyName:a.company,developerEditionSubscriptionCost:o},{uriParams:{developerId:a==null?void 0:a.id}})&&l()},la=(a,s,l,t)=>()=>{t&&(s(null),a(t),l())},ra=({developers:a,refreshDevelopers:s})=>{var S;const{Modal:l,openModal:t,closeModal:o}=_(),{Modal:m,openModal:r,closeModal:n}=_(),{Modal:u,openModal:p,closeModal:g}=_(),[j,h]=c.useState(null),[d,f]=c.useState(null),[G,w]=c.useState(null),[I,y]=c.useState(null),[re,q]=c.useState(null),[J,Y]=c.useState(null),{hasReadAccess:C}=pe(),[,,X]=U({reapitConnectBrowserSession:v,action:F[A.updateDeveloper],method:"PUT"}),[,,K]=U({reapitConnectBrowserSession:v,action:F[A.deleteDeveloper],method:"DELETE",uriParams:{developerId:re}});return(S=a==null?void 0:a.data)!=null&&S.length?e.jsxs("div",{className:L,children:[e.jsx(ee,{children:"Total Developers"}),e.jsx(z,{hasGreyText:!0,children:a.totalCount}),e.jsx(de,{rows:a.data.map(B=>{const{company:te,name:H,id:b,jobTitle:ne,status:N,email:Q,agreedTerms:D,created:Z,developerEditionSubscriptionCost:W}=B,V=!!(W===null||Math.round(W??0));return{cells:[{label:"Company Name",value:te,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Developer Name",value:H,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Developer Email",value:Q,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Job Title",value:ne,narrowTable:{showLabel:!0}},{label:"Account Status",value:N,narrowTable:{showLabel:!0}},{label:"Created Date",value:R(Z),narrowTable:{showLabel:!0}},{label:"Agreed Terms Date",value:D?R(D):"-",narrowTable:{showLabel:!0}}],expandableContent:{content:e.jsxs(e.Fragment,{children:[e.jsxs(P,{alignment:"center",children:[e.jsx(i,{type:"button",intent:"primary",disabled:C,onClick:Qe(t,h,B),children:"Update Status"}),e.jsx(i,{type:"button",intent:"primary",disabled:C,onClick:sa(B,X,s,V),children:V?"Pays For DevEdition":"DevEdition is Free"}),e.jsxs(i,{onClick:$e(y,w,f,b),intent:"primary",disabled:C||N!=="confirmed",children:["Toggle Subscription ",N!=="confirmed"?"(Status Not Confirmed)":""]}),e.jsx(i,{onClick:la(Y,f,p,b),intent:"primary",disabled:C,children:"Invite Member"}),e.jsx(i,{intent:"primary",onClick:Ze(f,y,w,b),children:"Fetch Members"}),e.jsx(i,{intent:"primary",onClick:_e(w,y,f,b),children:"Fetch Apps"}),e.jsx(i,{type:"button",intent:"danger",disabled:C,onClick:ea(q,r,b),children:"Delete Developer"})]}),d&&d===b&&e.jsx(He,{devIdMembers:d}),G&&G===b&&e.jsx(Je,{devIdApps:G}),I&&I===b&&e.jsx(Ne,{developerId:b,subscriptionType:"developerRegistration"})]})}}})}),e.jsx(l,{title:"Update Developer Status",children:e.jsx(Oe,{developer:j,closeModal:o,setDeveloperUpdate:h,refreshDevelopers:s})}),e.jsxs(m,{title:"Delete Developer",children:[e.jsx(z,{hasGreyText:!0,children:"Are you sure you want to delete this developer? This action cannot be undone."}),e.jsxs(P,{alignment:"right",children:[e.jsx(i,{onClick:n,children:"Cancel"}),e.jsx(i,{intent:"danger",onClick:aa(q,n,K,s),children:"Delete"})]})]}),e.jsx(u,{title:"Invite Developer Org Member",children:J&&e.jsx(Ke,{developerId:J,closeModal:g})})]}):e.jsx("div",{className:L,children:e.jsx(O,{isExpanded:!0,isFullWidth:!0,isInline:!0,intent:"primary",children:"No results found for your selected filters"})})},ta=a=>()=>{a(!1)},je=()=>{const[a,s]=c.useState({}),[l,t]=c.useState(1),[o,m]=c.useState(12),[r,n,,u]=ae({reapitConnectBrowserSession:v,action:se[le.getDevelopers],queryParams:{pageNumber:l,pageSize:o,...ke(a)}});return e.jsx(Se,{children:e.jsxs(Te,{children:[e.jsx(Ce,{children:"Developers"}),e.jsx(Fe,{setDeveloperFilters:s}),n?e.jsx($,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{area:"DEVELOPERS",data:r,setPageSize:m}),e.jsx(ra,{developers:r,refreshDevelopers:u}),e.jsx(ce,{callback:t,currentPage:l,numberPages:Math.ceil(((r==null?void 0:r.totalCount)??1)/12)})]})]})})};export{je as DevsManagement,ta as closeDisableMemberModal,je as default};
