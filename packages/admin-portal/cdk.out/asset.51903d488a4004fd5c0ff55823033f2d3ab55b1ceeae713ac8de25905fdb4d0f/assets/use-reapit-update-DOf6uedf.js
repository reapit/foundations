import{n as K,o as N,r as O,aK as R,t as g}from"./vendor-_Ftg20Hp.js";import{b as f,h as y,c as k,d as A,N as B,l as D}from"./index-CVVnuXMX.js";const H=({action:r,method:S="POST",returnType:u="none",headers:C={},uriParams:o,withCredentials:E,reapitConnectBrowserSession:h})=>{const{error:v,success:M}=K(),P=N(),{successMessage:m,errorMessage:p}=r,l=O.useMemo(f(r,void 0,o),[o,r]),{mutateAsync:T,error:w,data:b,isSuccess:L,isLoading:x}=R([l,o],{mutationFn:async s=>{const{data:e,options:a}=s,i={...C,...(a==null?void 0:a.headers)??{}},t=a!=null&&a.uriParams?f(r,void 0,{...o,...a.uriParams})():l,c=await k(h,i);if(!c)throw new Error("Missing valid Reapit Connect Session, please try logging in again.");const d=await g(t,{method:S,headers:c,data:e,withCredentials:E});if(u==="response")return d.data;if(u==="location"&&d.headers){const n=d.headers.location;if(!n)throw new Error("Location was not returned by server");const G=n.includes(".prod.paas")?n.replace(".prod.paas",""):n;return(await g(G,{method:"GET",headers:c})).data}return!0},onSuccess:()=>{m&&M(m)},onError:async s=>{const e=await h.connectSession(),a=s.message===A,i=s.code===B;if(a||i||!e)return P("/login");const t=y(s,p);v(t,5e3),D(new Error(t),e)}}),F=w?y(w,p):null;return[x,b,(s,e)=>T({data:s,options:e}).catch(a=>console.info("Caught error",a.message)),L,F]};export{H as u};
