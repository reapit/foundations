import{J as $e,j as s,a9 as We,aa as le,ab as F,ac as de,ad as pe,ae as B,af as x,r as L,ag as re,ah as ue,ai as he,a7 as se,aj as me,X as fe,f as S,ak as A,al as w,W as _e,am as ze,an as He}from"./vendor-_Ftg20Hp.js";import{r as v,u as T,g as P,G as R,a as O,U as $}from"./index-DivjyRvy.js";import{u as W}from"./use-reapit-update-D13rjc3a.js";import{u as ge,d as te,t as Ye}from"./index.esm-DOuwMxsP.js";import{u as ve,a as ie}from"./use-permissions-state-CJmar-BT.js";import{c as je,a as xe,o as ye}from"./yup-COG2kgBL.js";import{e as Ge}from"./regexs-6gdYqTky.js";import{o as Ce}from"./navigation-yBndQIhU.js";const Ve=$e("div")({name:"HtmlContentWrap",class:"html-content-wrap",propsAsIs:!1}),Je=(e,n,r)=>e.type==="text"?new DOMParser().parseFromString(e.content||"","text/html").documentElement.textContent||null:_.sortTags(e,n,r),Ke=(e,n)=>e.children?e.children.map((r,t)=>_.sortContentType(r,t,n)):null,Xe=(e,n)=>{const r=e.attributes||[];return{...Array.from(r).reduce((t,{key:i,value:a})=>({...t,[i]:a}),{}),key:n,style:{}}},be=e=>{const n=e.href,r=window.__REAPIT_MARKETPLACE_GLOBALS__?`agencycloud://process/webpage?url=${n}`:n;return{...e,href:r}},Ze=(e,n,r)=>{const t=_.getChildren(e,r),i=_.getAttributes(e,n);if(!t||!t.length)return null;switch(e.tagName){case"p":return s.jsx("p",{...i,children:t});case"a":return window.__REAPIT_MARKETPLACE_GLOBALS__?s.jsx("a",{...be(i),children:t}):s.jsx("a",{target:"_blank",rel:"noopener",...be(i),children:t});case"b":return s.jsx("b",{...i,children:t});case"u":return s.jsx("u",{...i,children:t});case"ul":return s.jsx("ul",{...i,children:t});case"ol":return s.jsx("ol",{...i,children:t});case"li":return s.jsx("li",{...i,children:t});case"h1":return s.jsx("h1",{...i,children:t});case"h2":return s.jsx("h2",{...i,children:t});case"h3":return s.jsx("h3",{...i,children:t});case"h4":return s.jsx("h4",{...i,children:t});case"h5":return s.jsx("h5",{...i,children:t});case"h6":return s.jsx("h6",{...i,children:t});case"i":return s.jsx("i",{...i,children:t});case"strike":return s.jsx("del",{...i,children:t});case"blockquote":return s.jsx("blockquote",{...i,children:t});case"pre":return s.jsx("pre",{...i,children:t});case"hr":return s.jsx("hr",{...i});case"ins":return r?s.jsx("ins",{...i,children:t}):s.jsx("div",{...i,children:t});case"del":return r?s.jsx("del",{className:"del-diff",...i,children:t}):s.jsx("div",{...i,children:t});default:return s.jsx("div",{...i,children:t})}},ke=(e,n)=>e.map((r,t)=>_.sortContentType(r,t,n)),_={sortContentType:Je,getChildren:Ke,getAttributes:Xe,sortTags:Ze,renderer:ke},we=({html:e,diffing:n=!1,className:r="html-render",image:t})=>{const i=We(e);return s.jsxs("div",{className:r,children:[t,s.jsx(Ve,{children:ke(i,n)})]})},Qe=je().shape({recipient:xe().trim().required("Required").matches(Ge,"Must be a valid email address")}),en=(e,n)=>r=>{e({...r,actionedBy:n})},nn=({email:e,closeModal:n,resendEmail:r,recipient:t})=>{var c,l;const{register:i,handleSubmit:a,formState:{errors:o}}=ge({resolver:ye(Qe),defaultValues:{recipient:t}});return e?s.jsxs("form",{onSubmit:a(en(r,e)),children:[s.jsx(le,{className:F,children:s.jsx(de,{children:s.jsx(pe,{...i("recipient"),label:"Consent Recipient",placeholder:"Email of the recipient",errorMessage:(c=o==null?void 0:o.recipient)==null?void 0:c.message,icon:(l=o==null?void 0:o.recipient)!=null&&l.message?"asterisk":null,intent:"danger"})})}),s.jsxs(B,{alignment:"right",children:[s.jsx(x,{onClick:n,children:"Cancel"}),s.jsx(x,{intent:"primary",type:"submit",children:"Confirm"})]})]}):null},rn=(e,n,r)=>async()=>{await e({actionedBy:r})&&n()},sn=(e,n,r)=>()=>{n&&(e(n),r())},tn=(e,n,r)=>()=>{r&&(e(null),n())},an=({approval:e})=>{const{connectSession:n}=ve(v),{hasReadAccess:r}=ie(),[t,i]=L.useState(null),{Modal:a,openModal:o,closeModal:c}=re(),l=n==null?void 0:n.loginIdentity.email,d=e==null?void 0:e.appId,u=e==null?void 0:e.appRevisionId,g=t==null?void 0:t.id,[f]=T({reapitConnectBrowserSession:v,action:P[R.getAppById],uriParams:{appId:d},fetchWhenTrue:[d]}),[p]=T({reapitConnectBrowserSession:v,action:P[R.getRevisionById],uriParams:{revisionId:u,appId:d},fetchWhenTrue:[u,d]}),m=f==null?void 0:f.developerId,h=f==null?void 0:f.name,y=f==null?void 0:f.pendingRevisions,b=p==null?void 0:p.isListed,[C,M,,D]=T({reapitConnectBrowserSession:v,action:P[R.getRevisionConsents],uriParams:{appId:d,revisionId:u},fetchWhenTrue:[d,u,y,b]}),[,,ee]=W({reapitConnectBrowserSession:v,action:O[$.createConsentEmails],method:"POST",uriParams:{appId:d,revisionId:u}}),[E]=T({reapitConnectBrowserSession:v,action:P[R.getInstallations],queryParams:{appId:d,pageNumber:1,pageSize:999,isInstalled:!0,developerId:m},fetchWhenTrue:[m]}),[,,ne,q]=W({reapitConnectBrowserSession:v,action:O[$.resendConsentEmail],method:"POST",uriParams:{appId:d,revisionId:u,consentId:g}});return L.useEffect(tn(i,c,q),[q]),e?s.jsxs(s.Fragment,{children:[s.jsxs(ue,{className:he,children:[h," Consents"]}),M?s.jsx(se,{}):C!=null&&C.length?s.jsxs(s.Fragment,{children:[s.jsx(me,{numberColumns:6,rows:C.map(k=>{var G,V,I,U;return{cells:[{label:"Client",value:(V=(G=E==null?void 0:E.data)==null?void 0:G.find(J=>J.id===k.installationId))==null?void 0:V.customerName,icon:"property",cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Email",value:k.installedBy,narrowTable:{showLabel:!0}},{label:"Date Sent",value:te(k.sentDate).format("DD/MM/YYYY HH:mm"),narrowTable:{showLabel:!0}},{label:"Status",value:`${(I=k.status)==null?void 0:I.charAt(0).toUpperCase()}${(U=k.status)==null?void 0:U.slice(1)}`,narrowTable:{showLabel:!0}},{label:"Date Accepted",value:k.approvalDate?te(k.approvalDate).format("DD/MM/YYYY HH:mm"):"-",narrowTable:{showLabel:!0}}],ctaContent:{headerContent:"Resend Email",icon:r?void 0:"email",onClick:r?void 0:sn(i,k,o)}}})}),s.jsx(a,{title:"Resent Consents For Client",children:s.jsx(nn,{resendEmail:ne,closeModal:c,email:l,recipient:t==null?void 0:t.installedBy})})]}):f&&p?s.jsxs(s.Fragment,{children:[s.jsx("div",{children:s.jsx(fe,{className:F,intent:"primary",isExpanded:!0,isFullWidth:!0,isInline:!0,children:"No record of any consents for this app - you can send these from the link below."})}),s.jsx(B,{alignment:"center",children:s.jsx(x,{onClick:rn(ee,D,l),intent:"primary",children:"Send Requests"})})]}):null]}):null},on="diff-viewer-container",K="green-background",X="red-background",cn="checkbox-container",Ie="checkbox-wrap",ln="arow",dn="diff-media-container",Se="image",Te="diff-block",Pe="icon-block",pn="icon-image",Re="media-block",un="media-image",hn="diff-html-container",Ne="arrow",Ae="diff-render-block",mn=({currentMedia:e,changedMedia:n,type:r})=>{const t=r==="icon"?Pe:Re,i=r==="icon"?pn:un,a=e!==n;return s.jsxs("div",{className:dn,children:[s.jsx("div",{className:S(Te,r==="icon"?Pe:Re,a&&X),children:s.jsx("div",{className:S(Se,i),style:{backgroundImage:`url("${e}")`}})}),s.jsx("span",{className:Ne,children:"\u2192"}),s.jsx("div",{className:S(Te,t,a&&K),children:s.jsx("div",{className:S(Se,i),style:{backgroundImage:`url("${n}")`}})})]})},z=({currentChecked:e,changedChecked:n,dataTest:r})=>{const t=e!==n;return s.jsxs("div",{className:cn,"data-test":r||"",children:[s.jsx("span",{className:S(Ie,t&&X),children:s.jsx("input",{type:"checkbox",checked:e,readOnly:!0,"data-test":"current"})}),t&&s.jsx("span",{className:ln,children:"\u2192"}),t&&s.jsx("span",{className:S(Ie,K),children:s.jsx("input",{type:"checkbox",checked:n,readOnly:!0,"data-test":"changed"})})]})};function N(){}N.prototype={diff:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=r.callback;typeof r=="function"&&(t=r,r={}),this.options=r;var i=this;function a(m){return t?(setTimeout(function(){t(void 0,m)},0),!0):m}e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e)),n=this.removeEmpty(this.tokenize(n));var o=n.length,c=e.length,l=1,d=o+c,u=[{newPos:-1,components:[]}],g=this.extractCommon(u[0],n,e,0);if(u[0].newPos+1>=o&&g+1>=c)return a([{value:this.join(n),count:n.length}]);function f(){for(var m=-1*l;m<=l;m+=2){var h=void 0,y=u[m-1],b=u[m+1],C=(b?b.newPos:0)-m;y&&(u[m-1]=void 0);var M=y&&y.newPos+1<o,D=b&&0<=C&&C<c;if(!M&&!D){u[m]=void 0;continue}if(!M||D&&y.newPos<b.newPos?(h=gn(b),i.pushComponent(h.components,void 0,!0)):(h=y,h.newPos++,i.pushComponent(h.components,!0,void 0)),C=i.extractCommon(h,n,e,m),h.newPos+1>=o&&C+1>=c)return a(fn(i,h.components,n,e,i.useLongestToken));u[m]=h}l++}if(t)(function m(){setTimeout(function(){if(l>d)return t();f()||m()},0)})();else for(;l<=d;){var p=f();if(p)return p}},pushComponent:function(e,n,r){var t=e[e.length-1];t&&t.added===n&&t.removed===r?e[e.length-1]={count:t.count+1,added:n,removed:r}:e.push({count:1,added:n,removed:r})},extractCommon:function(e,n,r,t){for(var i=n.length,a=r.length,o=e.newPos,c=o-t,l=0;o+1<i&&c+1<a&&this.equals(n[o+1],r[c+1]);)o++,c++,l++;return l&&e.components.push({count:l}),e.newPos=o,c},equals:function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function fn(e,n,r,t,i){for(var a=0,o=n.length,c=0,l=0;a<o;a++){var d=n[a];if(d.removed){if(d.value=e.join(t.slice(l,l+d.count)),l+=d.count,a&&n[a-1].added){var u=n[a-1];n[a-1]=n[a],n[a]=u}}else{if(!d.added&&i){var g=r.slice(c,c+d.count);g=g.map(function(p,m){var h=t[l+m];return h.length>p.length?h:p}),d.value=e.join(g)}else d.value=e.join(r.slice(c,c+d.count));c+=d.count,d.added||(l+=d.count)}}var f=n[o-1];return o>1&&typeof f.value=="string"&&(f.added||f.removed)&&e.equals("",f.value)&&(n[o-2].value+=f.value,n.pop()),n}function gn(e){return{newPos:e.newPos,components:e.components.slice(0)}}var vn=new N;function jn(e,n,r){return vn.diff(e,n,r)}function xn(e,n){if(typeof e=="function")n.callback=e;else if(e)for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}var Me=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,De=/\S/,Z=new N;Z.equals=function(e,n){return this.options.ignoreCase&&(e=e.toLowerCase(),n=n.toLowerCase()),e===n||this.options.ignoreWhitespace&&!De.test(e)&&!De.test(n)},Z.tokenize=function(e){for(var n=e.split(/(\s+|[()[\]{}'"]|\b)/),r=0;r<n.length-1;r++)!n[r+1]&&n[r+2]&&Me.test(n[r])&&Me.test(n[r+2])&&(n[r]+=n[r+2],n.splice(r+1,2),r--);return n};function yn(e,n,r){return r=xn(r,{ignoreWhitespace:!0}),Z.diff(e,n,r)}function Cn(e,n,r){return Z.diff(e,n,r)}var ae=new N;ae.tokenize=function(e){var n=[],r=e.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var t=0;t<r.length;t++){var i=r[t];t%2&&!this.options.newlineIsToken?n[n.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),n.push(i))}return n};function bn(e,n,r){return ae.diff(e,n,r)}var kn=new N;kn.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var wn=new N;wn.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};function Q(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Q=function(n){return typeof n}:Q=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Q(e)}var In=Object.prototype.toString,H=new N;H.useLongestToken=!0,H.tokenize=ae.tokenize,H.castInput=function(e){var n=this.options,r=n.undefinedReplacement,t=n.stringifyReplacer,i=t===void 0?function(a,o){return typeof o>"u"?r:o}:t;return typeof e=="string"?e:JSON.stringify(oe(e,null,null,i),i,"  ")},H.equals=function(e,n){return N.prototype.equals.call(H,e.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"))};function oe(e,n,r,t,i){n=n||[],r=r||[],t&&(e=t(i,e));var a;for(a=0;a<n.length;a+=1)if(n[a]===e)return r[a];var o;if(In.call(e)==="[object Array]"){for(n.push(e),o=new Array(e.length),r.push(o),a=0;a<e.length;a+=1)o[a]=oe(e[a],n,r,t,i);return n.pop(),r.pop(),o}if(e&&e.toJSON&&(e=e.toJSON()),Q(e)==="object"&&e!==null){n.push(e),o={},r.push(o);var c=[],l;for(l in e)e.hasOwnProperty(l)&&c.push(l);for(c.sort(),a=0;a<c.length;a+=1)l=c[a],o[l]=oe(e[l],n,r,t,l);n.pop(),r.pop()}else o=e;return o}var ce=new N;ce.tokenize=function(e){return e.slice()},ce.join=ce.removeEmpty=function(e){return e};const Sn={chars:jn,words:yn,lines:bn,wordsWithSpace:Cn},Y=({currentString:e,changedString:n,type:r="words"})=>{const t=Sn[r](e,n).map((i,a)=>s.jsx("span",{className:S(i.added&&K,i.removed&&X),children:i.value},`${i.value}-${a}`));return s.jsx("div",{className:on,children:t})},Tn=({currentString:e,changedString:n})=>{const r=e!==n;return s.jsxs("div",{className:hn,children:[s.jsx(we,{className:S(Ae,r&&X),html:e||""}),s.jsx("span",{className:Ne,children:"\u2192"}),s.jsx(we,{className:S(Ae,r&&K),html:n||""})]})},Ee={name:"Name",homePage:"Home page",launchUri:"Launch URI",supportEmail:"Support Email",telephone:"Telephone",summary:"Summary",description:"Description",redirectUris:"Redirect URIs",signoutUris:"Signout URIs",limitToClientIds:"Private Apps",desktopIntegrationTypeIds:"Integration Type",products:"Products",privacyPolicyUrl:"Privacy Policy",termsAndConditionsUrl:"Terms & Conditions",pricingUrl:"Pricing Info"},Be=(e,n=[])=>!e||!(n!=null&&n.length)?!1:!!n.find(r=>r.name===e),Pn=({scopes:e,appScopes:n,revisionScopes:r})=>e.map(t=>{const i=Be(t.name,n),a=Be(t.name,r);return s.jsxs("div",{className:A,children:[s.jsx(w,{hasGreyText:!0,children:t.description}),s.jsx(z,{currentChecked:i,changedChecked:a})]},t.name)}),Rn=({app:e,revision:n})=>{const{media:r}=n,{media:t}=e;return!r||!t?[{order:0,type:"media"}]:r.length>=t.length?r.map((i,a)=>{var o;return{changedMedia:i==null?void 0:i.uri,currentMedia:(o=t[a])==null?void 0:o.uri,order:(i==null?void 0:i.order)||0,type:(i==null?void 0:i.type)||""}}):t.map((i,a)=>{var o;return{changedMedia:(o=r[a])==null?void 0:o.uri,currentMedia:i==null?void 0:i.uri,order:(i==null?void 0:i.order)||0,type:(i==null?void 0:i.type)||"media"}})},Le=(e,n)=>!e||!n?[]:e.map(r=>{var t;return((t=n.find(i=>i.id===r))==null?void 0:t.name)??""}).filter(r=>r),Nn=(e,n)=>{var i,a;const r=((i=e.categories)==null?void 0:i.map(o=>o.name).join(", "))??"",t=((a=n.categories)==null?void 0:a.map(o=>o.name).join(", "))??"";return s.jsxs("div",{className:A,children:[s.jsx(w,{hasGreyText:!0,children:"Categories"}),s.jsx(Y,{currentString:r,changedString:t,type:"words"})]})},An=({key:e,revision:n,app:r,desktopIntegrationTypes:t})=>{if(e==="description")return s.jsx(Tn,{currentString:r.description||"",changedString:n.description||""});if(e==="desktopIntegrationTypeIds"){const i=Le(r.desktopIntegrationTypeIds,t.data),a=Le(n.desktopIntegrationTypeIds,t.data),o=[...i].sort((l,d)=>l.localeCompare(d)),c=[...a].sort((l,d)=>l.localeCompare(d));return s.jsx(Y,{currentString:o.join(", "),changedString:c.join(", "),type:"wordsWithSpace"})}if(["redirectUris","signoutUris","limitToClientIds","desktopIntegrationTypeIds","products"].includes(e)){const i=Array.isArray(r[e])?r[e].join(" "):"",a=Array.isArray(n[e])?n[e].join(" "):"";return s.jsx(Y,{currentString:i,changedString:a,type:"words"})}return s.jsx(Y,{currentString:r[e]||"",changedString:n[e]||"",type:"words"})},Mn=je().shape({rejectionReason:xe().trim().required("Required")}),Dn=(e,n,r)=>()=>{const t=r==null?void 0:r.email,i=r==null?void 0:r.name;t&&i&&(e({email:t,name:i,publicListedDate:te().format("YYYY-MM-DDTHH:mm:ss")}),n())},En=(e,n,r)=>t=>{const i=r==null?void 0:r.email,a=r==null?void 0:r.name;i&&a&&(e({email:i,name:a,rejectionReason:t.rejectionReason}),n())},Bn=(e,n)=>()=>{n&&e()},Ln=(e,n)=>()=>{n&&e({actionedBy:n})},qn=({approval:e,refreshApprovals:n})=>{var U,J;const{connectSession:r}=ve(v),{hasReadAccess:t}=ie(),{Modal:i,openModal:a,closeModal:o}=re(),{Modal:c,openModal:l,closeModal:d}=re(),u=e==null?void 0:e.appId,g=e==null?void 0:e.appRevisionId,f=r==null?void 0:r.loginIdentity.email,[p,m]=T({reapitConnectBrowserSession:v,action:P[R.getAppById],uriParams:{appId:u},fetchWhenTrue:[u]}),[h,y]=T({reapitConnectBrowserSession:v,action:P[R.getRevisionById],uriParams:{revisionId:g,appId:u},fetchWhenTrue:[g,u]}),[b,C]=T({reapitConnectBrowserSession:v,action:P[R.getDesktopIntegrationTypes]}),[M,D]=T({reapitConnectBrowserSession:v,action:P[R.getAppPermissions]}),[,,ee,E]=W({reapitConnectBrowserSession:v,action:O[$.approveRevision],method:"POST",uriParams:{appId:u,revisionId:g}}),[,,ne,q]=W({reapitConnectBrowserSession:v,action:O[$.rejectRevision],method:"POST",uriParams:{appId:u,revisionId:g}}),[,,k]=W({reapitConnectBrowserSession:v,action:O[$.createConsentEmails],method:"POST",uriParams:{appId:u,revisionId:g}}),{register:G,handleSubmit:V,formState:{errors:I}}=ge({resolver:ye(Mn),defaultValues:{rejectionReason:""}});return L.useEffect(Bn(n,!!(E||q)),[E,q]),m||y||C||D?s.jsx(se,{}):!e||!p||!h||!b||!M?s.jsx(fe,{className:F,intent:"primary",isExpanded:!0,isFullWidth:!0,isInline:!0,children:"Data not returned to complete this request"}):s.jsxs("div",{className:he,children:[s.jsxs(ue,{children:[p.name," Revision Diff"]}),Object.keys(Ee).map(j=>s.jsxs("div",{className:A,children:[s.jsx(w,{hasGreyText:!0,children:Ee[j]}),An({key:j,app:p,desktopIntegrationTypes:b,revision:h})]},j)),Nn(p,h),Pn({scopes:M,appScopes:p.scopes,revisionScopes:h.scopes}),s.jsxs("div",{className:A,children:[s.jsx(w,{hasGreyText:!0,children:"Is listed"}),s.jsx(z,{currentChecked:!!p.isListed,changedChecked:!!h.isListed,dataTest:"revision-diff-isListed"})]}),s.jsxs("div",{className:A,children:[s.jsx(w,{hasGreyText:!0,children:"Is Free"}),s.jsx(z,{currentChecked:!!p.isFree,changedChecked:!!h.isFree,dataTest:"revision-diff-isFree"})]}),s.jsxs("div",{className:A,children:[s.jsx(w,{hasGreyText:!0,children:"Is Integration"}),s.jsx(z,{currentChecked:!!p.isDirectApi,changedChecked:!!h.isDirectApi,dataTest:"revision-diff-isDirectApi"})]}),s.jsxs("div",{className:A,children:[s.jsx(w,{hasGreyText:!0,children:"Is Delete Protected"}),s.jsx(z,{currentChecked:!!p.deletionProtection,changedChecked:!!h.deletionProtection,dataTest:"revision-diff-deletion-protection"})]}),Rn({app:p,revision:h}).map(j=>s.jsxs("div",{className:A,children:[s.jsxs(w,{hasGreyText:!0,children:[j.type," ",j.order>0&&s.jsx("span",{children:j.order})]}),j.type==="video"?s.jsx(Y,{currentString:j.currentMedia??"",changedString:j.changedMedia??"",type:"words"}):s.jsx(mn,{changedMedia:j.changedMedia,currentMedia:j.currentMedia,type:j.type})]},j.order)),s.jsxs(B,{alignment:"center",children:[s.jsx(x,{onClick:l,disabled:t,intent:"danger",children:"Decline Revision"}),s.jsx(x,{onClick:a,disabled:t,intent:"primary",children:"Approve Revision"}),s.jsx(x,{intent:"primary",onClick:Ln(k,f),disabled:t,children:"Send Consent Emails"})]}),s.jsxs(i,{title:`Approve ${p.name} Revision`,children:[s.jsxs(w,{children:["Are your sure you want to approve the revision for \u2018",p.name,"\u2019?"]}),s.jsxs(B,{alignment:"center",children:[s.jsx(x,{onClick:o,children:"Cancel"}),s.jsx(x,{intent:"primary",onClick:Dn(ee,o,r==null?void 0:r.loginIdentity),children:"Approve"})]})]}),s.jsxs(c,{title:`Decline ${p.name} Revision`,children:[s.jsxs(w,{children:["Are your sure you want to decline the revision for \u2018",p.name,"\u2019?"]}),s.jsxs("form",{onSubmit:V(En(ne,d,r==null?void 0:r.loginIdentity)),children:[s.jsx(le,{className:F,children:s.jsx(de,{children:s.jsx(pe,{...G("rejectionReason"),label:"Rejection Reason",errorMessage:(U=I==null?void 0:I.rejectionReason)==null?void 0:U.message,icon:(J=I==null?void 0:I.rejectionReason)!=null&&J.message?"asterisk":null,intent:"danger"})})}),s.jsxs(B,{alignment:"center",children:[s.jsx(x,{onClick:d,children:"Cancel"}),s.jsx(x,{intent:"danger",type:"submit",children:"Decline"})]})]})]})]})};var qe={appEnv:"development",sentryDsn:"",connectClientId:"76q6dqj28batdlespqc36urn8b",connectOAuthUrl:"https://connect.dev.paas.reapit.cloud",connectUserPoolId:"eu-west-2_kiftR4qFc",platformApiUrl:"https://platform.dev.paas.reapit.cloud",developerPortalUri:"https://developers.dev.paas.reapit.cloud",appMarketUri:"https://marketplace.dev.paas.reapit.cloud"};const Ue=(e,n,r)=>()=>{r&&(n(null),e(r))},Fe=(e,n,r)=>()=>{r&&(n(null),e(r))},Oe=()=>{var u;const[e,n]=L.useState(1),[r,t]=L.useState(null),[i,a]=L.useState(null),{hasReadAccess:o}=ie(),[c,l,,d]=T({reapitConnectBrowserSession:v,action:P[R.getApprovals],queryParams:{pageNumber:e,pageSize:12}});return s.jsxs(_e,{children:[s.jsx(ze,{children:"App Revision Approvals"}),l?s.jsx(se,{}):s.jsxs(s.Fragment,{children:[s.jsx(me,{className:F,rows:(u=c==null?void 0:c.data)==null?void 0:u.map(g=>{const{description:f,created:p,appId:m,appRevisionId:h,createdBy:y}=g;return{cells:[{label:"Description",value:f,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Created By",value:y,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Created Date",value:p?Ye(p):"-",narrowTable:{showLabel:!0}}],expandableContent:{content:s.jsxs(s.Fragment,{children:[s.jsxs(B,{alignment:"center",children:[s.jsx(x,{intent:"default",onClick:Ce(`${qe.appMarketUri}/apps/${m}`),children:"View in AppMarket"}),s.jsx(x,{intent:"default",disabled:o,onClick:Ce(`${qe.developerPortalUri}/apps/${m}`),children:"View in DevPortal"}),s.jsx(x,{type:"button",intent:"default",onClick:Fe(a,t,g),children:"View Revision"}),s.jsx(x,{intent:"default",onClick:Ue(t,a,g),children:"View Consents"})]}),r&&(r==null?void 0:r.appRevisionId)===h&&s.jsx(an,{approval:r}),i&&(i==null?void 0:i.appRevisionId)===h&&s.jsx(qn,{approval:i,refreshApprovals:d})]})}}})}),s.jsx(He,{callback:n,currentPage:e,numberPages:Math.ceil(((c==null?void 0:c.totalCount)??1)/12)})]})]})};export{Oe as AdminApprovals,Oe as default,Ue as handleSetConsentApproval,Fe as handleSetDiffApproval};
