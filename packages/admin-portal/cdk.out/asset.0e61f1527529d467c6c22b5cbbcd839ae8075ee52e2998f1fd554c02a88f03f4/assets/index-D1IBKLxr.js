import{j as e,aa as A,ao as i,ad as t,ap as j,aq as x,r as n,ag as G,W as H,am as O,a7 as W,aj as $,ab as J,an as K,al as Q,ae as V,af as S}from"./vendor-ZH71Hs13.js";import{E as X}from"./index-CwlvE5Y3.js";import{u as Y,t as c}from"./index.esm-Ch-ie6LE.js";import{u as Z,r as v,g as _,G as ee,o as ae,a as se,U as le}from"./index-DYGYHHRm.js";import{u as re}from"./use-reapit-update-Dbhu-yhb.js";import{f as ne}from"./index-C-eCv2z-.js";import{S as oe}from"./index-Co6JqKJd.js";import{a as ie}from"./use-permissions-state-BndJTtcK.js";import"./FileSaver.min-BZwjJ9VL.js";const te=({setSubscriptionsFilters:s})=>{const{register:a,handleSubmit:l}=Y({mode:"all"});return e.jsx("form",{onChange:l(ne(s,500)),children:e.jsxs(A,{hasMargin:!0,children:[e.jsx(i,{children:e.jsx(t,{...a("organisationName"),label:"Company Name"})}),e.jsx(i,{children:e.jsx(t,{...a("userEmail"),type:"email",label:"User Email"})}),e.jsx(i,{children:e.jsxs(t,{children:[e.jsx(j,{children:"Subscription Type"}),e.jsxs(x,{...a("subscriptionType"),children:[e.jsx("option",{value:"",children:"Please Select"}),e.jsx("option",{value:"applicationListing",children:"Application Listing"}),e.jsx("option",{value:"developerRegistration",children:"Developer Registration"}),e.jsx("option",{value:"developerEdition",children:"Developer Edition"})]})]})}),e.jsx(i,{children:e.jsxs(t,{children:[e.jsx(j,{children:"Status"}),e.jsxs(x,{...a("status"),children:[e.jsx("option",{value:"",children:"Please Select"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})})]})})},w=(s,a)=>async()=>{await s()&&a(null)},C=(s,a,l)=>()=>{l&&(s(),a())},g=(s,a,l)=>()=>{l&&(a(),s(l))},ce=()=>{var b;const[s,a]=n.useState({}),[l,f]=n.useState(1),[y,T]=n.useState(12),[E,u]=n.useState(null),{Modal:L,openModal:P,closeModal:d}=G(),{hasReadAccess:p}=ie(),[r,N,,k]=Z({reapitConnectBrowserSession:v,action:_[ee.getSubscriptions],queryParams:{...ae(s),userEmail:s.userEmail?encodeURIComponent(s.userEmail??""):void 0,pageSize:y,pageNumber:l}}),[,,M,h]=re({reapitConnectBrowserSession:v,action:se[le.deleteSubscription],method:"DELETE",uriParams:{subscriptionId:E}});return n.useEffect(C(k,d,h),[h]),e.jsx(X,{children:e.jsxs(H,{children:[e.jsx(O,{children:"Subscriptions"}),e.jsx(te,{setSubscriptionsFilters:a}),e.jsx(oe,{area:"SUBSCRIPTIONS",data:r,setPageSize:T}),N?e.jsx(W,{}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:J,numberColumns:10,rows:(b=r==null?void 0:r.data)==null?void 0:b.map(({id:R,type:q,summary:D,organisationName:I,user:U,created:B,renews:m,frequency:F,cost:z,cancelled:o})=>({cells:[{label:"Subcription Type",value:q,cellHasDarkText:!0,narrowTable:{showLabel:!0}},{label:"Summary",value:D,narrowTable:{showLabel:!0}},{label:"Company Name",value:I,narrowTable:{showLabel:!0}},{label:"User Email",value:U,narrowTable:{showLabel:!0}},{label:"Start Date",value:c(B),narrowTable:{showLabel:!0}},{label:"Renews",value:m?c(m):"-",narrowTable:{showLabel:!0}},{label:"Frequency",value:F,narrowTable:{showLabel:!0}},{label:"Cost",value:`\xA3${z}`,narrowTable:{showLabel:!0}},{label:"Cancelled",value:o?c(o):"-",narrowTable:{showLabel:!0}}],ctaContent:{headerContent:"Cancel",icon:o||p?void 0:"trash",onClick:o||p?void 0:g(u,P,R)}}))}),e.jsx(K,{callback:f,currentPage:l,numberPages:Math.ceil(((r==null?void 0:r.totalCount)??1)/12)}),e.jsxs(L,{title:"Cancel Subscription",children:[e.jsx(Q,{children:"Please confirm you wish to cancel this subscription"}),e.jsxs(V,{alignment:"right",children:[e.jsx(S,{type:"button",onClick:d,children:"Close"}),e.jsx(S,{intent:"danger",onClick:w(M,u),children:"Cancel"})]})]})]})]})})};export{ce as default,w as handleCancelSub,C as handleCancelSubSuccess,g as handleSetSubId};
