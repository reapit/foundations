import { Story, Canvas, ArgsTable } from '@storybook/addon-docs/blocks'
import { GridDemoBlock } from './grid.stories'
import { Grid, Col } from './grid'
import { GridResponsive, ColResponsive } from './grid-responsive'
import { MediaStateProvider } from '../../hooks/use-media-query'
import { RenderHtmlMarkup } from '../../helpers/render-html-markup'
import { cx } from 'linaria'
import { elColGap2, elRowGap3, elSpan12, elSpan8, elSpan4, elOffset4, elOffset8 } from './__styles__/units'

<Meta title="Grid" />

# Grid

### Basic Example

The basic grid should fulil the majority of requirements for most users.

The Grid leverages CSS Grid to provide a responsive layout for your applications.

<Canvas>
  <Story name="Basic Example">
    <Grid>
      <Col>
        <GridDemoBlock />
      </Col>
      <Col>
        <GridDemoBlock />
      </Col>
      <Col>
        <GridDemoBlock />
      </Col>
      <Col>
        <GridDemoBlock />
      </Col>
    </Grid>
  </Story>
</Canvas>

<RenderHtmlMarkup component="Grid" story={['Basic Example']} label="Grid Rendered HTML markup" />

The grid's columns change at different breakpoints. These are listed in the table below

Breakpoint | Column count
--- | ---
isMobile | 4
isTablet | 8
isDesktop | 12
isSuperWideScreen | 16
is4KScreen | 20

 The breakpoints are explained by the variables below;

```ts
...
const windowWidth = window.innerWidth
const isMobile = windowWidth < 768
const isTablet = windowWidth >= 768 && windowWidth < 1024
const isDesktop = windowWidth >= 1024 && windowWidth < 1400
const isWideScreen = windowWidth >= 1400 && windowWidth < 1920
const isSuperWideScreen = windowWidth >= 1920 && windowWidth < 2560
const is4KScreen = windowWidth >= 2560
...
```

For mobile view, the columns are full width, in tablet they are 50%, for desktop one third and a quarter width in widescreen.

Row and column gaps are standardised in line with our style guide.

### Custom Example

If you need more granular control over your grid, you can override the base with utility classes we expose.

The grid class / component can have both it's `grid-column-gap` and `grid-row-gap` properties with modifiers classes that follow the pattern below:

- `.e-col-gap{unit}`
- `.el-row-gap{unit}`

Where the `{unit}` value is one of

- `0`: 0rem
- `1`: 0.25rem
- `2`: 0.5rem
- `3`: 0.75rem
- `4`: 1rem
- `6`: 1.5rem
- `8`: 2rem
- `12`: 3rem

So a class `.el-col-gap-4` will give a `grid-column-gap` property of 1rem. Note if importing the TypeScript components, the classes are `camelCased` eg `elColGap4`

Similarly, for the `Col` component / class, you can override both the `grid-column-end` and `grid-column-start` properties with the following options;

- `.e-span{unit}`
- `.el-offset{unit}`

Where the `{unit}` value a number `1 - 12`, mapping to the number of columns the `Col` should span and the column it should start at on the grid respectively.

The below contrived example we have overridden the base behaviour by adding a custom column and row gap to the grid and start and span properties to the columns.

Obviously to make the classes responsive, you will need some JavaScript to toggle the classes as appropriate.

<Canvas>
  <Story name="Custom Example">
    <Grid className={cx(elColGap2, elRowGap3)}>
      <Col className={cx(elSpan12)}>
        <GridDemoBlock />
      </Col>
      <Col className={cx(elSpan8, elOffset4)}>
        <GridDemoBlock />
      </Col>
      <Col className={cx(elSpan4, elOffset4)}>
        <GridDemoBlock />
      </Col>
      <Col className={cx(elSpan4, elOffset8)}>
        <GridDemoBlock />
      </Col>
    </Grid>
  </Story>
</Canvas>

<RenderHtmlMarkup component="Grid" story={['Custom Example']} label="Custom Grid Rendered HTML markup" />

### React Example - Responsive Customisation

In the previous example, we saw that customisation required some JS logic to toggle classes based on media widths.

For React users, we have an addional `GridResponsive` component that under the hood uses the `useMediaQuery` hook to allow maximum customisation based on our 4 media query breakpoints.

Both the `GridResponsive` and `ColResponsive` components accept props in the following interfaces:

<ArgsTable of={GridResponsive} />

Essentially for `GridResponsive` we can set `grid-column-gap` and `grid-row-gap` for each of mobile, tablet, desktop and widescreen based on the relevant prop.

For `ColResponsive` the same applies, but for the `grid-column-end` and `grid-column-start` properties.

In all cases, the class is toggled as the screen size changes, defaulting to the base grid values if no additional class is applied.

Full (somewhat contrived) example below:

### ColResponsive

<ArgsTable of={ColResponsive} />

<Canvas>
  <Story name="React Example - Responsive Customisation">
    <MediaStateProvider>
      <GridResponsive
        colGapMobile={1}
        colGapTablet={2}
        colGapDesktop={3}
        colGapWideScreen={4}
        rowGapMobile={1}
        rowGapTablet={2}
        rowGapDesktop={3}
        rowGapWideScreen={4}
      >
        <ColResponsive spanMobile={4} spanTablet={12} spanDesktop={6} spanWideScreen={4} offsetDesktop={6}>
          <GridDemoBlock />
        </ColResponsive>
        <ColResponsive spanMobile={4} spanTablet={12} spanDesktop={6} offsetDesktop={6}>
          <GridDemoBlock />
        </ColResponsive>
        <ColResponsive spanWideScreen={4}>
          <GridDemoBlock />
        </ColResponsive>
        <ColResponsive spanWideScreen={4}>
          <GridDemoBlock />
        </ColResponsive>
      </GridResponsive>
    </MediaStateProvider>
  </Story>
</Canvas>

<RenderHtmlMarkup
  component="Grid"
  story={['React Example - Responsive Customisation']}
  label="Custom Grid Rendered HTML markup"
/>
