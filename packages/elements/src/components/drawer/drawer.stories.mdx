import { Meta, Story, Canvas, ArgsTable } from '@storybook/addon-docs'
import { useState } from 'react'
import { cx } from '@linaria/core'
import { useDrawer } from '../../hooks/use-drawer'
import {
  Drawer,
  DrawerBg,
  DrawerContainer,
  DrawerHeader,
  DrawerBody,
  DrawerFooter,
  DrawerSubtitle,
  DrawerTitle,
} from './index'
import { elIsActive } from '../../styles/states'
import { Button, ButtonGroup } from '../button'
import { BodyText } from '../typography'
import { elFlex, elFlexJustifyCenter } from '../../styles/flexbox'
import { FlexContainer } from '../layout'
import { RenderHtmlMarkup } from '../../storybook/render-html-markup'

<Meta title="Drawer" component={Drawer} />

# Drawer

The drawer component renders a slide in from the right hand side of the page. It is typically used for displaying forms, tabs, and other "quick view" or "quick edit" content and is dismissable without losing page context. In mobile, it fills the screen.

## Basic Usage

The Drawer component can be used for UI purposes only, but won't have the functionality of the React implementation (i.e. managing the state of whether it is open or closed)

If using the Drawer component like this, you will need to toggle the `elIsActive` / `el-is-active` class to show/hide the drawer.

This class must be applied on two elements, `div.el-drawer-bg` and also `div.el-drawer`, when you want the drawer to be shown.

By default, the drawer fills it's current container so you will likely wish to place it as high as possible up the DOM tree to achive an overlay effect.

Click "Show code" below to see JSX / HTML code for a closed drawer, along with the corresponding rendered markup. To see how an opened one behaves and the markup, move to the React examples below.

<Canvas>
  <Story name="Basic Usage - Closed">
    <DrawerBg />
    <DrawerContainer>
      <DrawerHeader>
        <DrawerTitle>Drawer Header</DrawerTitle>
        <DrawerSubtitle>Drawer Subtitle</DrawerSubtitle>
      </DrawerHeader>
      <DrawerBody>
        <BodyText>Here's some nice content for the inside of the drawer.</BodyText>
      </DrawerBody>
      <DrawerFooter>
        <ButtonGroup alignment="right">
          <Button intent="default" onClick={console.log}>
            Close the Drawer
          </Button>
        </ButtonGroup>
      </DrawerFooter>
    </DrawerContainer>
  </Story>
</Canvas>

<RenderHtmlMarkup component="Drawer" story="Basic Usage - Closed" />

## React usage with `useDrawer` hook

The `useDrawer` hook exports both a `Drawer` component and state helpers for toggling the component open.

It also leverages our `Portal` component to render the `Drawer` at the top level of your app. The default container is `#root` so if you need your portal to render on another element, pass a different id to the `useDrawer` hook when you instantiate it - in the example below, we use Storybook's `#docs-root`.

<Canvas>
  <Story name="React Usage">
    {() => {
      const [ExampleDrawer, openDrawer, closeDrawer] = useDrawer('docs-root')
      return (
        <>
          <Button intent="primary" onClick={openDrawer}>
            Open Drawer
          </Button>
          <ExampleDrawer
            title="Demo Drawer Title"
            subtitle="Demo Drawer Subtitle"
            footerItems={
              <ButtonGroup alignment="right">
                <Button intent="default" onClick={closeDrawer}>
                  Close the Drawer
                </Button>
              </ButtonGroup>
            }
          >
            <BodyText>Here's some nice content for the inside of the drawer.</BodyText>
          </ExampleDrawer>
        </>
      )
    }}
  </Story>
</Canvas>

## `useDrawer` API

Exports the following properties as an array - `[Drawer, openDrawer, closeDrawer, modalIsOpen]`

- `Drawer`: `FC<Partial<DrawerProps>>` - a React component that should be placed somewhere with the component that you want to use the drawer. Will pass props to the underlying drawer.
- `openDrawer`: `() => void` - a method that will open the Drawer.
- `closeDrawer`: `() => void` - a method that will close the Drawer. The Drawer can also be closed by default from within the Drawer, or by clicking on the background
- `modalIsOpen`: `boolean` - convenience boolean to check if the drawer is open currently.
